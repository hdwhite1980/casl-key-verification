/*! For license information please see casl-bundle.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("CASL",[],e):"object"==typeof exports?exports.CASL=e():t.CASL=e()}(this,(()=>(()=>{"use strict";var t,e,n,r,o,i,a={46:(t,e,n)=>{var r=n(341),o=n(361),i=n(123),a=n(182);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return(e=v(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(){f=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(e,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return u(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=d(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h={};function p(){}function v(){}function g(){}var y={};u(y,i,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(_([])));b&&b!==n&&r.call(b,i)&&(y=b);var w=g.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,a,c){var u=d(t[o],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==s(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=d(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(s(e)+" is not iterable")}return v.prototype=g,u(w,"constructor",g),u(g,"constructor",v),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),h}},e}function d(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){d(i,r,o,a,s,"next",t)}function s(t){d(i,r,o,a,s,"throw",t)}a(void 0)}))}}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function v(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}function g(t){var e="function"==typeof Map?new Map:void 0;return g=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(y())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&m(o,n.prototype),o}(t,arguments,b(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),m(n,t)},g(t)}function y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(y=function(){return!!t})()}function m(t,e){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},m(t,e)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}var w=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=b(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,y()?Reflect.construct(e,n||[],b(t).constructor):e.apply(t,n))}(this,e)).attachShadow({mode:"open"}),t.initializeState(),t.render(),t.setupEventListeners(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e)}(e,t),n=e,c=[{key:"initializeState",value:function(){this.isLoading=!1,this.error=null,this.user=null,this.verificationHistory=[],this.packages=[],this.loadDashboardData()}},{key:"connectedCallback",value:function(){console.log("UserDashboard component connected"),document.addEventListener("casl-auth",this.handleAuthEvent.bind(this))}},{key:"disconnectedCallback",value:function(){document.removeEventListener("casl-auth",this.handleAuthEvent.bind(this))}},{key:"handleAuthEvent",value:function(t){var e=t.detail,n=e.type,r=e.data;"authenticated"===n?(this.user=r,this.loadDashboardData()):"logged-out"===n&&this.dispatchDashboardEvent("logout")}},{key:"loadDashboardData",value:(g=h(f().mark((function t(){var e;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.user){t.next=8;break}return t.next=3,o.D.getCurrentUser();case 3:if((e=t.sent).isAuthenticated){t.next=7;break}return this.dispatchDashboardEvent("auth-required"),t.abrupt("return");case 7:this.user=e.user;case 8:return this.isLoading=!0,this.error=null,this.render(),t.prev=11,t.next=14,this.loadVerificationHistory();case 14:return t.next=16,this.loadPackages();case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(11),console.error("Error loading dashboard data:",t.t0),this.error=t.t0.message||(0,i.t)("dashboard.loadError");case 22:return t.prev=22,this.isLoading=!1,this.render(),t.finish(22);case 26:case"end":return t.stop()}}),t,this,[[11,18,22,26]])}))),function(){return g.apply(this,arguments)})},{key:"loadVerificationHistory",value:(v=h(f().mark((function t(){var e,n,r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=u({"Content-Type":"application/json"},o.D.getAuthHeaders()),t.next=3,fetch("".concat(a.JR,"/verification-history"),{method:"GET",headers:e});case 3:if((n=t.sent).ok){t.next=6;break}throw new Error((0,i.t)("dashboard.historyLoadError"));case 6:return t.next=8,n.json();case 8:r=t.sent,this.verificationHistory=r.verifications||[];case 10:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"loadPackages",value:(d=h(f().mark((function t(){var e,n;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(a.JR,"/packages"),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if((e=t.sent).ok){t.next=5;break}throw new Error((0,i.t)("dashboard.packagesLoadError"));case 5:return t.next=7,e.json();case 7:n=t.sent,this.packages=n.packages||[];case 9:case"end":return t.stop()}}),t,this)}))),function(){return d.apply(this,arguments)})},{key:"render",value:function(){var t,e;e=this.isLoading?this.renderLoading():this.error?this.renderError():this.renderDashboard(),this.shadowRoot.innerHTML="\n      <style>".concat((0,r.$)(),'</style>\n      <div class="container" dir="').concat((null===(t=i.A.getLanguageInfo(i.A.currentLanguage))||void 0===t?void 0:t.direction)||"ltr",'">\n        ').concat(e,"\n      </div>\n    ")}},{key:"renderLoading",value:function(){return'\n      <div class="loading-container">\n        <div class="loading-spinner"></div>\n        <p>'.concat((0,i.t)("dashboard.loading"),"</p>\n      </div>\n    ")}},{key:"renderError",value:function(){return'\n      <div class="error-container">\n        <div class="alert alert-error" role="alert">\n          '.concat(this.error,'\n        </div>\n        <button \n          class="btn-primary" \n          onclick="this.getRootNode().host.loadDashboardData()"\n        >\n          ').concat((0,i.t)("dashboard.retry"),"\n        </button>\n      </div>\n    ")}},{key:"renderDashboard",value:function(){var t;return'\n      <div class="dashboard">\n        <div class="dashboard-header">\n          <h1>'.concat((0,i.t)("dashboard.welcome",{username:(null===(t=this.user)||void 0===t?void 0:t.username)||"User"}),'</h1>\n          <button \n            class="btn-secondary" \n            onclick="this.getRootNode().host.handleLogout()"\n          >\n            ').concat((0,i.t)("dashboard.logout"),'\n          </button>\n        </div>\n        \n        <div class="dashboard-content">\n          ').concat(this.renderVerificationHistory(),"\n          ").concat(this.renderPackages(),'\n        </div>\n        \n        <div class="dashboard-actions">\n          <button \n            class="btn-primary" \n            onclick="this.getRootNode().host.startNewVerification()"\n          >\n            ').concat((0,i.t)("dashboard.newVerification"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"renderVerificationHistory",value:function(){var t=this;return 0===this.verificationHistory.length?'\n        <div class="verification-history">\n          <h2>'.concat((0,i.t)("dashboard.verificationHistory"),'</h2>\n          <div class="empty-state">\n            <p>').concat((0,i.t)("dashboard.noHistory"),"</p>\n          </div>\n        </div>\n      "):'\n      <div class="verification-history">\n        <h2>'.concat((0,i.t)("dashboard.verificationHistory"),'</h2>\n        <div class="verification-cards">\n          ').concat(this.verificationHistory.map((function(e){return t.renderVerificationCard(e)})).join(""),"\n        </div>\n      </div>\n    ")}},{key:"renderVerificationCard",value:function(t){var e,n,r=new Date(t.verificationDate),o=i.A.formatDate(r),a=(0,i.t)("trustLevel.".concat(t.trustLevel))||t.trustLevel,s=t.score||0,c="#4CAF50";return"review"===t.trustLevel?c="#FFC107":"manual_review"===t.trustLevel?c="#9E9E9E":"not_eligible"===t.trustLevel&&(c="#757575"),'\n      <div class="verification-card">\n        <div class="verification-header">\n          <div class="trust-badge" style="background-color: '.concat(c,'">\n            ').concat(a,'\n          </div>\n          <div class="verification-date">\n            ').concat(o,'\n          </div>\n        </div>\n        \n        <div class="verification-body">\n          <div class="verification-score">\n            <span class="score-number">').concat(s,'</span>\n            <span class="score-max">/100</span>\n          </div>\n          \n          <div class="verification-details">\n            <p class="casl-key-id">CASL Key ID: ').concat(t.caslKeyId,'</p>\n            <p class="booking-info">\n              ').concat(null!==(e=t.booking)&&void 0!==e&&e.platform?"".concat(t.booking.platform):"","\n              ").concat(null!==(n=t.booking)&&void 0!==n&&n.checkInDate?" | Check-in: ".concat(i.A.formatDate(new Date(t.booking.checkInDate))):"",'\n            </p>\n          </div>\n        </div>\n        \n        <div class="verification-actions">\n          <button \n            class="btn-link" \n            onclick="this.getRootNode().host.viewVerificationDetails(\'').concat(t.caslKeyId,"')\"\n          >\n            ").concat((0,i.t)("dashboard.viewDetails"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"renderPackages",value:function(){var t=this;return 0===this.packages.length?"":'\n      <div class="packages-section">\n        <h2>'.concat((0,i.t)("dashboard.availablePackages"),'</h2>\n        <div class="package-cards">\n          ').concat(this.packages.map((function(e){return t.renderPackageCard(e)})).join(""),"\n        </div>\n      </div>\n    ")}},{key:"renderPackageCard",value:function(t){return'\n      <div class="package-card">\n        <div class="package-header">\n          <h3>'.concat(t.name,'</h3>\n          <div class="package-price">\n            ').concat(i.A.formatCurrency(t.price,t.currency),'\n          </div>\n        </div>\n        \n        <div class="package-body">\n          <p class="package-description">').concat(t.description,'</p>\n          <ul class="package-features">\n            ').concat(t.features.map((function(t){return"<li>".concat(t,"</li>")})).join(""),'\n          </ul>\n        </div>\n        \n        <div class="package-actions">\n          <button \n            class="btn-primary" \n            onclick="this.getRootNode().host.purchasePackage(\'').concat(t.id,'\')"\n            data-package-id="').concat(t.id,'"\n          >\n            ').concat((0,i.t)("dashboard.purchase"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"viewVerificationDetails",value:(l=h(f().mark((function t(e){var n;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,n=this.verificationHistory.find((function(t){return t.caslKeyId===e}))){t.next=4;break}throw new Error((0,i.t)("dashboard.verificationNotFound"));case 4:this.dispatchDashboardEvent("view-verification",{verification:n}),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error viewing verification details:",t.t0),this.error=t.t0.message,this.render();case 12:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return l.apply(this,arguments)})},{key:"startNewVerification",value:function(){0===this.verificationHistory.length||this.hasUnusedVerificationSlots()?this.dispatchDashboardEvent("new-verification"):this.dispatchDashboardEvent("show-packages")}},{key:"hasUnusedVerificationSlots",value:function(){var t;return(null===(t=this.user)||void 0===t||null===(t=t.purchasedPackages)||void 0===t?void 0:t.some((function(t){return t.remainingVerifications>0})))||!1}},{key:"purchasePackage",value:function(t){var e=this.packages.find((function(e){return e.id===t}));if(!e)return this.error=(0,i.t)("dashboard.packageNotFound"),void this.render();this.dispatchDashboardEvent("purchase-package",{package:e,userId:this.user.id})}},{key:"handlePackagePurchased",value:function(t){this.user.purchasedPackages||(this.user.purchasedPackages=[]),this.user.purchasedPackages.push({packageId:t.id,purchaseDate:(new Date).toISOString(),remainingVerifications:t.verificationCount,expiryDate:t.expiryDate}),this.loadDashboardData()}},{key:"handleLogout",value:function(){var t=this;o.D.logoutUser().then((function(){t.dispatchDashboardEvent("logout")}))}},{key:"dispatchDashboardEvent",value:function(t){var e=new CustomEvent("casl-dashboard",{detail:{type:t,data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null},bubbles:!0,composed:!0});this.dispatchEvent(e)}},{key:"setupEventListeners",value:function(){var t=this;window.addEventListener("casl-package-purchased",(function(e){t.handlePackagePurchased(e.detail)}))}}],c&&p(n.prototype,c),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,c,l,d,v,g}(g(HTMLElement));customElements.define("casl-user-dashboard",w)},123:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function i(){i=function(){return e};var t,e={},n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function f(e,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return l(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=d(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h={};function p(){}function v(){}function g(){}var y={};l(y,s,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(_([])));b&&b!==n&&o.call(b,s)&&(y=b);var w=g.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,a,s,c){var u=d(t[i],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==r(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,c)}),(function(t){n("throw",t,s,c)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,c)}))}c(u.arg)}var i;l(this,"_invoke",(function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=d(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(o.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(r(e)+" is not iterable")}return v.prototype=g,l(w,"constructor",g),l(g,"constructor",v),v.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),l(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(f(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),l(w,u,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),h}},e}function a(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){a(i,r,o,s,c,"next",t)}function c(t){a(i,r,o,s,c,"throw",t)}s(void 0)}))}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}n.d(e,{A:()=>d,t:()=>f});var l=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentLanguage="en",this.availableLanguages=[{code:"en",name:"English",direction:"ltr"},{code:"es",name:"Español",direction:"ltr"},{code:"fr",name:"Français",direction:"ltr"},{code:"de",name:"Deutsch",direction:"ltr"},{code:"zh",name:"中文",direction:"ltr"},{code:"ja",name:"日本語",direction:"ltr"},{code:"ar",name:"العربية",direction:"rtl"},{code:"ru",name:"Русский",direction:"ltr"},{code:"pt",name:"Português",direction:"ltr"},{code:"hi",name:"हिन्दी",direction:"ltr"}],this.translations={},this.init()},e=[{key:"init",value:(a=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.detectLanguage(),t.next=3,this.loadTranslations(this.currentLanguage);case 3:this.updateDocumentLanguage();case 4:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"detectLanguage",value:function(){var t=localStorage.getItem("casl_language");if(t&&this.isLanguageSupported(t))this.currentLanguage=t;else{var e=navigator.language.split("-")[0];this.isLanguageSupported(e)&&(this.currentLanguage=e)}}},{key:"isLanguageSupported",value:function(t){return this.availableLanguages.some((function(e){return e.code===t}))}},{key:"loadTranslations",value:(r=s(i().mark((function t(e){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.translations[e]){t.next=2;break}return t.abrupt("return");case 2:t.prev=2,"en"===e?this.translations.en={"app.title":"CASL Key Verification","app.submit":"Submit","app.next":"Next","app.previous":"Previous","app.loading":"Loading...","app.submitting":"Submitting...","app.required":"Required","app.optional":"Optional","app.error":"Error","app.success":"Success","auth.loginTitle":"Log In","auth.username":"Username","auth.password":"Password","auth.login":"Log In","auth.loggingIn":"Logging in...","auth.needAccount":"Need an account?","auth.registerTitle":"Register","auth.email":"Email","auth.confirmPassword":"Confirm Password","auth.passwordRequirements":"Password must be at least 8 characters and include a number","auth.register":"Register","auth.registering":"Registering...","auth.haveAccount":"Already have an account?","auth.passwordsDoNotMatch":"Passwords do not match","auth.genericError":"Authentication failed. Please try again.","auth.loggedInAs":"Logged in as {username}","auth.logout":"Log Out","auth.logoutError":"Error logging out","auth.welcome":"Welcome to CASL Key Verification","auth.welcomeDescription":"Verify your identity to get your CASL Key","auth.firstTime":"First time user","auth.returningUser":"Returning user","steps.userIdentification":"User Identification","steps.bookingInfo":"Booking Information","steps.stayIntent":"Stay Intent","steps.agreement":"Agreement","userIdentification.name":"Full Name","userIdentification.email":"Email Address","userIdentification.phone":"Phone Number","userIdentification.address":"Address","userIdentification.airbnbProfile":"Airbnb Profile Link","userIdentification.vrboProfile":"Vrbo Profile Link","userIdentification.otherPlatformProfile":"Other Platform Profile","userIdentification.selectPlatform":"Select platform","userIdentification.verifyWithScreenshot":"Verify with Account Screenshot","userIdentification.bgCheckConsent":"I consent to a background check to verify my identity.","userIdentification.checkingStatus":"Checking user status...","userIdentification.welcomeBack":"Welcome back! We found your existing CASL Key ID:","userIdentification.uploadScreenshot":"Please upload a screenshot of your Airbnb or VRBO profile page to verify your account.","userIdentification.dragScreenshot":"Drag a screenshot here or click to select a file","userIdentification.processing":"Your screenshot is being processed. This may take a minute...","userIdentification.verified":"Your account has been verified successfully!","userIdentification.manualReview":"Your screenshot has been submitted for manual review. We'll notify you once it's verified.","userIdentification.rejected":"We couldn't verify your account from this screenshot. Please try again with a clearer image.","bookingInfo.platform":"Platform used","bookingInfo.listingLink":"STR Listing Link","bookingInfo.checkInDate":"Check-in Date","bookingInfo.checkOutDate":"Check-out Date","stayIntent.purpose":"What is the primary purpose of your stay?","stayIntent.otherPurpose":"Please specify","stayIntent.totalGuests":"How many total guests will stay?","stayIntent.childrenUnder12":"Are there any children under 12?","stayIntent.nonOvernightGuests":"Will any guests not be staying overnight?","stayIntent.travelingNearHome":"Are you traveling within 20 miles of your home?","stayIntent.zipCode":"ZIP code","stayIntent.usedSTRBefore":"Have you used STRs before?","stayIntent.previousStayLinks":"Optional: Previous stay links","agreement.agreeToRules":"I agree to follow quiet hours and property rules","agreement.agreeNoParties":"I agree not to host parties or events without host approval","agreement.understandFlagging":"I understand that violation of these terms may result in being flagged in CASL Key's network","results.title":"CASL Key Verification Result","results.caslKeyId":"CASL Key ID:","results.scoreFactors":"Score Factors","results.noAdjustments":"No score adjustments applied.","results.trustBadgeInfo":"Trust Badge Information","results.trustBadgeDescription":"Your trust badge is valid for 12 months. Future hosts will see your verification status, but never your personal details.","results.startOver":"Start Over","trustLevel.verified":"Verified – Low Risk","trustLevel.review":"Verified – Review Recommended","trustLevel.manualReview":"Manual Review Pending","trustLevel.notEligible":"Not Eligible at This Time","message.verified":"You're officially CASL Key Verified! Your trust badge is valid for 12 months and can be shared with any CASL Key host. Keep your badge active by booking responsibly.","message.review":"You're almost there! While you're verified, your Trust Score indicates a few flags (e.g., local booking or large group). Hosts may ask additional questions.","message.manualReview":"We're completing a review of your profile. This typically takes 24-48 hours. We'll notify you once your profile has been reviewed.","message.notEligible":"We're unable to approve your CASL Key at this time. You may reapply in 90 days or contact support to resolve outstanding concerns.","tooltip.profileHelp":"Providing a platform profile helps verify your identity and may improve your trust score.","tooltip.listingLink":"Provide the exact URL of your booking to verify it's legitimate.","tooltip.stayPurpose":"This helps hosts understand why you're traveling.","tooltip.childrenUnder12":"Having children in your group may positively affect your trust score.","tooltip.nonOvernightGuests":"This helps hosts understand if additional visitors may be present during the day.","tooltip.travelingNearHome":"Local bookings may require additional context for verification.","tooltip.previousStayLinks":"Prior rental experience may positively impact your trust score.","tooltip.rules":"Following property-specific rules helps maintain great relationships with hosts and neighbors.","tooltip.noParties":"Always discuss any gathering plans with your host in advance.","tooltip.understandFlagging":"CASL Key aims to create a trusted network of verified guests and hosts. Complying with platform standards keeps your verification active.","language.select":"Select Language","language.current":"Current: English"}:"es"===e&&(this.translations.es={"app.title":"Verificación CASL Key","app.submit":"Enviar","app.next":"Siguiente","app.previous":"Anterior","app.loading":"Cargando...","app.submitting":"Enviando...","app.required":"Obligatorio","app.optional":"Opcional","app.error":"Error","app.success":"Éxito","auth.loginTitle":"Iniciar Sesión","auth.username":"Nombre de Usuario","auth.password":"Contraseña","auth.login":"Iniciar Sesión","auth.loggingIn":"Iniciando sesión...","auth.needAccount":"¿Necesitas una cuenta?","auth.registerTitle":"Registrarse","auth.email":"Correo Electrónico","auth.confirmPassword":"Confirmar Contraseña","auth.passwordRequirements":"La contraseña debe tener al menos 8 caracteres e incluir un número","auth.register":"Registrarse","auth.registering":"Registrando...","auth.haveAccount":"¿Ya tienes una cuenta?","auth.passwordsDoNotMatch":"Las contraseñas no coinciden","auth.genericError":"Autenticación fallida. Por favor, inténtalo de nuevo.","auth.loggedInAs":"Conectado como {username}","auth.logout":"Cerrar Sesión","auth.logoutError":"Error al cerrar sesión","auth.welcome":"Bienvenido a Verificación CASL Key","auth.welcomeDescription":"Verifica tu identidad para obtener tu CASL Key","auth.firstTime":"Usuario por primera vez","auth.returningUser":"Usuario que regresa","steps.userIdentification":"Identificación de Usuario","steps.bookingInfo":"Información de Reserva","steps.stayIntent":"Propósito de Estancia","steps.agreement":"Acuerdo","userIdentification.name":"Nombre Completo","userIdentification.email":"Correo Electrónico","userIdentification.phone":"Número de Teléfono","userIdentification.address":"Dirección","userIdentification.airbnbProfile":"Enlace de Perfil de Airbnb","userIdentification.vrboProfile":"Enlace de Perfil de Vrbo","userIdentification.otherPlatformProfile":"Perfil de Otra Plataforma","userIdentification.selectPlatform":"Seleccionar plataforma","userIdentification.verifyWithScreenshot":"Verificar con Captura de Pantalla","userIdentification.bgCheckConsent":"Consiento a una verificación de antecedentes para verificar mi identidad.","userIdentification.checkingStatus":"Comprobando estado del usuario...","userIdentification.welcomeBack":"¡Bienvenido de nuevo! Encontramos tu CASL Key ID existente:","language.select":"Seleccionar Idioma","language.current":"Actual: Español"}),t.next=12;break;case 6:return t.prev=6,t.t0=t.catch(2),console.error("Failed to load translations for ".concat(e,":"),t.t0),this.currentLanguage="en",t.next=12,this.loadTranslations("en");case 12:case"end":return t.stop()}}),t,this,[[2,6]])}))),function(t){return r.apply(this,arguments)})},{key:"translate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(this.translations[this.currentLanguage]||{})[t]||this.translations.en&&this.translations.en[t]||t;return Object.entries(e).forEach((function(t){var e,r,i=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==e);c=!0);}catch(t){u=!0,o=t}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,r)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],s=i[1];n=n.replace("{".concat(a,"}"),s)})),n}},{key:"changeLanguage",value:(n=s(i().mark((function t(e){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isLanguageSupported(e)){t.next=3;break}return console.error("Language ".concat(e," is not supported")),t.abrupt("return");case 3:return this.currentLanguage=e,localStorage.setItem("casl_language",e),t.next=7,this.loadTranslations(e);case 7:this.updateDocumentLanguage(),n=new CustomEvent("caslLanguageChanged",{detail:{language:e,languageInfo:this.getLanguageInfo(e)},bubbles:!0,composed:!0}),document.dispatchEvent(n);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"getLanguageInfo",value:function(t){return this.availableLanguages.find((function(e){return e.code===t}))||null}},{key:"updateDocumentLanguage",value:function(){var t=this.getLanguageInfo(this.currentLanguage);t&&(document.documentElement.dir=t.direction,document.documentElement.lang=t.code)}},{key:"renderLanguageSelector",value:function(){var t=this,e=(this.getLanguageInfo(this.currentLanguage),"");return this.availableLanguages.forEach((function(n){e+='\n        <option value="'.concat(n.code,'" ').concat(n.code===t.currentLanguage?"selected":"",">\n          ").concat(n.name,"\n        </option>\n      ")})),'\n      <div class="language-selector">\n        <label for="language-select">'.concat(this.translate("language.select"),'</label>\n        <select id="language-select" onchange="this.getRootNode().host.handleLanguageChange(event)">\n          ').concat(e,'\n        </select>\n        <p class="current-language">').concat(this.translate("language.current"),"</p>\n      </div>\n    ")}},{key:"formatDate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{dateStyle:"medium"},n=t instanceof Date?t:new Date(t);return new Intl.DateTimeFormat(this.currentLanguage,e).format(n)}},{key:"formatNumber",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Intl.NumberFormat(this.currentLanguage,e).format(t)}},{key:"formatCurrency",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat(this.currentLanguage,{style:"currency",currency:e}).format(t)}}],e&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,a}(),f=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d.translate(t,e)},d=new l},182:(t,e,n)=>{function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function o(t,e,n){return(e=function(t){var e=function(t){if("object"!=r(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==r(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{JR:()=>i});var i="https://2mez9qoyt6.execute-api.us-east-2.amazonaws.com/prod",a="verified",s="review",c="manual_review",u="not_eligible";o(o(o(o({},a,"85-100"),s,"70-84"),c,"50-69"),u,"Below 50"),o(o(o(o({},a,{badgeColor:"#4CAF50",icon:"✅",label:"Verified",description:"Verified guest. Meets CASL Key's recommended trust standards."}),s,{badgeColor:"#FFC107",icon:"⚠️",label:"Additional Context Needed",description:"Some traits require review. We recommend reviewing booking context."}),c,{badgeColor:"#9E9E9E",icon:"🕵️",label:"Manual Review Pending",description:"We're completing a review of this guest's profile. You'll be notified soon."}),u,{badgeColor:"#757575",icon:"🔒",label:"Not Eligible at This Time",description:"This guest does not currently meet platform-wide trust requirements."})},188:(t,e,n)=>{n(660);var r=n(361),o=n(123);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){a=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function f(e,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return l(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=d(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h={};function p(){}function v(){}function g(){}var y={};l(y,s,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(_([])));b&&b!==n&&r.call(b,s)&&(y=b);var w=g.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,a,s,c){var u=d(t[o],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==i(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,c)}),(function(t){n("throw",t,s,c)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,c)}))}c(u.arg)}var o;l(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=d(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return v.prototype=g,l(w,"constructor",g),l(g,"constructor",v),v.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),l(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(f(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),l(w,u,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),h}},e}function s(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){s(i,r,o,a,c,"next",t)}function c(t){s(i,r,o,a,c,"throw",t)}a(void 0)}))}}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}function f(t){var e="function"==typeof Map?new Map:void 0;return f=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(d())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&h(o,n.prototype),o}(t,arguments,p(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),h(n,t)},f(t)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var v=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=p(e),function(t,e){if(e&&("object"==i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,n||[],p(t).constructor):e.apply(t,n))}(this,e)).attachShadow({mode:"open"}),t.initializeState(),t.render(),t.setupEventListeners(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(e,t),n=e,s=[{key:"initializeState",value:function(){this.isLoading=!1,this.isAuthenticated=!1,this.isRegistering=!1,this.error=null,this.user=null,this.checkAuthentication()}},{key:"checkAuthentication",value:(y=c(a().mark((function t(){var e;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.D.getCurrentUser();case 3:(e=t.sent).isAuthenticated&&(this.isAuthenticated=!0,this.user=e.user),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Authentication check failed:",t.t0);case 10:this.render();case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return y.apply(this,arguments)})},{key:"connectedCallback",value:function(){console.log("Authentication component connected")}},{key:"render",value:function(){var t,e;this.isAuthenticated?(this.dispatchAuthEvent("authenticated",this.user),e=this.renderAuthenticatedState()):e=this.isRegistering?this.renderRegistrationForm():this.renderLoginForm(),this.shadowRoot.innerHTML="\n      <style>".concat('\n    :host {\n      display: block;\n      font-family: Arial, sans-serif;\n      \n      /* Primary colors with contrast-safe text colors */\n      --primary-color: #4285F4;\n      --primary-color-dark: #1a5dd4;\n      --on-primary-color: #ffffff;\n      \n      --success-color: #4CAF50;\n      --on-success-color: #ffffff;\n      \n      --warning-color: #EC9F05; /* Darkened for better contrast */\n      --on-warning-color: #000000;\n      \n      --error-color: #c62828;\n      --on-error-color: #ffffff;\n      \n      --neutral-color: #5C5C5C; /* Darkened for better contrast */\n      --on-neutral-color: #ffffff;\n      \n      --surface-color: #ffffff;\n      --on-surface-color: #212121;\n      \n      --disabled-color: #9E9E9E;\n      --on-disabled-color: #212121;\n      \n      --border-radius: 8px;\n      --box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      --focus-ring-color: #4285F4;\n      --focus-ring-width: 3px;\n    }\n    \n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    \n    .form-section {\n      background-color: var(--surface-color);\n      padding: 20px;\n      border-radius: var(--border-radius);\n      margin-bottom: 20px;\n      box-shadow: var(--box-shadow);\n    }\n    \n    button {\n      padding: 10px 20px;\n      background-color: var(--primary-color);\n      color: var(--on-primary-color);\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      margin: 5px;\n      transition: background-color 0.2s, opacity 0.2s;\n      min-height: 44px;\n    }\n    \n    button:hover {\n      background-color: var(--primary-color-dark);\n    }\n    \n    button:focus {\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 2px;\n    }\n    \n    button:disabled {\n      background-color: var(--disabled-color);\n      color: var(--on-disabled-color);\n      cursor: not-allowed;\n    }\n    \n    button.success {\n      background-color: var(--success-color);\n      color: var(--on-success-color);\n    }\n    \n    button.success:hover {\n      background-color: #3d8b40;\n    }\n    \n    button.warning {\n      background-color: var(--warning-color);\n      color: var(--on-warning-color);\n    }\n    \n    button.warning:hover {\n      background-color: #c78500;\n    }\n    \n    button.neutral {\n      background-color: var(--neutral-color);\n      color: var(--on-neutral-color);\n    }\n    \n    button.neutral:hover {\n      background-color: #3d3d3d;\n    }\n    \n    input, select, textarea {\n      width: 100%;\n      padding: 12px;\n      margin-bottom: 10px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 16px;\n      transition: border-color 0.2s;\n      min-height: 44px;\n    }\n    \n    input:focus, select:focus, textarea:focus {\n      border-color: var(--primary-color);\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 0;\n    }\n    \n    textarea {\n      resize: vertical;\n      min-height: 80px;\n    }\n    \n    label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n    }\n    \n    .error {\n      color: var(--error-color);\n      font-size: 14px;\n      margin-top: -5px;\n      margin-bottom: 10px;\n    }\n    \n    .navigation-buttons {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 20px;\n    }\n    \n    .alert {\n      padding: 12px 15px;\n      border-radius: 4px;\n      margin-bottom: 15px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    \n    .alert-success {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n      border-left: 4px solid var(--success-color);\n    }\n    \n    .alert-error {\n      background-color: #ffebee;\n      color: var(--error-color);\n      border-left: 4px solid var(--error-color);\n    }\n    \n    .alert-info {\n      background-color: #e3f2fd;\n      color: #0d47a1;\n      border-left: 4px solid var(--primary-color);\n    }\n    \n    .alert-warning {\n      background-color: #fff8e1;\n      color: #f57f17;\n      border-left: 4px solid var(--warning-color);\n    }\n    \n    .progress-steps {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 30px;\n    }\n    \n    .step {\n      text-align: center;\n      position: relative;\n      width: 25%;\n    }\n    \n    .step-indicator {\n      width: 30px;\n      height: 30px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto 5px;\n      z-index: 2;\n      position: relative;\n    }\n    \n    .progress-bar {\n      height: 8px;\n      background-color: #eee;\n      border-radius: 4px;\n      margin-bottom: 25px;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .progress-indicator {\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      background-color: var(--primary-color);\n      border-radius: 4px;\n      transition: width 0.3s ease;\n    }\n    \n    .screenshot-container {\n      border: 2px dashed #ccc;\n      padding: 20px;\n      text-align: center;\n      margin-bottom: 20px;\n      border-radius: 4px;\n      transition: border-color 0.2s;\n      position: relative;\n      min-height: 150px;\n    }\n    \n    .screenshot-container:hover {\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-container.drag-over {\n      background-color: #f0f7ff;\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-preview {\n      max-width: 100%;\n      max-height: 300px;\n      margin-top: 10px;\n      border-radius: 4px;\n    }\n    \n   .file-input {\n     position: absolute;\n     width: 100%;\n     height: 100%;\n     top: 0;\n     left: 0;\n     opacity: 0;\n     cursor: pointer;\n   }\n   \n   .result-card {\n     background-color: white;\n     padding: 30px;\n     border-radius: var(--border-radius);\n     box-shadow: var(--box-shadow);\n     text-align: center;\n     margin-bottom: 20px;\n   }\n   \n   .trust-badge {\n     display: inline-block;\n     padding: 10px 20px;\n     border-radius: 4px;\n     font-weight: bold;\n     color: white;\n     margin: 15px 0;\n   }\n   \n   .score-display {\n     margin: 20px 0;\n   }\n   \n   .score-number {\n     font-size: 48px;\n     font-weight: bold;\n   }\n   \n   .score-max {\n     color: #666;\n   }\n   \n   .result-message {\n     padding: 15px;\n     background-color: #f5f5f5;\n     border-radius: 8px;\n     font-size: 18px;\n     margin: 20px 0;\n   }\n   \n   .adjustments-list {\n     margin-top: 30px;\n     text-align: left;\n   }\n   \n   .adjustment-item {\n     display: flex;\n     justify-content: space-between;\n     padding: 10px;\n     border-bottom: 1px solid #eee;\n   }\n   \n   .adjustment-points {\n     font-weight: bold;\n   }\n   \n   .adjustment-positive {\n     color: var(--success-color);\n   }\n   \n   .adjustment-negative {\n     color: var(--error-color);\n   }\n   \n   .tooltip {\n     position: relative;\n     display: inline-block;\n     margin-left: 5px;\n     cursor: help;\n   }\n   \n   .tooltip .tooltip-icon {\n     background-color: #ddd;\n     color: #333;\n     width: 24px;\n     height: 24px;\n     border-radius: 50%;\n     display: inline-flex;\n     align-items: center;\n     justify-content: center;\n     font-size: 14px;\n     font-weight: bold;\n   }\n   \n   .tooltip .tooltip-text {\n     visibility: hidden;\n     width: 250px;\n     background-color: #333;\n     color: #fff;\n     text-align: center;\n     border-radius: 6px;\n     padding: 8px;\n     position: absolute;\n     z-index: 1;\n     bottom: 125%;\n     left: 50%;\n     transform: translateX(-50%);\n     opacity: 0;\n     transition: opacity 0.3s;\n     font-size: 14px;\n     font-weight: normal;\n   }\n   \n   .tooltip:hover .tooltip-text {\n     visibility: visible;\n     opacity: 1;\n   }\n   \n   .checkbox-container {\n     display: flex;\n     align-items: flex-start;\n     margin-bottom: 10px;\n     min-height: 44px;\n   }\n   \n   .checkbox-container input[type="checkbox"] {\n     width: auto;\n     min-width: 24px;\n     min-height: 24px;\n     margin-right: 10px;\n     margin-top: 3px;\n   }\n   \n   .checkbox-label {\n     font-weight: normal;\n     flex: 1;\n   }\n   \n   .trust-preview {\n     background-color: #f5f5f5;\n     border: 1px solid #ddd;\n     border-radius: var(--border-radius);\n     padding: 15px;\n     margin-top: 20px;\n   }\n   \n   .trust-preview h3 {\n     margin-top: 0;\n     font-size: 16px;\n     color: #333;\n   }\n   \n   .preview-badge {\n     display: inline-block;\n     padding: 6px 12px;\n     border-radius: 4px;\n     font-size: 14px;\n     color: white;\n     margin-right: 10px;\n   }\n   \n   /* Mobile accessibility styles */\n   @media (max-width: 768px) {\n     .container {\n       padding: 10px;\n     }\n     \n     .form-section {\n       padding: 15px;\n     }\n     \n     .progress-steps {\n       display: none;\n     }\n     \n     .mobile-step-indicator {\n       display: block !important;\n       text-align: center;\n       margin-bottom: 20px;\n     }\n     \n     /* Ensure touch targets are at least 44x44px */\n     button, \n     [role="button"], \n     a,\n     .checkbox-container,\n     input[type="checkbox"],\n     input[type="radio"],\n     input[type="submit"],\n     select,\n     .tooltip {\n       min-height: 44px;\n       min-width: 44px;\n     }\n     \n     /* Improve touch target sizes on mobile */\n     button {\n       padding: 12px 20px;\n       width: 100%;\n       margin: 8px 0;\n       font-size: 16px;\n     }\n     \n     .navigation-buttons {\n       flex-direction: column-reverse;\n       gap: 10px;\n     }\n     \n     /* Adjust form layouts for better touch interaction */\n     .form-section {\n       padding: 20px 16px;\n     }\n     \n     /* Improve checkbox touch targets */\n     .checkbox-container {\n       padding: 8px 0;\n       margin: 8px 0;\n     }\n     \n     .checkbox-container input[type="checkbox"] {\n       transform: scale(1.25);\n       margin-right: 12px;\n       margin-top: 6px;\n     }\n     \n     /* Larger tap target for tooltip */\n     .tooltip .tooltip-icon {\n       width: 30px;\n       height: 30px;\n       font-size: 16px;\n     }\n     \n     /* Adjust spacing between elements */\n     label {\n       margin-bottom: 8px;\n       display: block;\n     }\n     \n     input, select, textarea {\n       padding: 14px;\n       font-size: 16px; /* Prevents iOS zoom on focus */\n       margin-bottom: 16px;\n     }\n     \n     /* Improved error display */\n     .error {\n       padding: 8px 0;\n       font-size: 14px;\n     }\n   }\n   \n   /* Reduced motion preferences */\n   @media (prefers-reduced-motion: reduce) {\n     /* Remove all animations and transitions */\n     *, *::before, *::after {\n       animation-duration: 0.001ms !important;\n       animation-iteration-count: 1 !important;\n       transition-duration: 0.001ms !important;\n       scroll-behavior: auto !important;\n     }\n     \n     /* Specific elements that need animation removal */\n     .progress-indicator {\n       transition: none !important;\n     }\n     \n     .tooltip .tooltip-text {\n       transition: none !important;\n     }\n     \n     /* Replace animations with immediate state changes */\n     .tooltip:hover .tooltip-text {\n       visibility: visible;\n       opacity: 1;\n       transition: none !important;\n     }\n   }\n   \n   /* Focus styles and accessibility support */\n   :focus-visible {\n     outline: var(--focus-ring-width) solid var(--focus-ring-color);\n     outline-offset: 2px;\n     border-radius: 2px;\n   }\n   \n   /* High contrast mode support */\n   @media (forced-colors: active) {\n     .progress-indicator {\n       background-color: SelectedItem;\n     }\n     \n     button {\n       border: 1px solid ButtonText;\n     }\n     \n     :focus-visible {\n       outline: 3px solid CanvasText !important;\n       outline-offset: 3px;\n     }\n   }\n   \n   /* Skip link for keyboard users */\n   .skip-to-content {\n     position: absolute;\n     top: -5rem;\n     left: 0;\n     padding: 1rem;\n     background: var(--primary-color);\n     color: white;\n     z-index: 100;\n     opacity: 0;\n     transition: top 0.2s, opacity 0.2s;\n   }\n   \n   .skip-to-content:focus {\n     top: 0;\n     opacity: 1;\n   }\n   \n   /* Screen reader only text */\n   .sr-only {\n     position: absolute;\n     width: 1px;\n     height: 1px;\n     padding: 0;\n     margin: -1px;\n     overflow: hidden;\n     clip: rect(0, 0, 0, 0);\n     white-space: nowrap;\n     border-width: 0;\n   }\n   \n   /* Form validation visual cues */\n   input:invalid,\n   select:invalid,\n   textarea:invalid {\n     border-color: var(--error-color);\n   }\n   \n   /* Required fields indicator */\n   label.required::after {\n     content: "*";\n     color: var(--error-color);\n     margin-left: 2px;\n   }\n ','</style>\n      <div class="container" dir="').concat((null===(t=o.A.getLanguageInfo(o.A.currentLanguage))||void 0===t?void 0:t.direction)||"ltr",'">\n        ').concat(e,"\n      </div>\n    ")}},{key:"renderWelcomeScreen",value:function(){return'\n      <div class="welcome-screen">\n        <h1>'.concat((0,o.t)("auth.welcome"),"</h1>\n        <p>").concat((0,o.t)("auth.welcomeDescription"),'</p>\n        \n        <div class="welcome-options">\n          <button \n            class="btn-primary" \n            onclick="this.getRootNode().host.handleFirstTimeUser(true)"\n          >\n            ').concat((0,o.t)("auth.firstTime"),'\n          </button>\n          \n          <button \n            class="btn-secondary" \n            onclick="this.getRootNode().host.handleFirstTimeUser(false)"\n          >\n            ').concat((0,o.t)("auth.returningUser"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"renderLoginForm",value:function(){return'\n      <div class="auth-form">\n        <h2>'.concat((0,o.t)("auth.loginTitle"),"</h2>\n        \n        ").concat(this.error?'\n          <div class="alert alert-error" role="alert">\n            '.concat(this.error,"\n          </div>\n        "):"",'\n        \n        <form id="login-form">\n          <div class="form-group">\n            <label for="username">').concat((0,o.t)("auth.username"),'</label>\n            <input type="text" id="username" name="username" required />\n          </div>\n          \n          <div class="form-group">\n            <label for="password">').concat((0,o.t)("auth.password"),'</label>\n            <input type="password" id="password" name="password" required />\n          </div>\n          \n          <div class="form-actions">\n            <button \n              type="submit" \n              class="btn-primary" \n              ').concat(this.isLoading?"disabled":"","\n            >\n              ").concat(this.isLoading?(0,o.t)("auth.loggingIn"):(0,o.t)("auth.login"),'\n            </button>\n            \n            <button \n              type="button" \n              class="btn-link" \n              onclick="this.getRootNode().host.toggleRegistration(true)"\n            >\n              ').concat((0,o.t)("auth.needAccount"),"\n            </button>\n          </div>\n        </form>\n      </div>\n    ")}},{key:"renderRegistrationForm",value:function(){return'\n      <div class="auth-form">\n        <h2>'.concat((0,o.t)("auth.registerTitle"),"</h2>\n        \n        ").concat(this.error?'\n          <div class="alert alert-error" role="alert">\n            '.concat(this.error,"\n          </div>\n        "):"",'\n        \n        <form id="registration-form">\n          <div class="form-group">\n            <label for="reg-email">').concat((0,o.t)("auth.email"),'</label>\n            <input type="email" id="reg-email" name="email" required />\n          </div>\n          \n          <div class="form-group">\n            <label for="reg-username">').concat((0,o.t)("auth.username"),'</label>\n            <input type="text" id="reg-username" name="username" required />\n          </div>\n          \n          <div class="form-group">\n            <label for="reg-password">').concat((0,o.t)("auth.password"),'</label>\n            <input type="password" id="reg-password" name="password" required />\n            <div class="password-requirements">\n              <small>').concat((0,o.t)("auth.passwordRequirements"),'</small>\n            </div>\n          </div>\n          \n          <div class="form-group">\n            <label for="reg-confirm-password">').concat((0,o.t)("auth.confirmPassword"),'</label>\n            <input type="password" id="reg-confirm-password" name="confirmPassword" required />\n          </div>\n          \n          <div class="form-actions">\n            <button \n              type="submit" \n              class="btn-primary" \n              ').concat(this.isLoading?"disabled":"","\n            >\n              ").concat(this.isLoading?(0,o.t)("auth.registering"):(0,o.t)("auth.register"),'\n            </button>\n            \n            <button \n              type="button" \n              class="btn-link" \n              onclick="this.getRootNode().host.toggleRegistration(false)"\n            >\n              ').concat((0,o.t)("auth.haveAccount"),"\n            </button>\n          </div>\n        </form>\n      </div>\n    ")}},{key:"renderAuthenticatedState",value:function(){var t;return'\n      <div class="auth-status">\n        <p>'.concat((0,o.t)("auth.loggedInAs",{username:(null===(t=this.user)||void 0===t?void 0:t.username)||"User"}),'</p>\n        <button \n          class="btn-secondary" \n          onclick="this.getRootNode().host.handleLogout()"\n        >\n          ').concat((0,o.t)("auth.logout"),"\n        </button>\n      </div>\n    ")}},{key:"toggleRegistration",value:function(t){this.isRegistering=t,this.error=null,this.render()}},{key:"handleSubmit",value:(g=c(a().mark((function t(e){var n,r;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),this.isLoading=!0,this.error=null,this.render(),n=e.target,r=new FormData(n),t.prev=6,!this.isRegistering){t.next=12;break}return t.next=10,this.handleRegistration(r);case 10:t.next=14;break;case 12:return t.next=14,this.handleLogin(r);case 14:t.next=27;break;case 16:if(t.prev=16,t.t0=t.catch(6),console.error("Authentication error:",t.t0),!t.t0.isChallenge||!t.t0.challengeData){t.next=26;break}return console.log("🔄 Password challenge detected, modal should appear..."),this.isLoading=!1,this.render(),t.abrupt("return");case 26:this.error=t.t0.message||(0,o.t)("auth.genericError");case 27:return t.prev=27,this.isLoading=!1,this.render(),t.finish(27);case 31:case"end":return t.stop()}}),t,this,[[6,16,27,31]])}))),function(t){return g.apply(this,arguments)})},{key:"handleRegistration",value:(v=c(a().mark((function t(e){var n,i,s,c;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.get("email"),i=e.get("username"),s=e.get("password"),c=e.get("confirmPassword"),s===c){t.next=6;break}throw new Error((0,o.t)("auth.passwordsDoNotMatch"));case 6:return t.next=8,r.D.registerUser({email:n,username:i,password:s});case 8:if(!t.sent.requiresConfirmation){t.next=13;break}this.dispatchAuthEvent("registration-pending",{username:i,email:n}),t.next=15;break;case 13:return t.next=15,this.handleLogin(e);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"handleLogin",value:(f=c(a().mark((function t(e){var n,o,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.get("username"),o=e.get("password"),t.prev=2,t.next=5,r.D.loginUser(n,o);case 5:i=t.sent,this.isAuthenticated=!0,this.user=i,this.dispatchAuthEvent("authenticated",i),this.render(),t.next=20;break;case 12:if(t.prev=12,t.t0=t.catch(2),!t.t0.isChallenge||!t.t0.challengeData){t.next=19;break}throw console.log("🔄 Password challenge detected, modal should appear..."),t.t0;case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,this,[[2,12]])}))),function(t){return f.apply(this,arguments)})},{key:"handleLogout",value:(l=c(a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.D.logoutUser();case 3:this.isAuthenticated=!1,this.user=null,this.dispatchAuthEvent("logged-out"),this.render(),t.next=14;break;case 9:t.prev=9,t.t0=t.catch(0),console.error("Logout error:",t.t0),this.error=t.t0.message||(0,o.t)("auth.logoutError"),this.render();case 14:case"end":return t.stop()}}),t,this,[[0,9]])}))),function(){return l.apply(this,arguments)})},{key:"handleFirstTimeUser",value:function(t){this.isRegistering=!!t,this.render()}},{key:"dispatchAuthEvent",value:function(t){var e=new CustomEvent("casl-auth",{detail:{type:t,data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null},bubbles:!0,composed:!0});this.dispatchEvent(e)}},{key:"setupEventListeners",value:function(){var t=this;setTimeout((function(){var e=t.shadowRoot.getElementById("login-form");e&&e.addEventListener("submit",t.handleSubmit.bind(t));var n=t.shadowRoot.getElementById("registration-form");n&&n.addEventListener("submit",t.handleSubmit.bind(t))}),0)}}],s&&u(n.prototype,s),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,s,l,f,v,g,y}(f(HTMLElement));customElements.define("casl-authentication",v)},341:(t,e,n)=>{function r(){return'\n    :host {\n      display: block;\n      font-family: Arial, sans-serif;\n      \n      /* Primary colors with contrast-safe text colors */\n      --primary-color: #4285F4;\n      --primary-color-dark: #1a5dd4;\n      --on-primary-color: #ffffff;\n      \n      --success-color: #4CAF50;\n      --on-success-color: #ffffff;\n      \n      --warning-color: #EC9F05; /* Darkened for better contrast */\n      --on-warning-color: #000000;\n      \n      --error-color: #c62828;\n      --on-error-color: #ffffff;\n      \n      --neutral-color: #5C5C5C; /* Darkened for better contrast */\n      --on-neutral-color: #ffffff;\n      \n      --surface-color: #ffffff;\n      --on-surface-color: #212121;\n      \n      --disabled-color: #9E9E9E;\n      --on-disabled-color: #212121;\n      \n      --border-radius: 8px;\n      --box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      --focus-ring-color: #4285F4;\n      --focus-ring-width: 3px;\n    }\n    \n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    \n    .form-section {\n      background-color: var(--surface-color);\n      padding: 20px;\n      border-radius: var(--border-radius);\n      margin-bottom: 20px;\n      box-shadow: var(--box-shadow);\n    }\n    \n    button {\n      padding: 10px 20px;\n      background-color: var(--primary-color);\n      color: var(--on-primary-color);\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      margin: 5px;\n      transition: background-color 0.2s, opacity 0.2s;\n      min-height: 44px;\n    }\n    \n    button:hover {\n      background-color: var(--primary-color-dark);\n    }\n    \n    button:focus {\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 2px;\n    }\n    \n    button:disabled {\n      background-color: var(--disabled-color);\n      color: var(--on-disabled-color);\n      cursor: not-allowed;\n    }\n    \n    button.success {\n      background-color: var(--success-color);\n      color: var(--on-success-color);\n    }\n    \n    button.success:hover {\n      background-color: #3d8b40;\n    }\n    \n    button.warning {\n      background-color: var(--warning-color);\n      color: var(--on-warning-color);\n    }\n    \n    button.warning:hover {\n      background-color: #c78500;\n    }\n    \n    button.neutral {\n      background-color: var(--neutral-color);\n      color: var(--on-neutral-color);\n    }\n    \n    button.neutral:hover {\n      background-color: #3d3d3d;\n    }\n    \n    input, select, textarea {\n      width: 100%;\n      padding: 12px;\n      margin-bottom: 10px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 16px;\n      transition: border-color 0.2s;\n      min-height: 44px;\n    }\n    \n    input:focus, select:focus, textarea:focus {\n      border-color: var(--primary-color);\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 0;\n    }\n    \n    textarea {\n      resize: vertical;\n      min-height: 80px;\n    }\n    \n    label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n    }\n    \n    .error {\n      color: var(--error-color);\n      font-size: 14px;\n      margin-top: -5px;\n      margin-bottom: 10px;\n    }\n    \n    .navigation-buttons {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 20px;\n    }\n    \n    .alert {\n      padding: 12px 15px;\n      border-radius: 4px;\n      margin-bottom: 15px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    \n    .alert-success {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n      border-left: 4px solid var(--success-color);\n    }\n    \n    .alert-error {\n      background-color: #ffebee;\n      color: var(--error-color);\n      border-left: 4px solid var(--error-color);\n    }\n    \n    .alert-info {\n      background-color: #e3f2fd;\n      color: #0d47a1;\n      border-left: 4px solid var(--primary-color);\n    }\n    \n    .alert-warning {\n      background-color: #fff8e1;\n      color: #f57f17;\n      border-left: 4px solid var(--warning-color);\n    }\n    \n    .progress-steps {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 30px;\n    }\n    \n    .step {\n      text-align: center;\n      position: relative;\n      width: 25%;\n    }\n    \n    .step-indicator {\n      width: 30px;\n      height: 30px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto 5px;\n      z-index: 2;\n      position: relative;\n    }\n    \n    .progress-bar {\n      height: 8px;\n      background-color: #eee;\n      border-radius: 4px;\n      margin-bottom: 25px;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .progress-indicator {\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      background-color: var(--primary-color);\n      border-radius: 4px;\n      transition: width 0.3s ease;\n    }\n    \n    .screenshot-container {\n      border: 2px dashed #ccc;\n      padding: 20px;\n      text-align: center;\n      margin-bottom: 20px;\n      border-radius: 4px;\n      transition: border-color 0.2s;\n      position: relative;\n      min-height: 150px;\n    }\n    \n    .screenshot-container:hover {\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-container.drag-over {\n      background-color: #f0f7ff;\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-preview {\n      max-width: 100%;\n      max-height: 300px;\n      margin-top: 10px;\n      border-radius: 4px;\n    }\n    \n   .file-input {\n     position: absolute;\n     width: 100%;\n     height: 100%;\n     top: 0;\n     left: 0;\n     opacity: 0;\n     cursor: pointer;\n   }\n   \n   .result-card {\n     background-color: white;\n     padding: 30px;\n     border-radius: var(--border-radius);\n     box-shadow: var(--box-shadow);\n     text-align: center;\n     margin-bottom: 20px;\n   }\n   \n   .trust-badge {\n     display: inline-block;\n     padding: 10px 20px;\n     border-radius: 4px;\n     font-weight: bold;\n     color: white;\n     margin: 15px 0;\n   }\n   \n   .score-display {\n     margin: 20px 0;\n   }\n   \n   .score-number {\n     font-size: 48px;\n     font-weight: bold;\n   }\n   \n   .score-max {\n     color: #666;\n   }\n   \n   .result-message {\n     padding: 15px;\n     background-color: #f5f5f5;\n     border-radius: 8px;\n     font-size: 18px;\n     margin: 20px 0;\n   }\n   \n   .adjustments-list {\n     margin-top: 30px;\n     text-align: left;\n   }\n   \n   .adjustment-item {\n     display: flex;\n     justify-content: space-between;\n     padding: 10px;\n     border-bottom: 1px solid #eee;\n   }\n   \n   .adjustment-points {\n     font-weight: bold;\n   }\n   \n   .adjustment-positive {\n     color: var(--success-color);\n   }\n   \n   .adjustment-negative {\n     color: var(--error-color);\n   }\n   \n   .tooltip {\n     position: relative;\n     display: inline-block;\n     margin-left: 5px;\n     cursor: help;\n   }\n   \n   .tooltip .tooltip-icon {\n     background-color: #ddd;\n     color: #333;\n     width: 24px;\n     height: 24px;\n     border-radius: 50%;\n     display: inline-flex;\n     align-items: center;\n     justify-content: center;\n     font-size: 14px;\n     font-weight: bold;\n   }\n   \n   .tooltip .tooltip-text {\n     visibility: hidden;\n     width: 250px;\n     background-color: #333;\n     color: #fff;\n     text-align: center;\n     border-radius: 6px;\n     padding: 8px;\n     position: absolute;\n     z-index: 1;\n     bottom: 125%;\n     left: 50%;\n     transform: translateX(-50%);\n     opacity: 0;\n     transition: opacity 0.3s;\n     font-size: 14px;\n     font-weight: normal;\n   }\n   \n   .tooltip:hover .tooltip-text {\n     visibility: visible;\n     opacity: 1;\n   }\n   \n   .checkbox-container {\n     display: flex;\n     align-items: flex-start;\n     margin-bottom: 10px;\n     min-height: 44px;\n   }\n   \n   .checkbox-container input[type="checkbox"] {\n     width: auto;\n     min-width: 24px;\n     min-height: 24px;\n     margin-right: 10px;\n     margin-top: 3px;\n   }\n   \n   .checkbox-label {\n     font-weight: normal;\n     flex: 1;\n   }\n   \n   .trust-preview {\n     background-color: #f5f5f5;\n     border: 1px solid #ddd;\n     border-radius: var(--border-radius);\n     padding: 15px;\n     margin-top: 20px;\n   }\n   \n   .trust-preview h3 {\n     margin-top: 0;\n     font-size: 16px;\n     color: #333;\n   }\n   \n   .preview-badge {\n     display: inline-block;\n     padding: 6px 12px;\n     border-radius: 4px;\n     font-size: 14px;\n     color: white;\n     margin-right: 10px;\n   }\n   \n   /* Mobile accessibility styles */\n   @media (max-width: 768px) {\n     .container {\n       padding: 10px;\n     }\n     \n     .form-section {\n       padding: 15px;\n     }\n     \n     .progress-steps {\n       display: none;\n     }\n     \n     .mobile-step-indicator {\n       display: block !important;\n       text-align: center;\n       margin-bottom: 20px;\n     }\n     \n     /* Ensure touch targets are at least 44x44px */\n     button, \n     [role="button"], \n     a,\n     .checkbox-container,\n     input[type="checkbox"],\n     input[type="radio"],\n     input[type="submit"],\n     select,\n     .tooltip {\n       min-height: 44px;\n       min-width: 44px;\n     }\n     \n     /* Improve touch target sizes on mobile */\n     button {\n       padding: 12px 20px;\n       width: 100%;\n       margin: 8px 0;\n       font-size: 16px;\n     }\n     \n     .navigation-buttons {\n       flex-direction: column-reverse;\n       gap: 10px;\n     }\n     \n     /* Adjust form layouts for better touch interaction */\n     .form-section {\n       padding: 20px 16px;\n     }\n     \n     /* Improve checkbox touch targets */\n     .checkbox-container {\n       padding: 8px 0;\n       margin: 8px 0;\n     }\n     \n     .checkbox-container input[type="checkbox"] {\n       transform: scale(1.25);\n       margin-right: 12px;\n       margin-top: 6px;\n     }\n     \n     /* Larger tap target for tooltip */\n     .tooltip .tooltip-icon {\n       width: 30px;\n       height: 30px;\n       font-size: 16px;\n     }\n     \n     /* Adjust spacing between elements */\n     label {\n       margin-bottom: 8px;\n       display: block;\n     }\n     \n     input, select, textarea {\n       padding: 14px;\n       font-size: 16px; /* Prevents iOS zoom on focus */\n       margin-bottom: 16px;\n     }\n     \n     /* Improved error display */\n     .error {\n       padding: 8px 0;\n       font-size: 14px;\n     }\n   }\n   \n   /* Reduced motion preferences */\n   @media (prefers-reduced-motion: reduce) {\n     /* Remove all animations and transitions */\n     *, *::before, *::after {\n       animation-duration: 0.001ms !important;\n       animation-iteration-count: 1 !important;\n       transition-duration: 0.001ms !important;\n       scroll-behavior: auto !important;\n     }\n     \n     /* Specific elements that need animation removal */\n     .progress-indicator {\n       transition: none !important;\n     }\n     \n     .tooltip .tooltip-text {\n       transition: none !important;\n     }\n     \n     /* Replace animations with immediate state changes */\n     .tooltip:hover .tooltip-text {\n       visibility: visible;\n       opacity: 1;\n       transition: none !important;\n     }\n   }\n   \n   /* Focus styles and accessibility support */\n   :focus-visible {\n     outline: var(--focus-ring-width) solid var(--focus-ring-color);\n     outline-offset: 2px;\n     border-radius: 2px;\n   }\n   \n   /* High contrast mode support */\n   @media (forced-colors: active) {\n     .progress-indicator {\n       background-color: SelectedItem;\n     }\n     \n     button {\n       border: 1px solid ButtonText;\n     }\n     \n     :focus-visible {\n       outline: 3px solid CanvasText !important;\n       outline-offset: 3px;\n     }\n   }\n   \n   /* Skip link for keyboard users */\n   .skip-to-content {\n     position: absolute;\n     top: -5rem;\n     left: 0;\n     padding: 1rem;\n     background: var(--primary-color);\n     color: white;\n     z-index: 100;\n     opacity: 0;\n     transition: top 0.2s, opacity 0.2s;\n   }\n   \n   .skip-to-content:focus {\n     top: 0;\n     opacity: 1;\n   }\n   \n   /* Screen reader only text */\n   .sr-only {\n     position: absolute;\n     width: 1px;\n     height: 1px;\n     padding: 0;\n     margin: -1px;\n     overflow: hidden;\n     clip: rect(0, 0, 0, 0);\n     white-space: nowrap;\n     border-width: 0;\n   }\n   \n   /* Form validation visual cues */\n   input:invalid,\n   select:invalid,\n   textarea:invalid {\n     border-color: var(--error-color);\n   }\n   \n   /* Required fields indicator */\n   label.required::after {\n     content: "*";\n     color: var(--error-color);\n     margin-left: 2px;\n   }\n '}n.d(e,{$:()=>r})},361:(t,e,n)=>{n.d(e,{D:()=>l}),n(660);var r=n(182);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){i=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function f(e,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return l(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=d(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h={};function p(){}function v(){}function g(){}var y={};l(y,s,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(_([])));b&&b!==n&&r.call(b,s)&&(y=b);var w=g.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(i,a,s,c){var u=d(t[i],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==o(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,c)}),(function(t){n("throw",t,s,c)})):e.resolve(f).then((function(t){l.value=t,s(l)}),(function(t){return n("throw",t,s,c)}))}c(u.arg)}var i;l(this,"_invoke",(function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=d(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return v.prototype=g,l(w,"constructor",g),l(g,"constructor",v),v.displayName=l(g,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,l(t,u,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),l(k.prototype,c,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(f(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),l(w,u,"Generator"),l(w,s,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),h}},e}function a(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function s(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function s(t){a(i,r,o,s,c,"next",t)}function c(t){a(i,r,o,s,c,"throw",t)}s(void 0)}))}}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function u(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}var l=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.userPoolId=null,this.clientId=null,this.region="us-east-2",this.currentUser=null,this.accessToken=null,this.refreshToken=null,this._initialized=this.initialize()},e=[{key:"initialize",value:(y=s(i().mark((function t(){var e,n,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.fetchConfiguration();case 3:if(r=t.sent,this.userPoolId=null===(e=r.auth)||void 0===e?void 0:e.userPoolId,this.clientId=null===(n=r.auth)||void 0===n?void 0:n.userPoolWebClientId,this.userPoolId&&this.clientId){t.next=8;break}throw new Error("[userService] Missing required config values");case 8:return t.next=10,this.loadStoredSession();case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Failed to initialize user service:",t.t0);case 15:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return y.apply(this,arguments)})},{key:"whenReady",value:(g=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._initialized;case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.error("[UserService] Initialization error in whenReady():",t.t0);case 8:case"end":return t.stop()}}),t,this,[[0,5]])}))),function(){return g.apply(this,arguments)})},{key:"fetchConfiguration",value:(v=s(i().mark((function t(){var e;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/casl-config"),{method:"GET",headers:{"Content-Type":"application/json"}});case 3:if((e=t.sent).ok){t.next=6;break}throw new Error("Failed config fetch: ".concat(e.status));case 6:return t.next=8,e.json();case 8:return t.abrupt("return",t.sent);case 11:return t.prev=11,t.t0=t.catch(0),console.error("Error fetching configuration:",t.t0),t.abrupt("return",{auth:{userPoolId:"us-east-2_wxVzxzC7V",userPoolWebClientId:"6eihn0891v31dsovg33g2e1h90"}});case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))),function(){return v.apply(this,arguments)})},{key:"loadStoredSession",value:(p=s(i().mark((function t(){var e,n,r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=localStorage.getItem("casl_access_token"),n=localStorage.getItem("casl_refresh_token"),r=localStorage.getItem("casl_user_data"),!(e&&n&&r)){t.next=18;break}return t.next=7,this.validateToken(e);case 7:if(!t.sent){t.next=14;break}this.accessToken=e,this.refreshToken=n,this.currentUser=JSON.parse(r),t.next=18;break;case 14:return t.next=16,this.refreshSession(n);case 16:t.sent||this.clearSession();case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(0),console.error("Error loading session:",t.t0),this.clearSession();case 24:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(){return p.apply(this,arguments)})},{key:"validateToken",value:(h=s(i().mark((function t(e){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/validate-token"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});case 3:return n=t.sent,t.abrupt("return",n.ok);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Token validation error:",t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return h.apply(this,arguments)})},{key:"refreshSession",value:(d=s(i().mark((function t(e){var n,o;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/refresh-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});case 3:if((n=t.sent).ok){t.next=6;break}throw new Error("Refresh failed");case 6:return t.next=8,n.json();case 8:return o=t.sent,this.accessToken=o.accessToken,this.refreshToken=o.refreshToken,localStorage.setItem("casl_access_token",this.accessToken),localStorage.setItem("casl_refresh_token",this.refreshToken),t.abrupt("return",!0);case 16:return t.prev=16,t.t0=t.catch(0),console.error("Refresh error:",t.t0),t.abrupt("return",!1);case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return d.apply(this,arguments)})},{key:"registerUser",value:(f=s(i().mark((function t(e){var n,o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e.username,email:e.email,password:e.password})});case 3:if((n=t.sent).ok){t.next=9;break}return t.next=7,n.json();case 7:throw o=t.sent,new Error(o.message||"Registration failed");case 9:return t.next=11,n.json();case 11:return a=t.sent,t.abrupt("return",{success:!0,username:e.username,requiresConfirmation:a.requiresConfirmation||!1});case 15:throw t.prev=15,t.t0=t.catch(0),console.error("Registration error:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(t){return f.apply(this,arguments)})},{key:"confirmRegistration",value:(l=s(i().mark((function t(e,n){var o,a;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/confirm-registration"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,code:n})});case 3:if((o=t.sent).ok){t.next=9;break}return t.next=7,o.json();case 7:throw a=t.sent,new Error(a.message||"Confirmation failed");case 9:return t.abrupt("return",!0);case 12:throw t.prev=12,t.t0=t.catch(0),console.error("Confirmation error:",t.t0),t.t0;case 16:case"end":return t.stop()}}),t,null,[[0,12]])}))),function(t,e){return l.apply(this,arguments)})},{key:"loginUser",value:(u=s(i().mark((function t(e,n){var o,a,s,c,u,l,f;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})});case 3:if((s=t.sent).ok){t.next=9;break}return t.next=7,s.json();case 7:throw c=t.sent,new Error(c.message||"Login failed");case 9:return t.next=11,s.json();case 11:if("NEW_PASSWORD_REQUIRED"!==(u=t.sent).challenge){t.next=20;break}throw console.log("🔄 Password reset required, dispatching event..."),l=new CustomEvent("casl-password-reset-required",{detail:{session:u.session,username:u.username||e,message:u.message},bubbles:!0,composed:!0}),document.dispatchEvent(l),(f=new Error("NEW_PASSWORD_REQUIRED")).isChallenge=!0,f.challengeData={session:u.session,username:u.username||e},f;case 20:if(u.success){t.next=22;break}throw new Error(u.error||"Login failed");case 22:return this.accessToken=u.accessToken,this.refreshToken=u.refreshToken,this.currentUser={username:e,email:(null===(o=u.user)||void 0===o?void 0:o.email)||u.email,id:(null===(a=u.user)||void 0===a?void 0:a.username)||u.userId,attributes:u.user||{}},localStorage.setItem("casl_access_token",this.accessToken),localStorage.setItem("casl_refresh_token",this.refreshToken),localStorage.setItem("casl_user_data",JSON.stringify(this.currentUser)),t.abrupt("return",this.currentUser);case 31:if(t.prev=31,t.t0=t.catch(0),console.error("Login error:",t.t0),!t.t0.isChallenge){t.next=36;break}throw t.t0;case 36:throw t.t0;case 37:case"end":return t.stop()}}),t,this,[[0,31]])}))),function(t,e){return u.apply(this,arguments)})},{key:"setNewPassword",value:(a=s(i().mark((function t(e,n,o){var a,s,c,u,l;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(r.JR,"/set-new-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:e,username:n,newPassword:o})});case 3:if((c=t.sent).ok){t.next=9;break}return t.next=7,c.json();case 7:throw u=t.sent,new Error(u.error||"Password update failed");case 9:return t.next=11,c.json();case 11:if((l=t.sent).success){t.next=14;break}throw new Error(l.error||"Password update failed");case 14:return this.accessToken=l.accessToken,this.refreshToken=l.refreshToken,this.currentUser={username:n,email:null===(a=l.user)||void 0===a?void 0:a.email,id:null===(s=l.user)||void 0===s?void 0:s.username,attributes:l.user||{}},localStorage.setItem("casl_access_token",this.accessToken),localStorage.setItem("casl_refresh_token",this.refreshToken),localStorage.setItem("casl_user_data",JSON.stringify(this.currentUser)),t.abrupt("return",this.currentUser);case 23:throw t.prev=23,t.t0=t.catch(0),console.error("Set new password error:",t.t0),t.t0;case 27:case"end":return t.stop()}}),t,this,[[0,23]])}))),function(t,e,n){return a.apply(this,arguments)})},{key:"logoutUser",value:(o=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.accessToken){t.next=4;break}return t.next=4,fetch("".concat(r.JR,"/logout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.accessToken)}});case 4:return this.clearSession(),t.abrupt("return",!0);case 8:return t.prev=8,t.t0=t.catch(0),console.error("Logout error:",t.t0),this.clearSession(),t.abrupt("return",!0);case 13:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return o.apply(this,arguments)})},{key:"clearSession",value:function(){this.accessToken=null,this.refreshToken=null,this.currentUser=null,localStorage.removeItem("casl_access_token"),localStorage.removeItem("casl_refresh_token"),localStorage.removeItem("casl_user_data")}},{key:"getCurrentUser",value:(n=s(i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.currentUser||!this.accessToken){t.next=12;break}return t.next=3,this.validateToken(this.accessToken);case 3:if(!t.sent){t.next=6;break}return t.abrupt("return",{isAuthenticated:!0,user:this.currentUser});case 6:return t.next=8,this.refreshSession(this.refreshToken);case 8:if(!t.sent){t.next=11;break}return t.abrupt("return",{isAuthenticated:!0,user:this.currentUser});case 11:this.clearSession();case 12:return t.abrupt("return",{isAuthenticated:!1,user:null});case 13:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getAuthHeaders",value:function(){return this.accessToken?{Authorization:"Bearer ".concat(this.accessToken)}:{}}}],e&&c(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o,a,u,l,f,d,h,p,v,g,y}())},660:()=>{function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function e(t,e,n){return(e=o(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,o(r.key),r)}}function o(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var i=new(function(){return o=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.defaults={API_BASE_URL:"https://2mez9qoyt6.execute-api.us-east-2.amazonaws.com/prod",DEBUG_MODE:!1,LOG_LEVEL:"error",AUTH_COOKIE_NAME:"casl_auth_token",AUTH_COOKIE_DOMAIN:window.location.hostname,AUTH_COOKIE_SECURE:"https:"===window.location.protocol,AUTH_COOKIE_MAX_AGE:604800,REFRESH_TOKEN_COOKIE_NAME:"casl_refresh_token",USER_DATA_KEY:"casl_user_data",STORAGE_PREFIX:"casl_",LOCALIZATION_KEY:"casl_language",DEFAULT_LANGUAGE:"en",FORM_AUTO_SAVE:!0,ENABLE_ANALYTICS:!1,VERIFICATION_EXPIRY_DAYS:365,VERIFICATION_MIN_SCORE:50,MAX_SCREENSHOT_SIZE:5242880,VERIFICATION_METHODS:["screenshot","government-id","phone","social","background-check"],ALLOWED_IMAGE_TYPES:["image/jpeg","image/png","image/webp"],VERIFICATION_POLL_INTERVAL:3e3,COGNITO_REGION:"us-east-2",COGNITO_USER_POOL_ID:"us-east-2_wxVzxzC7V",COGNITO_CLIENT_ID:"6eihn0891v31dsovg33g2e1h90",REQUIRE_SECURE_CONTEXT:!0},this.config={},this.init()},i=[{key:"init",value:function(){this.loadFromGlobalConfig(),this.loadFromMetaTags(),this.loadFromLocalStorage(),this.mergeDefaults(),this.validateSecureContext()}},{key:"loadFromGlobalConfig",value:function(){var t=this;try{if("undefined"!=typeof window&&window.CASL_CONFIG){var e=this.flattenConfig(window.CASL_CONFIG);Object.keys(e).forEach((function(n){t.config[n]=e[n]}))}}catch(t){console.warn("Could not load config from global config object:",t)}}},{key:"flattenConfig",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(t).reduce((function(o,i){var a=r.length?"".concat(r,"_"):"";return"object"!==n(t[i])||null===t[i]||Array.isArray(t[i])?o["".concat(a).concat(i).toUpperCase()]=t[i]:Object.assign(o,e.flattenConfig(t[i],"".concat(a).concat(i))),o}),{})}},{key:"loadFromMetaTags",value:function(){var t=this;try{document.querySelectorAll('meta[name^="casl-config-"]').forEach((function(e){var n=e.getAttribute("name").replace("casl-config-","").toUpperCase(),r=e.getAttribute("content");t.config[n]=t.parseValue(r)}))}catch(t){console.warn("Could not load config from meta tags:",t)}}},{key:"loadFromLocalStorage",value:function(){var t=this;try{var e=localStorage.getItem("casl_config");if(e){var n=JSON.parse(e);Object.keys(n).forEach((function(e){t.config[e]=n[e]}))}}catch(t){console.warn("Could not load config from local storage:",t)}}},{key:"mergeDefaults",value:function(){var t=this;Object.keys(this.defaults).forEach((function(e){void 0===t.config[e]&&(t.config[e]=t.defaults[e])})),this.transformConfig()}},{key:"transformConfig",value:function(){var t=this;["DEBUG_MODE","AUTH_COOKIE_SECURE","FORM_AUTO_SAVE","ENABLE_ANALYTICS","REQUIRE_SECURE_CONTEXT"].forEach((function(e){"string"==typeof t.config[e]&&(t.config[e]=t.parseBoolean(t.config[e]))})),["AUTH_COOKIE_MAX_AGE","VERIFICATION_EXPIRY_DAYS","VERIFICATION_MIN_SCORE","MAX_SCREENSHOT_SIZE","VERIFICATION_POLL_INTERVAL"].forEach((function(e){"string"==typeof t.config[e]&&(t.config[e]=parseInt(t.config[e],10))})),["VERIFICATION_METHODS","ALLOWED_IMAGE_TYPES"].forEach((function(e){"string"==typeof t.config[e]&&(t.config[e]=t.config[e].split(",").map((function(t){return t.trim()})))}))}},{key:"parseValue",value:function(t){try{return JSON.parse(t)}catch(e){return t}}},{key:"parseBoolean",value:function(t){return"true"===t.toLowerCase()||"1"===t||"yes"===t||"y"===t}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0!==this.config[t]?this.config[t]:e}},{key:"getApiBaseUrl",value:function(){var t;return"undefined"!=typeof window&&null!==(t=window.CASL_CONFIG)&&void 0!==t&&null!==(t=t.api)&&void 0!==t&&t.baseUrl?window.CASL_CONFIG.api.baseUrl:this.get("API_BASE_URL")}},{key:"isDebugMode",value:function(){return this.get("DEBUG_MODE",!1)}},{key:"getAuthCookieConfig",value:function(){return{name:this.get("AUTH_COOKIE_NAME"),domain:this.get("AUTH_COOKIE_DOMAIN"),secure:this.get("AUTH_COOKIE_SECURE"),maxAge:this.get("AUTH_COOKIE_MAX_AGE"),sameSite:"strict",path:"/"}}},{key:"getRefreshTokenCookieConfig",value:function(){return{name:this.get("REFRESH_TOKEN_COOKIE_NAME"),domain:this.get("AUTH_COOKIE_DOMAIN"),secure:this.get("AUTH_COOKIE_SECURE"),maxAge:2*this.get("AUTH_COOKIE_MAX_AGE"),sameSite:"strict",path:"/"}}},{key:"getVerificationMethods",value:function(){return this.get("VERIFICATION_METHODS",[])}},{key:"getAllowedImageTypes",value:function(){return this.get("ALLOWED_IMAGE_TYPES",[])}},{key:"validateSecureContext",value:function(){this.get("REQUIRE_SECURE_CONTEXT")&&"undefined"!=typeof window&&(window.isSecureContext||console.warn("Application requires a secure context (HTTPS) but is running in an insecure context."))}},{key:"set",value:function(t,e){this.config[t]=e,this.saveToLocalStorage()}},{key:"saveToLocalStorage",value:function(){var t=this;try{var e={},n=["API_KEY","AWS_ACCESS_KEY","AWS_SECRET_KEY","STRIPE_KEY"];Object.keys(this.config).forEach((function(r){n.includes(r)||(e[r]=t.config[r])})),localStorage.setItem("casl_config",JSON.stringify(e))}catch(t){console.warn("Could not save config to local storage:",t)}}},{key:"reset",value:function(){this.config=function(n){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach((function(t){e(n,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))}))}return n}({},this.defaults),this.saveToLocalStorage()}}],i&&r(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),o;var o,i}());function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,c(r.key),r)}}function c(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}var u=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners=[],this.lastError=null,this.errorCategories={NETWORK:"network",AUTH:"authentication",VALIDATION:"validation",API:"api",PAYMENT:"payment",UNKNOWN:"unknown"},this.handleGlobalErrors()},e=[{key:"handleGlobalErrors",value:function(){var t=this;window.addEventListener("unhandledrejection",(function(e){t.handleError(e.reason||new Error("Unhandled Promise rejection"))})),window.addEventListener("error",(function(e){t.handleError(e.error||new Error(e.message))}))}},{key:"categorizeError",value:function(t){return t?"NetworkError"===t.name||t.message.includes("network")||t.message.includes("failed to fetch")||t.message.includes("timeout")?this.errorCategories.NETWORK:"AuthError"===t.name||t.message.includes("unauthorized")||t.message.includes("forbidden")||t.message.includes("token")||401===t.status||403===t.status?this.errorCategories.AUTH:"ValidationError"===t.name||t.message.includes("validation")||t.message.includes("invalid")||t.message.includes("required")?this.errorCategories.VALIDATION:"ApiError"===t.name||t.status>=400||t.message.includes("api")||t.message.includes("endpoint")?this.errorCategories.API:"PaymentError"===t.name||t.message.includes("payment")||t.message.includes("transaction")||t.message.includes("purchase")?this.errorCategories.PAYMENT:this.errorCategories.UNKNOWN:this.errorCategories.UNKNOWN}},{key:"processError",value:function(t){"string"==typeof t&&(t=new Error(t)),t instanceof Error||(t=new Error("Unknown error"));var e=this.categorizeError(t),n=(new Date).toISOString();return{id:"err_".concat(n.replace(/[-:.TZ]/g,""),"_").concat(Math.random().toString(36).substr(2,5)),message:t.message,category:e,timestamp:n,name:t.name,stack:t.stack,status:t.status||null,code:t.code||null,data:t.data||null,handled:!1}}},{key:"logError",value:function(t){console.error("[".concat(t.category.toUpperCase(),"] ").concat(t.id,": ").concat(t.message),t)}},{key:"handleError",value:function(t){var e=this.processError(t);return this.logError(e),this.lastError=e,this.notifyListeners(e),e.handled=!0,e}},{key:"getUserFriendlyMessage",value:function(t){switch(t.category){case this.errorCategories.NETWORK:return"Network error. Please check your internet connection and try again.";case this.errorCategories.AUTH:return"Authentication error. Please log in again.";case this.errorCategories.VALIDATION:return t.message||"Please check your input and try again.";case this.errorCategories.API:return"Server error. Please try again later.";case this.errorCategories.PAYMENT:return"Payment processing error. Please try again or use a different payment method.";case this.errorCategories.UNKNOWN:default:return"An unexpected error occurred. Please try again."}}},{key:"createValidationError",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Error(t);return n.name="ValidationError",n.fieldErrors=e,n.category=this.errorCategories.VALIDATION,n}},{key:"createAuthError",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:401,n=new Error(t);return n.name="AuthError",n.status=e,n.category=this.errorCategories.AUTH,n}},{key:"createApiError",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new Error(t);return r.name="ApiError",r.status=e,r.data=n,r.category=this.errorCategories.API,r}},{key:"addListener",value:function(t){"function"!=typeof t||this.listeners.includes(t)||this.listeners.push(t)}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)}},{key:"notifyListeners",value:function(t){this.listeners.forEach((function(e){try{e(t)}catch(t){console.error("Error in error listener:",t)}}))}},{key:"getLastError",value:function(){return this.lastError}},{key:"clearLastError",value:function(){this.lastError=null}}],e&&s(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return(e=m(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function p(){p=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var d={};function h(){}function v(){}function g(){}var y={};c(y,i,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(_([])));b&&b!==n&&r.call(b,i)&&(y=b);var w=g.prototype=h.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,a,s){var c=f(t[o],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==l(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(d).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=f(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(l(e)+" is not iterable")}return v.prototype=g,c(w,"constructor",g),c(g,"constructor",v),v.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),c(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),c(w,s,"Generator"),c(w,i,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),d}},e}function v(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function g(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){v(i,r,o,a,s,"next",t)}function s(t){v(i,r,o,a,s,"throw",t)}a(void 0)}))}}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,m(r.key),r)}}function m(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clientId=null},e=[{key:"initialize",value:(o=g(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{this.clientId=this.generateClientId()}catch(t){u.handleError(t)}case 1:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"generateClientId",value:function(){var t=localStorage.getItem("casl_client_id");if(t)return t;for(var e=[screen.width,screen.height,screen.colorDepth,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.language,navigator.platform].join("|"),n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;var o=Math.abs(n).toString(36);return localStorage.setItem("casl_client_id",o),o}},{key:"getAuthHeaders",value:(r=g(p().mark((function t(){var e,n=arguments;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:{},t.abrupt("return",d(d({},e),{},{"X-Client-ID":this.clientId||this.generateClientId()}));case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"isAuthenticated",value:(n=g(p().mark((function t(e){var n,r,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=i.getApiBaseUrl(),t.t0=fetch,t.t1="".concat(n,"/user-check"),t.t2=d,t.t3=d,t.t4={},t.next=9,this.getAuthHeaders();case 9:return t.t5=t.sent,t.t6=(0,t.t3)(t.t4,t.t5),t.t7={},t.t8={"Content-Type":"application/json"},t.t9=(0,t.t2)(t.t6,t.t7,t.t8),t.t10=JSON.stringify({email:e}),t.t11={method:"POST",headers:t.t9,credentials:"include",body:t.t10},t.next=18,(0,t.t0)(t.t1,t.t11);case 18:return r=t.sent,t.next=21,r.json();case 21:return o=t.sent,t.abrupt("return",!0===o.found);case 25:return t.prev=25,t.t12=t.catch(0),u.handleError(t.t12),t.abrupt("return",!1);case 29:case"end":return t.stop()}}),t,this,[[0,25]])}))),function(t){return n.apply(this,arguments)})},{key:"logout",value:function(){try{return localStorage.removeItem("casl_client_id"),sessionStorage.removeItem("casl_refresh_token"),sessionStorage.removeItem("casl_token_expiry"),!0}catch(t){return u.handleError(t),!1}}}],e&&y(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}())},752:(t,e,n)=>{var r=n(341),o=n(123),i=n(361),a=n(182);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return(e=v(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(){f=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(e,n,r,o){var i=n&&n.prototype instanceof p?n:p,a=Object.create(i.prototype);return u(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===h)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=d(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===h)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h={};function p(){}function v(){}function g(){}var y={};u(y,i,(function(){return this}));var m=Object.getPrototypeOf,b=m&&m(m(_([])));b&&b!==n&&r.call(b,i)&&(y=b);var w=g.prototype=p.prototype=Object.create(y);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,a,c){var u=d(t[o],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==s(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var o;u(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=d(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,h;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,h):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(s(e)+" is not iterable")}return v.prototype=g,u(w,"constructor",g),u(g,"constructor",v),v.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),u(w,c,"Generator"),u(w,i,(function(){return this})),u(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),h}},e}function d(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){d(i,r,o,a,s,"next",t)}function s(t){d(i,r,o,a,s,"throw",t)}a(void 0)}))}}function p(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,v(r.key),r)}}function v(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}var g=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.wixAppInstance=null,this.paymentInProgress=!1},e=[{key:"initWixPayment",value:function(){void 0!==window.wixSdk?(this.wixAppInstance=window.wixSdk,console.log("Wix SDK initialized for payments")):console.warn("Wix SDK not found - payment functionality may be limited")}},{key:"startPayment",value:(l=h(f().mark((function t(e,n){var r;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.paymentInProgress){t.next=2;break}throw new Error("A payment is already in progress");case 2:return this.paymentInProgress=!0,t.prev=3,this.wixAppInstance||this.initWixPayment(),t.next=7,this.createPaymentIntent(e,n);case 7:if(r=t.sent,!this.wixAppInstance){t.next=14;break}return t.next=11,this.processWixPayment(r,e);case 11:case 16:return t.abrupt("return",t.sent);case 14:return t.next=16,this.processFallbackPayment(r,e);case 17:t.next=23;break;case 19:throw t.prev=19,t.t0=t.catch(3),console.error("Payment processing error:",t.t0),t.t0;case 23:return t.prev=23,this.paymentInProgress=!1,t.finish(23);case 26:case"end":return t.stop()}}),t,this,[[3,19,23,26]])}))),function(t,e){return l.apply(this,arguments)})},{key:"createPaymentIntent",value:(c=h(f().mark((function t(e,n){var r,o,s;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=u({"Content-Type":"application/json"},i.D.getAuthHeaders()),t.next=4,fetch("".concat(a.JR,"/create-payment-intent"),{method:"POST",headers:r,body:JSON.stringify({packageId:e.id,userId:n,amount:e.price,currency:e.currency||"USD"})});case 4:if((o=t.sent).ok){t.next=10;break}return t.next=8,o.json();case 8:throw s=t.sent,new Error(s.message||"Failed to create payment intent");case 10:return t.next=12,o.json();case 12:return t.abrupt("return",t.sent);case 15:throw t.prev=15,t.t0=t.catch(0),console.error("Error creating payment intent:",t.t0),t.t0;case 19:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(t,e){return c.apply(this,arguments)})},{key:"processWixPayment",value:(s=h(f().mark((function t(e,n){var r=this;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,o){var i={id:e.id,amount:n.price,currency:n.currency||"USD",description:"CASL Key - ".concat(n.name),items:[{name:n.name,description:n.description,price:n.price,quantity:1}]};r.wixAppInstance.payments.startPayment(i).then((function(i){"paid"===i.status?r.verifyPayment(e.id,i.transactionId).then((function(e){t(u({success:!0,transactionId:i.transactionId,packageId:n.id,verificationCount:n.verificationCount},e))})).catch(o):o(new Error(i.error||"Payment failed"))})).catch((function(t){console.error("Wix payment error:",t),o(t)}))})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return s.apply(this,arguments)})},{key:"processFallbackPayment",value:(o=h(f().mark((function t(e,n){var r,o,s,c;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(a.JR,"/create-payment-url"),{method:"POST",headers:u({"Content-Type":"application/json"},i.D.getAuthHeaders()),body:JSON.stringify({intentId:e.id,packageId:n.id,returnUrl:window.location.href})});case 2:if((r=t.sent).ok){t.next=8;break}return t.next=6,r.json();case 6:throw o=t.sent,new Error(o.message||"Failed to create payment URL");case 8:return t.next=10,r.json();case 10:return s=t.sent,c=s.paymentUrl,sessionStorage.setItem("casl_payment_intent",e.id),sessionStorage.setItem("casl_package_id",n.id),window.location.href=c,t.abrupt("return",new Promise((function(){})));case 16:case"end":return t.stop()}}),t)}))),function(t,e){return o.apply(this,arguments)})},{key:"verifyPayment",value:(r=h(f().mark((function t(e,n){var r,o;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(a.JR,"/verify-payment"),{method:"POST",headers:u({"Content-Type":"application/json"},i.D.getAuthHeaders()),body:JSON.stringify({intentId:e,transactionId:n})});case 2:if((r=t.sent).ok){t.next=8;break}return t.next=6,r.json();case 6:throw o=t.sent,new Error(o.message||"Payment verification failed");case 8:return t.next=10,r.json();case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})},{key:"checkPendingPayment",value:(n=h(f().mark((function t(){var e,n,r,o,s,c,l;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=sessionStorage.getItem("casl_payment_intent"),n=sessionStorage.getItem("casl_package_id"),e&&n){t.next=4;break}return t.abrupt("return",null);case 4:return t.prev=4,sessionStorage.removeItem("casl_payment_intent"),sessionStorage.removeItem("casl_package_id"),t.next=9,fetch("".concat(a.JR,"/check-payment/").concat(e),{method:"GET",headers:u({"Content-Type":"application/json"},i.D.getAuthHeaders())});case 9:if((r=t.sent).ok){t.next=15;break}return t.next=13,r.json();case 13:throw o=t.sent,new Error(o.message||"Payment status check failed");case 15:return t.next=17,r.json();case 17:if("succeeded"!==(s=t.sent).status){t.next=29;break}return t.next=21,fetch("".concat(a.JR,"/packages/").concat(n),{method:"GET",headers:{"Content-Type":"application/json"}});case 21:if((c=t.sent).ok){t.next=24;break}throw new Error("Failed to load package data");case 24:return t.next=26,c.json();case 26:return l=t.sent,this.dispatchPaymentSuccess({id:n,verificationCount:l.verificationCount,expiryDate:s.expiryDate,transactionId:s.transactionId}),t.abrupt("return",{success:!0,packageId:n,verificationCount:l.verificationCount});case 29:return t.abrupt("return",{success:!1,error:s.error||"Payment not completed"});case 32:return t.prev=32,t.t0=t.catch(4),console.error("Error checking pending payment:",t.t0),t.abrupt("return",{success:!1,error:t.t0.message});case 36:case"end":return t.stop()}}),t,this,[[4,32]])}))),function(){return n.apply(this,arguments)})},{key:"dispatchPaymentSuccess",value:function(t){var e=new CustomEvent("casl-package-purchased",{detail:t,bubbles:!0,composed:!0});window.dispatchEvent(e)}}],e&&p(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,s,c,l}());function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(){m=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n,r){return Object.defineProperty(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(e,n,r,o){var i=n&&n.prototype instanceof d?n:d,a=Object.create(i.prototype);return c(a,"_invoke",function(e,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=E(s,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(e,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===f)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(e,r,new P(o||[])),!0),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var f={};function d(){}function h(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(_([])));b&&b!==n&&r.call(b,i)&&(v=b);var w=p.prototype=d.prototype=Object.create(v);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function n(o,i,a,s){var c=l(t[o],t,i);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==y(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}),!0)}function E(e,n){var r=n.method,o=e.i[r];if(o===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var i=l(o,e.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,f;var a=i.arg;return a?a.done?(n[e.r]=a.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,f):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,f)}function S(t){this.tryEntries.push(t)}function O(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function P(t){this.tryEntries=[[-1]],t.forEach(S,this),this.reset(!0)}function _(e){if(null!=e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(y(e)+" is not iterable")}return h.prototype=p,c(w,"constructor",p),c(p,"constructor",h),h.displayName=c(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,s,"GeneratorFunction")),t.prototype=Object.create(w),t},e.awrap=function(t){return{__await:t}},x(k.prototype),c(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(w),c(w,s,"Generator"),c(w,i,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0][4];if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){a.type="throw",a.arg=e,n.next=t}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=t,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===t||"continue"===t)&&o[0]<=e&&e<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o[2],f):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[2]===t)return this.complete(n[4],n[3]),O(n),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n[0]===t){var r=n[4];if("throw"===r.type){var o=r.arg;O(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),f}},e}function b(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}function w(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){b(i,r,o,a,s,"next",t)}function s(t){b(i,r,o,a,s,"throw",t)}a(void 0)}))}}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,k(r.key),r)}}function k(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}function E(t){var e="function"==typeof Map?new Map:void 0;return E=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(S())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&O(o,n.prototype),o}(t,arguments,P(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),O(n,t)},E(t)}function S(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(S=function(){return!!t})()}function O(t,e){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},O(t,e)}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var _=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(t=function(t,e,n){return e=P(e),function(t,e){if(e&&("object"==y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,S()?Reflect.construct(e,n||[],P(t).constructor):e.apply(t,n))}(this,e)).attachShadow({mode:"open"}),t.initializeState(),t.render(),t.setupEventListeners(),t.checkAuthentication(),t.checkPendingPayment(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}(e,t),n=e,a=[{key:"initializeState",value:function(){this.currentView="loading",this.error=null,this.user=null,this.selectedVerification=null}},{key:"connectedCallback",value:function(){console.log("CASL App component connected")}},{key:"checkAuthentication",value:(u=w(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,i.D.getCurrentUser();case 3:(e=t.sent).isAuthenticated?(this.user=e.user,this.currentView="dashboard"):this.currentView="auth",t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Authentication check error:",t.t0),this.error=t.t0.message,this.currentView="auth";case 12:this.render();case 13:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return u.apply(this,arguments)})},{key:"checkPendingPayment",value:(c=w(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.checkPendingPayment();case 3:(e=t.sent)&&e.success?this.showNotification("Payment successful! Your package has been activated."):e&&!e.success&&this.showNotification(e.error||"Payment was not completed","error"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error checking pending payment:",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return c.apply(this,arguments)})},{key:"render",value:function(){var t,e;switch(this.currentView){case"loading":e=this.renderLoading();break;case"auth":e=this.renderAuth();break;case"dashboard":e=this.renderDashboard();break;case"verification":e=this.renderVerification();break;case"verification-details":e=this.renderVerificationDetails();break;default:e=this.renderError("Invalid view")}this.shadowRoot.innerHTML="\n      <style>".concat((0,r.$)(),'</style>\n      <div class="app-container" dir="').concat((null===(t=o.A.getLanguageInfo(o.A.currentLanguage))||void 0===t?void 0:t.direction)||"ltr",'">\n        ').concat(this.renderHeader(),'\n        <div class="app-content">\n          ').concat(e,"\n        </div>\n        ").concat(this.renderFooter(),"\n      </div>\n    ")}},{key:"renderHeader",value:function(){return'\n      <header class="app-header">\n        <div class="branding">\n          <h1>CASL Key Verification</h1>\n        </div>\n        <div class="language-selector">\n          '.concat(o.A.renderLanguageSelector(),"\n        </div>\n      </header>\n    ")}},{key:"renderFooter",value:function(){return'\n      <footer class="app-footer">\n        <p>© '.concat((new Date).getFullYear()," CASL Key Verification. All rights reserved.</p>\n      </footer>\n    ")}},{key:"renderLoading",value:function(){return'\n      <div class="loading-container">\n        <div class="loading-spinner"></div>\n        <p>'.concat((0,o.t)("app.loading"),"</p>\n      </div>\n    ")}},{key:"renderAuth",value:function(){return"<casl-authentication></casl-authentication>"}},{key:"renderDashboard",value:function(){return"<casl-user-dashboard></casl-user-dashboard>"}},{key:"renderVerification",value:function(){return'\n      <div class="verification-container">\n        <casl-verification></casl-verification>\n      </div>\n    '}},{key:"renderVerificationDetails",value:function(){var t,e,n;if(!this.selectedVerification)return this.renderError("No verification selected");var r=new Date(this.selectedVerification.verificationDate),i=o.A.formatDate(r),a=(0,o.t)("trustLevel.".concat(this.selectedVerification.trustLevel))||this.selectedVerification.trustLevel;return'\n      <div class="verification-details">\n        <div class="back-button">\n          <button onclick="this.getRootNode().host.navigateTo(\'dashboard\')">\n            ← '.concat((0,o.t)("app.backToDashboard"),"\n          </button>\n        </div>\n        \n        <h2>").concat((0,o.t)("app.verificationDetails"),'</h2>\n        \n        <div class="details-card">\n          <div class="detail-header">\n            <h3>CASL Key ID: ').concat(this.selectedVerification.caslKeyId,'</h3>\n            <p class="verification-date">').concat(i,'</p>\n          </div>\n          \n          <div class="detail-body">\n            <div class="trust-level-section">\n              <h4>').concat((0,o.t)("app.trustLevel"),'</h4>\n              <div class="trust-badge">').concat(a,'</div>\n              <div class="score">\n                <span class="score-number">').concat(this.selectedVerification.score,'</span>\n                <span class="score-max">/100</span>\n              </div>\n            </div>\n            \n            <div class="verification-methods">\n              <h4>').concat((0,o.t)("app.verificationMethods"),"</h4>\n              <ul>\n                ").concat(this.selectedVerification.verification.verificationType?"<li>".concat((0,o.t)("app."+this.selectedVerification.verification.verificationType),"</li>"):"","\n                ").concat(this.selectedVerification.verification.backgroundCheckStatus?"<li>".concat((0,o.t)("app.backgroundCheck"),"</li>"):"","\n                ").concat(this.selectedVerification.verification.idVerificationStatus?"<li>".concat((0,o.t)("app.idVerification"),"</li>"):"","\n                ").concat(this.selectedVerification.verification.phoneVerificationStatus?"<li>".concat((0,o.t)("app.phoneVerification"),"</li>"):"","\n                ").concat(this.selectedVerification.verification.socialVerificationStatus?"<li>".concat((0,o.t)("app.socialVerification"),"</li>"):"",'\n              </ul>\n            </div>\n            \n            <div class="booking-details">\n              <h4>').concat((0,o.t)("app.bookingDetails"),"</h4>\n              <table>\n                <tr>\n                  <th>").concat((0,o.t)("app.platform"),"</th>\n                  <td>").concat((null===(t=this.selectedVerification.booking)||void 0===t?void 0:t.platform)||"-","</td>\n                </tr>\n                <tr>\n                  <th>").concat((0,o.t)("app.checkInDate"),"</th>\n                  <td>").concat(null!==(e=this.selectedVerification.booking)&&void 0!==e&&e.checkInDate?o.A.formatDate(new Date(this.selectedVerification.booking.checkInDate)):"-","</td>\n                </tr>\n                <tr>\n                  <th>").concat((0,o.t)("app.checkOutDate"),"</th>\n                  <td>").concat(null!==(n=this.selectedVerification.booking)&&void 0!==n&&n.checkOutDate?o.A.formatDate(new Date(this.selectedVerification.booking.checkOutDate)):"-",'</td>\n                </tr>\n              </table>\n            </div>\n            \n            <div class="score-factors">\n              <h4>').concat((0,o.t)("app.scoreFactors"),"</h4>\n              ").concat(this.selectedVerification.verification.adjustments&&this.selectedVerification.verification.adjustments.length>0?"\n                <ul>\n                  ".concat(this.selectedVerification.verification.adjustments.map((function(t){return'\n                    <li class="'.concat(t.points>0?"positive":"negative",'">\n                      ').concat(t.reason," (").concat(t.points>0?"+":"").concat(t.points,")\n                    </li>\n                  ")})).join(""),"\n                </ul>\n              "):"\n                <p>".concat((0,o.t)("app.noScoreFactors"),"</p>\n              "),'\n            </div>\n          </div>\n          \n          <div class="detail-actions">\n            <button \n              class="btn-primary" \n              onclick="this.getRootNode().host.printVerification(\'').concat(this.selectedVerification.caslKeyId,"')\"\n            >\n              ").concat((0,o.t)("app.printVerification"),"\n            </button>\n          </div>\n        </div>\n      </div>\n    ")}},{key:"renderError",value:function(t){return'\n      <div class="error-container">\n        <div class="alert alert-error" role="alert">\n          '.concat(t||this.error||(0,o.t)("app.genericError"),'\n        </div>\n        <button \n          class="btn-primary" \n          onclick="this.getRootNode().host.navigateTo(\'dashboard\')"\n        >\n          ').concat((0,o.t)("app.retry"),"\n        </button>\n      </div>\n    ")}},{key:"showNotification",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.createElement("div");n.className="notification notification-".concat(e),n.textContent=t;var r=document.createElement("button");r.className="notification-close",r.innerHTML="&times;",r.onclick=function(){return n.remove()},n.appendChild(r),this.shadowRoot.appendChild(n),setTimeout((function(){n.parentNode&&n.remove()}),5e3)}},{key:"navigateTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentView=t,"verification-details"===t&&e&&(this.selectedVerification=e.verification),this.render()}},{key:"printVerification",value:function(t){var e,n,r,i=window.open("","_blank");if(i){var a=this.selectedVerification,s=new Date(a.verificationDate),c=o.A.formatDate(s),u=(0,o.t)("trustLevel.".concat(a.trustLevel))||a.trustLevel;i.document.write("\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>CASL Key Verification - ".concat(a.caslKeyId,"</title>\n        <style>\n          body {\n            font-family: Arial, sans-serif;\n            margin: 2cm;\n            color: #333;\n            line-height: 1.5;\n          }\n          \n          h1, h2, h3, h4 {\n            color: #2c3e50;\n          }\n          \n          .header {\n            text-align: center;\n            margin-bottom: 2em;\n            border-bottom: 1px solid #eee;\n            padding-bottom: 1em;\n          }\n          \n          .logo {\n            font-size: 24px;\n            font-weight: bold;\n          }\n          \n          .verification-id {\n            font-size: 18px;\n            margin: 1em 0;\n          }\n          \n          .verification-date {\n            color: #7f8c8d;\n          }\n          \n          .trust-badge {\n            display: inline-block;\n            padding: 0.5em 1em;\n            border-radius: 4px;\n            color: white;\n            font-weight: bold;\n            margin: 1em 0;\n            background-color: ").concat("verified"===a.trustLevel?"#4CAF50":"review"===a.trustLevel?"#FFC107":"manual_review"===a.trustLevel?"#9E9E9E":"#757575",';\n          }\n          \n          .score {\n            font-size: 24px;\n            margin: 1em 0;\n          }\n          \n          .section {\n            margin: 1.5em 0;\n          }\n          \n          table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 1em 0;\n          }\n          \n          th, td {\n            padding: 0.5em;\n            text-align: left;\n            border-bottom: 1px solid #eee;\n          }\n          \n          th {\n            width: 30%;\n            font-weight: bold;\n          }\n          \n          .footer {\n            margin-top: 2em;\n            text-align: center;\n            font-size: 14px;\n            color: #7f8c8d;\n          }\n          \n          .verification-link {\n            margin-top: 1em;\n            font-size: 12px;\n          }\n          \n          @media print {\n            body {\n              font-size: 12pt;\n            }\n            \n            button {\n              display: none;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <div class="logo">CASL Key Verification</div>\n          <div class="verification-id">ID: ').concat(a.caslKeyId,'</div>\n          <div class="verification-date">Verified on ').concat(c,'</div>\n        </div>\n        \n        <div class="section">\n          <h2>Trust Level</h2>\n          <div class="trust-badge">').concat(u,'</div>\n          <div class="score">\n            <span class="score-number">').concat(a.score,'</span>\n            <span class="score-max">/100</span>\n          </div>\n        </div>\n        \n        <div class="section">\n          <h2>Verification Methods</h2>\n          <table>\n            <tr>\n              <th>Primary Method</th>\n              <td>').concat((0,o.t)("app."+(a.verification.verificationType||"notSpecified")),"</td>\n            </tr>\n            ").concat(a.verification.backgroundCheckStatus?"\n              <tr>\n                <th>Background Check</th>\n                <td>".concat((0,o.t)("app.completed"),"</td>\n              </tr>\n            "):"","\n            ").concat(a.verification.idVerificationStatus?"\n              <tr>\n                <th>ID Verification</th>\n                <td>".concat((0,o.t)("app.completed"),"</td>\n              </tr>\n            "):"","\n            ").concat(a.verification.phoneVerificationStatus?"\n              <tr>\n                <th>Phone Verification</th>\n                <td>".concat((0,o.t)("app.completed"),"</td>\n              </tr>\n            "):"","\n            ").concat(a.verification.socialVerificationStatus?"\n              <tr>\n                <th>Social Media Verification</th>\n                <td>".concat((0,o.t)("app.completed"),"</td>\n              </tr>\n            "):"",'\n          </table>\n        </div>\n        \n        <div class="section">\n          <h2>Booking Information</h2>\n          <table>\n            <tr>\n              <th>Platform</th>\n              <td>').concat((null===(e=a.booking)||void 0===e?void 0:e.platform)||"-","</td>\n            </tr>\n            <tr>\n              <th>Check-in Date</th>\n              <td>").concat(null!==(n=a.booking)&&void 0!==n&&n.checkInDate?o.A.formatDate(new Date(a.booking.checkInDate)):"-","</td>\n            </tr>\n            <tr>\n              <th>Check-out Date</th>\n              <td>").concat(null!==(r=a.booking)&&void 0!==r&&r.checkOutDate?o.A.formatDate(new Date(a.booking.checkOutDate)):"-",'</td>\n            </tr>\n          </table>\n        </div>\n        \n        <div class="footer">\n          <p>This verification certificate was generated by CASL Key Verification System.</p>\n          <p>© ').concat((new Date).getFullYear(),' CASL Key Verification</p>\n          <div class="verification-link">\n            Verify this certificate online at: https://casl-key.example.com/verify/').concat(a.caslKeyId,"\n          </div>\n        </div>\n        \n        <script>\n          // Auto-print\n          window.onload = function() {\n            window.print();\n          };\n        <\/script>\n      </body>\n      </html>\n    ")),i.document.close()}else this.showNotification("Please allow pop-ups to print verification","error")}},{key:"handleAuthEvent",value:function(t){var e=t.detail,n=e.type,r=e.data;switch(n){case"authenticated":this.user=r,this.navigateTo("dashboard");break;case"logged-out":this.user=null,this.navigateTo("auth");break;case"registration-pending":this.showNotification("Registration successful! Please check your email to confirm your account.")}}},{key:"handleDashboardEvent",value:function(t){var e=t.detail,n=e.type,r=e.data;switch(n){case"new-verification":this.navigateTo("verification");break;case"view-verification":this.navigateTo("verification-details",r);break;case"purchase-package":this.handlePackagePurchase(r);break;case"logout":this.user=null,this.navigateTo("auth")}}},{key:"handleVerificationEvent",value:function(t){var e=this,n=t.detail,r=n.caslKeyId;n.trustLevel,n.verificationData,this.showNotification("Verification complete! Your CASL Key ID is ".concat(r)),setTimeout((function(){e.navigateTo("dashboard")}),2e3)}},{key:"handlePackagePurchase",value:(s=w(m().mark((function t(e){var n;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.startPayment(e.package,e.userId);case 3:(n=t.sent)&&n.success&&(this.showNotification("Payment successful! Your package has been activated."),this.navigateTo("dashboard")),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Payment error:",t.t0),this.showNotification(t.t0.message||"Payment processing error","error");case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return s.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var t=this;this.addEventListener("casl-auth",this.handleAuthEvent.bind(this)),this.addEventListener("casl-dashboard",this.handleDashboardEvent.bind(this)),this.addEventListener("verificationComplete",this.handleVerificationEvent.bind(this)),document.addEventListener("caslLanguageChanged",(function(){t.render()}))}},{key:"handleLanguageChange",value:function(t){var e=this,n=t.target.value;n&&o.A.changeLanguage(n).then((function(){e.render()}))}}],a&&x(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a,s,c,u}(E(HTMLElement));customElements.define("casl-app",_)},987:(t,e,n)=>{n.a(t,(async(t,r)=>{try{n.r(e),n(752),n(188),n(46),n(361);var o=null;try{var i=(await n.e(463).then(n.bind(n,463))).accessibilityHelper;o=i}catch(t){console.log("AccessibilityHelper not found, continuing without it")}document.addEventListener("DOMContentLoaded",(function(){if(console.log("🚀 Initializing CASL Key Verification System..."),o)try{o.addSkipLink("main-content"),document.documentElement.lang=document.documentElement.lang||"en",window.matchMedia("(forced-colors: active)").matches&&document.body.classList.add("high-contrast-mode"),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&document.body.classList.add("reduced-motion"),window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",(function(t){t.matches?document.body.classList.add("reduced-motion"):document.body.classList.remove("reduced-motion")}))}catch(t){console.warn("Accessibility features failed to initialize:",t)}customElements.get("casl-app")||console.log("✅ CASL components registered"),console.log("✅ CASL Key Verification System initialized")})),window.addEventListener("error",(function(t){console.error("Global error:",t.error);var e=document.getElementById("error-message");e&&(e.textContent="An error occurred loading the application. Please refresh the page.",e.style.display="block")})),window.addEventListener("unhandledrejection",(function(t){console.error("Unhandled promise rejection:",t.reason),t.preventDefault()})),r()}catch(t){r(t)}}),1)}},s={};function c(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={exports:{}};return a[t](n,n.exports,c),n.exports}return c.m=a,t="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",e="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=t=>{t&&t.d<1&&(t.d=1,t.forEach((t=>t.r--)),t.forEach((t=>t.r--?t.r++:t())))},c.a=(o,i,a)=>{var s;a&&((s=[]).d=-1);var c,u,l,f=new Set,d=o.exports,h=new Promise(((t,e)=>{l=e,u=t}));h[e]=d,h[t]=t=>(s&&t(s),f.forEach(t),h.catch((t=>{}))),o.exports=h,i((o=>{var i;c=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[t])return o;if(o.then){var i=[];i.d=0,o.then((t=>{a[e]=t,r(i)}),(t=>{a[n]=t,r(i)}));var a={};return a[t]=t=>t(i),a}}var s={};return s[t]=t=>{},s[e]=o,s})))(o);var a=()=>c.map((t=>{if(t[n])throw t[n];return t[e]})),u=new Promise((e=>{(i=()=>e(a)).r=0;var n=t=>t!==s&&!f.has(t)&&(f.add(t),t&&!t.d&&(i.r++,t.push(i)));c.map((e=>e[t](n)))}));return i.r?u:a()}),(t=>(t?l(h[n]=t):u(d),r(s)))),s&&s.d<0&&(s.d=0)},c.d=(t,e)=>{for(var n in e)c.o(e,n)&&!c.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},c.f={},c.e=t=>Promise.all(Object.keys(c.f).reduce(((e,n)=>(c.f[n](t,e),e)),[])),c.u=t=>t+".casl-bundle.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),c.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o={},i="CASL:",c.l=(t,e,n,r)=>{if(o[t])o[t].push(e);else{var a,s;if(void 0!==n)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var f=u[l];if(f.getAttribute("src")==t||f.getAttribute("data-webpack")==i+n){a=f;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,c.nc&&a.setAttribute("nonce",c.nc),a.setAttribute("data-webpack",i+n),a.src=t),o[t]=[e];var d=(e,n)=>{a.onerror=a.onload=null,clearTimeout(h);var r=o[t];if(delete o[t],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(n))),e)return e(n)},h=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),s&&document.head.appendChild(a)}},c.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;c.g.importScripts&&(t=c.g.location+"");var e=c.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=t})(),(()=>{var t={792:0};c.f.j=(e,n)=>{var r=c.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=t[e]=[n,o]));n.push(r[2]=o);var i=c.p+c.u(e),a=new Error;c.l(i,(n=>{if(c.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,r[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var r,o,[i,a,s]=n,u=0;if(i.some((e=>0!==t[e]))){for(r in a)c.o(a,r)&&(c.m[r]=a[r]);s&&s(c)}for(e&&e(n);u<i.length;u++)o=i[u],c.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=this.webpackChunkCASL=this.webpackChunkCASL||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),c(987)})()));