/*! For license information please see casl-bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("CASL",[],t):"object"==typeof exports?exports.CASL=t():e.CASL=t()}(this,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t,r){return(t=function(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.r(t),e.d(t,{Authentication:()=>cn,CASLApp:()=>qn,CASLVerification:()=>qt,UserDashboard:()=>kn});var o="https://2mez9qoyt6.execute-api.us-east-2.amazonaws.com/prod",i="NOT_SUBMITTED",a="PROCESSING",s="VERIFIED",c="MANUAL_REVIEW",u="verified",l="review",d="manual_review",h="not_eligible",f=(r(r(r(r({},u,"85-100"),l,"70-84"),d,"50-69"),h,"Below 50"),r(r(r(r({},u,{badgeColor:"#4CAF50",icon:"‚úÖ",label:"Verified",description:"Verified guest. Meets CASL Key's recommended trust standards."}),l,{badgeColor:"#FFC107",icon:"‚ö†Ô∏è",label:"Additional Context Needed",description:"Some traits require review. We recommend reviewing booking context."}),d,{badgeColor:"#9E9E9E",icon:"üïµÔ∏è",label:"Manual Review Pending",description:"We're completing a review of this guest's profile. You'll be notified soon."}),h,{badgeColor:"#757575",icon:"üîí",label:"Not Eligible at This Time",description:"This guest does not currently meet platform-wide trust requirements."})),p=["User Identification","Booking Info","Stay Intent","Agreement"];function v(e,t){var n="";return e&&(n+='\n      <div \n        class="alert alert-info" \n        role="status" \n        aria-live="polite"\n      >\n        <span>Your previous form data has been restored.</span>\n        <button \n          onclick="this.getRootNode().host.clearSavedData()" \n          aria-label="Clear saved data"\n          class="alert-action"\n        >\n          Clear\n        </button>\n      </div>\n    '),t&&(n+='\n      <div \n        class="alert alert-error" \n        role="alert" \n        aria-live="assertive"\n      >\n        <span>'.concat(t,'</span>\n        <button \n          onclick="this.getRootNode().host.clearApiError()" \n          aria-label="Dismiss error message"\n          class="alert-action"\n        >\n          <span aria-hidden="true">√ó</span>\n          <span class="sr-only">Dismiss</span>\n        </button>\n      </div>\n    ')),n}function g(e){return'\n    <span class="tooltip" tabindex="0">\n      <span class="tooltip-icon" aria-hidden="true">?</span>\n      <span class="tooltip-text" role="tooltip">'.concat(e,'</span>\n      <span class="sr-only">').concat(e,"</span>\n    </span>\n  ")}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function S(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}var E=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._state={auth:{isAuthenticated:!1,user:null,loading:!1,error:null},verification:{caslKeyId:null,isExistingUser:!1,isVerified:!1,verificationType:null,loading:!1,error:null,platformData:null,idVerificationData:null,backgroundCheckStatus:null},formData:{currentStep:0,userData:{},bookingInfo:{},stayIntent:{},agreement:{},isValid:!1,isDirty:!1,lastSaved:null},ui:{theme:"light",language:"en",notifications:[],modal:null,alert:null,loading:!1},results:{score:0,trustLevel:"",message:"",adjustments:[],isSubmitted:!1,hostSummary:null}},this._subscribers={auth:new Set,verification:new Set,formData:new Set,ui:new Set,results:new Set,all:new Set}},t=[{key:"getState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this._state[e]?w({},this._state[e]):null:w({},this._state)}},{key:"updateState",value:function(e,t){if(this._state[e]){var n,r=w({},this._state[e]);n="function"==typeof t?t(r):w(w({},r),t),JSON.stringify(r)!==JSON.stringify(n)&&(this._state[e]=n,this._notifySubscribers(e))}else console.warn('StateManager: Unknown section "'.concat(e,'"'))}},{key:"_notifySubscribers",value:function(e){var t=this,n=w({},this._state[e]);this._subscribers[e]&&this._subscribers[e].forEach((function(t){try{t(n)}catch(t){console.error("Error in state subscriber for ".concat(e,":"),t)}})),this._subscribers.all.forEach((function(e){try{e(w({},t._state))}catch(e){console.error("Error in global state subscriber:",e)}})),this._persistState(e)}},{key:"_persistState",value:function(e){if(["formData","ui"].includes(e))try{localStorage.setItem("casl_state_".concat(e),JSON.stringify(this._state[e]))}catch(t){console.warn("Failed to persist state section ".concat(e,":"),t)}}},{key:"loadPersistedState",value:function(){var e=this;["formData","ui"].forEach((function(t){try{var n=localStorage.getItem("casl_state_".concat(t));if(n){var r=JSON.parse(n);e._state[t]=w(w({},e._state[t]),r)}}catch(e){console.warn("Failed to load persisted state for ".concat(t,":"),e)}}))}},{key:"subscribe",value:function(e,t){var n=this;return this._subscribers[e]?"function"!=typeof t?(console.warn("StateManager: Subscriber callback is not a function"),function(){}):(this._subscribers[e].add(t),t(w({},"all"===e?this._state:this._state[e])),function(){n._subscribers[e].delete(t)}):(console.warn('StateManager: Unknown section "'.concat(e,'"')),function(){})}},{key:"resetSection",value:function(e){if(this._state[e]){var t=this._getInitialState()[e];this._state[e]=w({},t),this._notifySubscribers(e);try{localStorage.removeItem("casl_state_".concat(e))}catch(t){console.warn("Failed to remove persisted state for ".concat(e,":"),t)}}else console.warn('StateManager: Unknown section "'.concat(e,'"'))}},{key:"resetAll",value:function(){var e=this;this._state=this._getInitialState(),Object.keys(this._subscribers).forEach((function(t){"all"!==t&&e._notifySubscribers(t)}));try{localStorage.removeItem("casl_state_formData"),localStorage.removeItem("casl_state_ui")}catch(e){console.warn("Failed to clear persisted state:",e)}}},{key:"_getInitialState",value:function(){return{auth:{isAuthenticated:!1,user:null,loading:!1,error:null},verification:{caslKeyId:null,isExistingUser:!1,isVerified:!1,verificationType:null,loading:!1,error:null,platformData:null,idVerificationData:null,backgroundCheckStatus:null},formData:{currentStep:0,userData:{},bookingInfo:{},stayIntent:{},agreement:{},isValid:!1,isDirty:!1,lastSaved:null},ui:{theme:"light",language:"en",notifications:[],modal:null,alert:null,loading:!1},results:{score:0,trustLevel:"",message:"",adjustments:[],isSubmitted:!1,hostSummary:null}}}},{key:"setAuth",value:function(e){this.updateState("auth",e)}},{key:"setVerification",value:function(e){this.updateState("verification",e)}},{key:"updateFormData",value:function(e){this.updateState("formData",(function(t){var n=w(w({},t),e);return n.isDirty=!0,n.lastSaved=(new Date).toISOString(),n}))}},{key:"addNotification",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,o={id:Date.now().toString(),message:e,type:n,timestamp:(new Date).toISOString(),timeout:r};return this.updateState("ui",(function(e){return w(w({},e),{},{notifications:[].concat((t=e.notifications,function(e){if(Array.isArray(e))return y(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[o])});var t})),r>0&&setTimeout((function(){t.removeNotification(o.id)}),r),o.id}},{key:"removeNotification",value:function(e){this.updateState("ui",(function(t){return w(w({},t),{},{notifications:t.notifications.filter((function(t){return t.id!==e}))})}))}},{key:"showModal",value:function(e){this.updateState("ui",{modal:e})}},{key:"hideModal",value:function(){this.updateState("ui",{modal:null})}},{key:"showAlert",value:function(e){this.updateState("ui",{alert:e})}},{key:"hideAlert",value:function(){this.updateState("ui",{alert:null})}},{key:"setLoading",value:function(e){this.updateState("ui",{loading:e})}},{key:"setResults",value:function(e){this.updateState("results",e)}},{key:"getDebugInfo",value:function(){return{stateSize:JSON.stringify(this._state).length,subscribers:{auth:this._subscribers.auth.size,verification:this._subscribers.verification.size,formData:this._subscribers.formData.size,ui:this._subscribers.ui.size,results:this._subscribers.results.size,all:this._subscribers.all.size},persistedSections:{formData:!!localStorage.getItem("casl_state_formData"),ui:!!localStorage.getItem("casl_state_ui")}}}}],t&&k(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),I=new E;function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,O(r.key),r)}}function O(e){var t=function(e){if("object"!=_(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_(t)?t:t+""}I.loadPersistedState();var T=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handlers=new Map,this.listeners=new Map,this.componentCounter=0},t=[{key:"generateComponentId",value:function(){return"component_".concat(Date.now(),"_").concat(this.componentCounter++)}},{key:"initComponent",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||this.generateComponentId();return e.setAttribute("data-component-id",t),this.handlers.has(t)||this.handlers.set(t,new Map),e.shadowRoot&&this.setupEventDelegation(e,t),t}},{key:"setupEventDelegation",value:function(e,t){var n=this,r=e.shadowRoot,o=[];["click","change","input","submit","focus","blur","dragstart","dragover","dragleave","drop"].forEach((function(e){var i=function(o){for(var i=o.target;i&&i!==r;){var a=i.getAttribute("data-event-".concat(e));if(a){var s=n.handlers.get(t);s&&s.has(a)&&s.get(a)(o,i);break}i=i.parentNode}};r.addEventListener(e,i),o.push({eventType:e,listener:i})})),this.listeners.set(t,o)}},{key:"registerHandler",value:function(e,t,n){this.handlers.has(e)||this.handlers.set(e,new Map),this.handlers.get(e).set(t,n)}},{key:"unregisterHandler",value:function(e,t){if(this.handlers.has(e)){var n=this.handlers.get(e);n.has(t)&&n.delete(t)}}},{key:"cleanupComponent",value:function(e){if(this.handlers.has(e)&&this.handlers.delete(e),this.listeners.has(e)){var t=this.listeners.get(e),n=document.querySelector('[data-component-id="'.concat(e,'"]'));n&&n.shadowRoot&&t.forEach((function(e){var t=e.eventType,r=e.listener;n.shadowRoot.removeEventListener(t,r)})),this.listeners.delete(e)}}},{key:"replaceInlineHandlers",value:function(e){return(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/onclick="([^"]+)"/g,'data-event-click="$1"')).replace(/onchange="([^"]+)"/g,'data-event-change="$1"')).replace(/oninput="([^"]+)"/g,'data-event-input="$1"')).replace(/onsubmit="([^"]+)"/g,'data-event-submit="$1"')).replace(/onfocus="([^"]+)"/g,'data-event-focus="$1"')).replace(/onblur="([^"]+)"/g,'data-event-blur="$1"')).replace(/ondragstart="([^"]+)"/g,'data-event-dragstart="$1"')).replace(/ondragover="([^"]+)"/g,'data-event-dragover="$1"')).replace(/ondragleave="([^"]+)"/g,'data-event-dragleave="$1"')).replace(/ondrop="([^"]+)"/g,'data-event-drop="$1"')}},{key:"createSecureRender",value:function(e,t){var n=this;return function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];var a=e.apply(t,o);return n.replaceInlineHandlers(a)}}}],t&&P(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}());function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,C(r.key),r)}}function C(e){var t=function(e){if("object"!=j(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}var D=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners=[],this.lastError=null,this.errorCategories={NETWORK:"network",AUTH:"authentication",VALIDATION:"validation",API:"api",PAYMENT:"payment",UNKNOWN:"unknown"},this.handleGlobalErrors()},t=[{key:"handleGlobalErrors",value:function(){var e=this;window.addEventListener("unhandledrejection",(function(t){e.handleError(t.reason||new Error("Unhandled Promise rejection"))})),window.addEventListener("error",(function(t){e.handleError(t.error||new Error(t.message))}))}},{key:"categorizeError",value:function(e){return e?"NetworkError"===e.name||e.message.includes("network")||e.message.includes("failed to fetch")||e.message.includes("timeout")?this.errorCategories.NETWORK:"AuthError"===e.name||e.message.includes("unauthorized")||e.message.includes("forbidden")||e.message.includes("token")||401===e.status||403===e.status?this.errorCategories.AUTH:"ValidationError"===e.name||e.message.includes("validation")||e.message.includes("invalid")||e.message.includes("required")?this.errorCategories.VALIDATION:"ApiError"===e.name||e.status>=400||e.message.includes("api")||e.message.includes("endpoint")?this.errorCategories.API:"PaymentError"===e.name||e.message.includes("payment")||e.message.includes("transaction")||e.message.includes("purchase")?this.errorCategories.PAYMENT:this.errorCategories.UNKNOWN:this.errorCategories.UNKNOWN}},{key:"processError",value:function(e){"string"==typeof e&&(e=new Error(e)),e instanceof Error||(e=new Error("Unknown error"));var t=this.categorizeError(e),n=(new Date).toISOString();return{id:"err_".concat(n.replace(/[-:.TZ]/g,""),"_").concat(Math.random().toString(36).substr(2,5)),message:e.message,category:t,timestamp:n,name:e.name,stack:e.stack,status:e.status||null,code:e.code||null,data:e.data||null,handled:!1}}},{key:"logError",value:function(e){console.error("[".concat(e.category.toUpperCase(),"] ").concat(e.id,": ").concat(e.message),e)}},{key:"handleError",value:function(e){var t=this.processError(e);return this.logError(t),this.lastError=t,this.notifyListeners(t),t.handled=!0,t}},{key:"getUserFriendlyMessage",value:function(e){switch(e.category){case this.errorCategories.NETWORK:return"Network error. Please check your internet connection and try again.";case this.errorCategories.AUTH:return"Authentication error. Please log in again.";case this.errorCategories.VALIDATION:return e.message||"Please check your input and try again.";case this.errorCategories.API:return"Server error. Please try again later.";case this.errorCategories.PAYMENT:return"Payment processing error. Please try again or use a different payment method.";case this.errorCategories.UNKNOWN:default:return"An unexpected error occurred. Please try again."}}},{key:"createValidationError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Error(e);return n.name="ValidationError",n.fieldErrors=t,n.category=this.errorCategories.VALIDATION,n}},{key:"createAuthError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:401,n=new Error(e);return n.name="AuthError",n.status=t,n.category=this.errorCategories.AUTH,n}},{key:"createApiError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=new Error(e);return r.name="ApiError",r.status=t,r.data=n,r.category=this.errorCategories.API,r}},{key:"addListener",value:function(e){"function"!=typeof e||this.listeners.includes(e)||this.listeners.push(e)}},{key:"removeListener",value:function(e){var t=this.listeners.indexOf(e);-1!==t&&this.listeners.splice(t,1)}},{key:"notifyListeners",value:function(e){this.listeners.forEach((function(t){try{t(e)}catch(e){console.error("Error in error listener:",e)}}))}},{key:"getLastError",value:function(){return this.lastError}},{key:"clearLastError",value:function(){this.lastError=null}}],t&&A(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}());function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e,t,n){return(t=V(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,V(r.key),r)}}function V(e){var t=function(e){if("object"!=N(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==N(t)?t:t+""}var U=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaults={API_BASE_URL:"https://2mez9qoyt6.execute-api.us-east-2.amazonaws.com/prod",DEBUG_MODE:!1,LOG_LEVEL:"error",AUTH_COOKIE_NAME:"casl_auth_token",AUTH_COOKIE_DOMAIN:window.location.hostname,AUTH_COOKIE_SECURE:"https:"===window.location.protocol,AUTH_COOKIE_MAX_AGE:604800,REFRESH_TOKEN_COOKIE_NAME:"casl_refresh_token",USER_DATA_KEY:"casl_user_data",STORAGE_PREFIX:"casl_",LOCALIZATION_KEY:"casl_language",DEFAULT_LANGUAGE:"en",FORM_AUTO_SAVE:!0,ENABLE_ANALYTICS:!1,VERIFICATION_EXPIRY_DAYS:365,VERIFICATION_MIN_SCORE:50,MAX_SCREENSHOT_SIZE:5242880,VERIFICATION_METHODS:["screenshot","government-id","phone","social","background-check"],ALLOWED_IMAGE_TYPES:["image/jpeg","image/png","image/webp"],VERIFICATION_POLL_INTERVAL:3e3,COGNITO_REGION:"us-east-2",COGNITO_USER_POOL_ID:"us-east-2_wxVzxzC7V",COGNITO_CLIENT_ID:"6eihn0891v31dsovg33g2e1h90",REQUIRE_SECURE_CONTEXT:!0},this.config={},this.init()},t=[{key:"init",value:function(){this.loadFromGlobalConfig(),this.loadFromMetaTags(),this.loadFromLocalStorage(),this.mergeDefaults(),this.validateSecureContext()}},{key:"loadFromGlobalConfig",value:function(){var e=this;try{if("undefined"!=typeof window&&window.CASL_CONFIG){var t=this.flattenConfig(window.CASL_CONFIG);Object.keys(t).forEach((function(n){e.config[n]=t[n]}))}}catch(e){console.warn("Could not load config from global config object:",e)}}},{key:"flattenConfig",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).reduce((function(r,o){var i=n.length?"".concat(n,"_"):"";return"object"!==N(e[o])||null===e[o]||Array.isArray(e[o])?r["".concat(i).concat(o).toUpperCase()]=e[o]:Object.assign(r,t.flattenConfig(e[o],"".concat(i).concat(o))),r}),{})}},{key:"loadFromMetaTags",value:function(){var e=this;try{document.querySelectorAll('meta[name^="casl-config-"]').forEach((function(t){var n=t.getAttribute("name").replace("casl-config-","").toUpperCase(),r=t.getAttribute("content");e.config[n]=e.parseValue(r)}))}catch(e){console.warn("Could not load config from meta tags:",e)}}},{key:"loadFromLocalStorage",value:function(){var e=this;try{var t=localStorage.getItem("casl_config");if(t){var n=JSON.parse(t);Object.keys(n).forEach((function(t){e.config[t]=n[t]}))}}catch(e){console.warn("Could not load config from local storage:",e)}}},{key:"mergeDefaults",value:function(){var e=this;Object.keys(this.defaults).forEach((function(t){void 0===e.config[t]&&(e.config[t]=e.defaults[t])})),this.transformConfig()}},{key:"transformConfig",value:function(){var e=this;["DEBUG_MODE","AUTH_COOKIE_SECURE","FORM_AUTO_SAVE","ENABLE_ANALYTICS","REQUIRE_SECURE_CONTEXT"].forEach((function(t){"string"==typeof e.config[t]&&(e.config[t]=e.parseBoolean(e.config[t]))})),["AUTH_COOKIE_MAX_AGE","VERIFICATION_EXPIRY_DAYS","VERIFICATION_MIN_SCORE","MAX_SCREENSHOT_SIZE","VERIFICATION_POLL_INTERVAL"].forEach((function(t){"string"==typeof e.config[t]&&(e.config[t]=parseInt(e.config[t],10))})),["VERIFICATION_METHODS","ALLOWED_IMAGE_TYPES"].forEach((function(t){"string"==typeof e.config[t]&&(e.config[t]=e.config[t].split(",").map((function(e){return e.trim()})))}))}},{key:"parseValue",value:function(e){try{return JSON.parse(e)}catch(t){return e}}},{key:"parseBoolean",value:function(e){return"true"===e.toLowerCase()||"1"===e||"yes"===e||"y"===e}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0!==this.config[e]?this.config[e]:t}},{key:"getApiBaseUrl",value:function(){var e;return"undefined"!=typeof window&&null!==(e=window.CASL_CONFIG)&&void 0!==e&&null!==(e=e.api)&&void 0!==e&&e.baseUrl?window.CASL_CONFIG.api.baseUrl:this.get("API_BASE_URL")}},{key:"isDebugMode",value:function(){return this.get("DEBUG_MODE",!1)}},{key:"getAuthCookieConfig",value:function(){return{name:this.get("AUTH_COOKIE_NAME"),domain:this.get("AUTH_COOKIE_DOMAIN"),secure:this.get("AUTH_COOKIE_SECURE"),maxAge:this.get("AUTH_COOKIE_MAX_AGE"),sameSite:"strict",path:"/"}}},{key:"getRefreshTokenCookieConfig",value:function(){return{name:this.get("REFRESH_TOKEN_COOKIE_NAME"),domain:this.get("AUTH_COOKIE_DOMAIN"),secure:this.get("AUTH_COOKIE_SECURE"),maxAge:2*this.get("AUTH_COOKIE_MAX_AGE"),sameSite:"strict",path:"/"}}},{key:"getVerificationMethods",value:function(){return this.get("VERIFICATION_METHODS",[])}},{key:"getAllowedImageTypes",value:function(){return this.get("ALLOWED_IMAGE_TYPES",[])}},{key:"validateSecureContext",value:function(){this.get("REQUIRE_SECURE_CONTEXT")&&"undefined"!=typeof window&&(window.isSecureContext||console.warn("Application requires a secure context (HTTPS) but is running in an insecure context."))}},{key:"set",value:function(e,t){this.config[e]=t,this.saveToLocalStorage()}},{key:"saveToLocalStorage",value:function(){var e=this;try{var t={},n=["API_KEY","AWS_ACCESS_KEY","AWS_SECRET_KEY","STRIPE_KEY"];Object.keys(this.config).forEach((function(r){n.includes(r)||(t[r]=e.config[r])})),localStorage.setItem("casl_config",JSON.stringify(t))}catch(e){console.warn("Could not save config to local storage:",e)}}},{key:"reset",value:function(){this.config=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){R(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.defaults),this.saveToLocalStorage()}}],t&&F(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),M=new U;function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H(r.key),r)}}function H(e){var t=function(e){if("object"!=G(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==G(t)?t:t+""}var K=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ariaRoleDescriptions={form:"form",button:"button",link:"link",checkbox:"checkbox",radio:"radio",tab:"tab",tabpanel:"tabpanel",textbox:"textbox",combobox:"combobox",alert:"alert",alertdialog:"alertdialog",dialog:"dialog",progressbar:"progressbar",status:"status",tooltip:"tooltip",navigation:"navigation",main:"main",region:"region"},this.liveRegions={polite:{"aria-live":"polite","aria-atomic":"true"},assertive:{"aria-live":"assertive","aria-atomic":"true"}},this.focusTrapElements=new Set,this.initKeyboardNavigation()},t=[{key:"initKeyboardNavigation",value:function(){var e=this;document.addEventListener("keydown",(function(t){if("Tab"===t.key&&document.body.classList.add("keyboard-navigation"),"Tab"===t.key&&e.focusTrapElements.size>0&&e.manageFocusTrap(t),"Escape"===t.key&&e.focusTrapElements.size>0){var n=Array.from(e.focusTrapElements).pop();n&&"function"==typeof n.onEscape&&n.onEscape(t)}})),document.addEventListener("mousedown",(function(){document.body.classList.remove("keyboard-navigation")})),this.addFocusStyles()}},{key:"addFocusStyles",value:function(){if(!document.getElementById("a11y-focus-styles")){var e=document.createElement("style");e.id="a11y-focus-styles",e.textContent='\n      /* Base focus styles for all browsers */\n      :focus {\n        outline: 2px solid transparent;\n        outline-offset: 2px;\n      }\n      \n      /* Enhanced focus styles for keyboard navigation */\n      .keyboard-navigation *:focus-visible,\n      .keyboard-navigation *:focus {\n        outline: 3px solid #4285F4 !important;\n        outline-offset: 3px !important;\n        border-radius: 3px;\n        box-shadow: 0 0 0 2px white;\n      }\n      \n      /* High contrast mode focus styles */\n      @media (forced-colors: active) {\n        .keyboard-navigation *:focus-visible,\n        .keyboard-navigation *:focus {\n          outline: 3px solid CanvasText !important; \n          outline-offset: 3px !important;\n        }\n      }\n      \n      /* Focus styles for form elements */\n      .keyboard-navigation button:focus,\n      .keyboard-navigation [role="button"]:focus,\n      .keyboard-navigation a:focus,\n      .keyboard-navigation input:focus,\n      .keyboard-navigation select:focus,\n      .keyboard-navigation textarea:focus {\n        border-color: #4285F4 !important;\n        box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.4) !important;\n      }\n      \n      /* Enhanced focus styles for checkboxes and radios */\n      .keyboard-navigation .checkbox-container input:focus + label,\n      .keyboard-navigation input[type="checkbox"]:focus + label,\n      .keyboard-navigation input[type="radio"]:focus + label {\n        outline: 2px solid #4285F4 !important;\n        outline-offset: 2px;\n        border-radius: 2px;\n      }\n      \n      /* Skip link styles */\n      .skip-to-content {\n        position: absolute;\n        top: -5rem;\n        left: 0;\n        padding: 1rem;\n        background: #4285F4;\n        color: white;\n        z-index: 100;\n        opacity: 0;\n        text-decoration: none;\n        font-weight: bold;\n        transition: top 0.2s;\n      }\n      \n      .skip-to-content:focus {\n        top: 0;\n        opacity: 1;\n      }\n      \n      @media (prefers-reduced-motion: reduce) {\n        .skip-to-content {\n          transition: none;\n        }\n        \n        /* Remove all animations and transitions */\n        *, *::before, *::after {\n          animation-duration: 0.001ms !important;\n          animation-iteration-count: 1 !important;\n          transition-duration: 0.001ms !important;\n          scroll-behavior: auto !important;\n        }\n      }\n    ',document.head.appendChild(e)}}},{key:"enhanceHtml",value:function(e){return e=this.enhanceFormElements(e),e=this.enhanceRoles(e),e=this.enhanceLabels(e),this.enhanceAutocomplete(e)}},{key:"enhanceFormElements",value:function(e){return e=(e=(e=e.replace(/<input([^>]*) required([^>]*)>/g,'<input$1 required$2 aria-required="true">')).replace(/<input([^>]*) class="([^"]*error[^"]*)"([^>]*)>/g,'<input$1 class="$2"$3 aria-invalid="true">')).replace(/aria-describedby="([^"]+)"/g,(function(t,n){return e.includes('id="'.concat(n,'"'))?t:""}))}},{key:"enhanceRoles",value:function(e){return(e=e.replace(/<div([^>]*) class="([^"]*error[^"]*)"([^>]*)>/g,'<div$1 class="$2"$3 role="alert">')).replace(/<div([^>]*) class="([^"]*success[^"]*)"([^>]*)>/g,'<div$1 class="$2"$3 role="status">')}},{key:"enhanceLabels",value:function(e){return e.replace(/<button([^>]*)>\s*<\/button>/g,(function(e,t){return t.includes("aria-label")?e:"<button".concat(t,' aria-label="Button"></button>')}))}},{key:"enhanceAutocomplete",value:function(e){return[{selector:'name="name"',value:"name"},{selector:'name="email"',value:"email"},{selector:'name="phone"',value:"tel"},{selector:'name="address"',value:"street-address"},{selector:'name="zipCode"',value:"postal-code"}].forEach((function(t){var n=new RegExp("<input([^>]*) ".concat(t.selector,"([^>]*)>"),"g");e=e.replace(n,(function(e,n,r){return e.includes("autocomplete=")?e:"<input".concat(n," ").concat(t.selector).concat(r,' autocomplete="').concat(t.value,'">')}))})),e}},{key:"checkColorContrast",value:function(e,t){var n=function(e){var t,n,r;if(e.startsWith("#")){var o=e.replace("#",""),i=o.length;if(3===i)t=parseInt(o[0]+o[0],16)/255,n=parseInt(o[1]+o[1],16)/255,r=parseInt(o[2]+o[2],16)/255;else{if(6!==i)return null;t=parseInt(o.substring(0,2),16)/255,n=parseInt(o.substring(2,4),16)/255,r=parseInt(o.substring(4,6),16)/255}}else{if(!e.startsWith("rgb"))return null;var a=e.match(/\d+/g);if(!a||a.length<3)return null;var s=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return z(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(a.map((function(e){return parseInt(e,10)/255})).slice(0,3),3);t=s[0],n=s[1],r=s[2]}var c=function(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)};return.2126*(t=c(t))+.7152*(n=c(n))+.0722*c(r)},r=n(e),o=n(t);if(null===r||null===o)return null;var i=(Math.max(r,o)+.05)/(Math.min(r,o)+.05);return{ratio:i,isLargeText:!1,meetsAA:i>=4.5,meetsAALarge:i>=3,meetsAAA:i>=7,meetsAAALarge:i>=4.5}}},{key:"createFocusTrap",value:function(e,t){var n=this,r=this.getFocusableElements(e);if(0===r.length)return console.warn("No focusable elements found for focus trap"),null;var o=document.activeElement;r[0].focus();var i={element:e,focusableElements:r,previouslyFocused:o,onEscape:t,release:function(){n.focusTrapElements.delete(i),o&&o.focus&&o.focus()}};return this.focusTrapElements.add(i),i}},{key:"manageFocusTrap",value:function(e){var t=Array.from(this.focusTrapElements).pop();if(t){var n=t.element,r=t.focusableElements;if(n.contains(e.target)){var o=r[0],i=r[r.length-1];e.shiftKey&&document.activeElement===o?(e.preventDefault(),i.focus()):e.shiftKey||document.activeElement!==i||(e.preventDefault(),o.focus())}}}},{key:"getFocusableElements",value:function(e){var t=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(",");return e.shadowRoot?Array.from(e.shadowRoot.querySelectorAll(t)):Array.from(e.querySelectorAll(t))}},{key:"createLiveRegion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"polite",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=document.createElement("div");return n.id=t||"live-region-".concat(Date.now()),n.setAttribute("aria-live",e),n.setAttribute("aria-atomic","true"),n.setAttribute("aria-relevant","additions text"),n.style.position="absolute",n.style.width="1px",n.style.height="1px",n.style.margin="-1px",n.style.padding="0",n.style.overflow="hidden",n.style.clip="rect(0, 0, 0, 0)",n.style.whiteSpace="nowrap",n.style.border="0",n}},{key:"announce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"polite",n=document.getElementById("a11y-live-".concat(t));n||(n=this.createLiveRegion(t,"a11y-live-".concat(t)),document.body.appendChild(n)),n.textContent="",setTimeout((function(){n.textContent=e}),50)}},{key:"addSkipLink",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main-content",t=document.querySelector(".skip-to-content");if(t)return t;(t=document.createElement("a")).href="#".concat(e),t.className="skip-to-content",t.textContent="Skip to main content",document.body.insertBefore(t,document.body.firstChild);var n=document.getElementById(e);return n?n.getAttribute("tabindex")||n.setAttribute("tabindex","-1"):console.warn("Skip link target #".concat(e," not found")),t}},{key:"checkAccessibility",value:function(e){var t=this,n=[];e.querySelectorAll("input, select, textarea").forEach((function(t){var r=t.id;r?e.querySelector('label[for="'.concat(r,'"]'))||t.hasAttribute("aria-label")||t.hasAttribute("aria-labelledby")||n.push({element:t,issue:"Form control missing associated label"}):n.push({element:t,issue:"Form control missing ID attribute"});var o=t.getAttribute("name");"text"!==t.type&&"email"!==t.type&&"tel"!==t.type||!t.hasAttribute("autocomplete")&&o&&n.push({element:t,issue:'Input field "'.concat(o,'" missing autocomplete attribute')})})),e.querySelectorAll("img").forEach((function(e){e.hasAttribute("alt")||n.push({element:e,issue:"Image missing alt attribute"})})),e.querySelectorAll('button, [role="button"]').forEach((function(e){e.textContent.trim()||e.hasAttribute("aria-label")||e.hasAttribute("aria-labelledby")||n.push({element:e,issue:"Button missing accessible name"})})),e.querySelectorAll("*:not(img):not(svg):not(canvas)").forEach((function(e){var r=window.getComputedStyle(e),o=r.color,i=r.backgroundColor;if(i&&"rgba(0, 0, 0, 0)"!==i&&"transparent"!==i){var a=t.checkColorContrast(o,i);a&&!a.meetsAA&&n.push({element:e,issue:"Insufficient color contrast ratio (".concat(a.ratio.toFixed(2),":1)")})}}));var r=Array.from(e.querySelectorAll("h1, h2, h3, h4, h5, h6")),o=0;return r.forEach((function(e,t){var r=parseInt(e.tagName.substring(1),10);t>0&&r>o+1&&n.push({element:e,issue:"Heading level skipped from h".concat(o," to h").concat(r)}),o=r})),{element:e,issues:n,hasIssues:n.length>0}}}],t&&q(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}(),B=new K;function Y(e){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(e)}function W(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||J(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){if(e){if("string"==typeof e)return X(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?X(e,t):void 0}}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function $(){$=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Y(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Y(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Z(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){te(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function te(e,t,n){return(t=re(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,re(r.key),r)}}function re(e){var t=function(e){if("object"!=Y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Y(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Y(t)?t:t+""}var oe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.forms=new Map,this.formCounter=0},t=[{key:"initForm",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o="form_".concat(Date.now(),"_").concat(this.formCounter++),i={id:o,formId:t,componentId:e.getAttribute("data-component-id")||T.initComponent(e),component:e,state:ee({},n),originalState:ee({},n),handlers:ee({},r),errors:{},touched:{},isDirty:!1,isSubmitting:!1,isValid:!0};return this.forms.set(o,i),this.registerFormHandlers(i),M.get("FORM_AUTO_SAVE",!0)&&this.setupAutoSave(i),i}},{key:"registerFormHandlers",value:function(e){var t=this,n=e.componentId,r=e.handlers;r.onSubmit&&T.registerHandler(n,"submit_".concat(e.formId),(function(n){return t.handleSubmit(n,e)})),r.onChange&&T.registerHandler(n,"change_".concat(e.formId),(function(n){return t.handleChange(n,e)})),r.onBlur&&T.registerHandler(n,"blur_".concat(e.formId),(function(n){return t.handleBlur(n,e)})),r.onReset&&T.registerHandler(n,"reset_".concat(e.formId),(function(n){return t.handleReset(n,e)}))}},{key:"handleSubmit",value:(n=$().mark((function e(t,n){var r,o;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=this.getFormData(t.target),n.state=ee(ee({},n.state),r),o=this.validateForm(n),n.errors=o,n.isValid=0===Object.keys(o).length,n.isValid){e.next=11;break}return this.focusFirstError(t.target,o),"function"==typeof n.handlers.onError&&n.handlers.onError(o,n.state),this.updateFormUI(n),e.abrupt("return");case 11:if(n.isSubmitting=!0,this.updateFormUI(n),e.prev=13,"function"!=typeof n.handlers.onSubmit){e.next=17;break}return e.next=17,n.handlers.onSubmit(n.state,t);case 17:n.touched={},n.isDirty=!1,n.originalState=ee({},n.state),e.next=27;break;case 22:e.prev=22,e.t0=e.catch(13),D.handleError(e.t0),e.t0.fieldErrors?(n.errors=ee(ee({},n.errors),e.t0.fieldErrors),n.isValid=!1):n.errors._form=e.t0.message||"Form submission failed","function"==typeof n.handlers.onError&&n.handlers.onError(n.errors,n.state,e.t0);case 27:return e.prev=27,n.isSubmitting=!1,this.updateFormUI(n),e.finish(27);case 31:case"end":return e.stop()}}),e,this,[[13,22,27,31]])})),r=function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){Z(i,r,o,a,s,"next",e)}function s(e){Z(i,r,o,a,s,"throw",e)}a(void 0)}))},function(e,t){return r.apply(this,arguments)})},{key:"handleChange",value:function(e,t){var n=e.target,r=n.name,o=n.value,i=n.type,a=n.checked;if(r){var s="checkbox"===i?a:o,c=ee({},t.state);c[r]=s,t.state=c,t.touched[r]=!0,t.isDirty=this.checkIsDirty(t),t.handlers.validateOnChange&&this.validateField(r,s,t),"function"==typeof t.handlers.onChange&&t.handlers.onChange(r,s,t.state,e),this.updateFormUI(t)}}},{key:"handleBlur",value:function(e,t){var n=e.target,r=n.name,o=n.value;r&&(t.touched[r]=!0,this.validateField(r,o,t),"function"==typeof t.handlers.onBlur&&t.handlers.onBlur(r,o,t.state,e),this.updateFormUI(t))}},{key:"handleReset",value:function(e,t){t.state=ee({},t.originalState),t.errors={},t.touched={},t.isDirty=!1,t.isValid=!0,"function"==typeof t.handlers.onReset&&t.handlers.onReset(t.state,e),this.updateFormUI(t)}},{key:"setupAutoSave",value:function(e){var t=this,n=function(){e.isDirty&&t.saveFormState(e)},r=setInterval(n,M.get("FORM_AUTO_SAVE_INTERVAL",3e4));e.component.addEventListener("disconnected",n),e.cleanupAutoSave=function(){clearInterval(r),e.component.removeEventListener("disconnected",n)}}},{key:"validateForm",value:function(e){var t=e.state,n=e.handlers,r={};if("function"==typeof n.validate){var o=n.validate(t);Object.assign(r,o)}return e.isValid=0===Object.keys(r).length,r}},{key:"validateField",value:function(e,t,n){var r=n.state,o=n.handlers;if("function"!=typeof o.validateField)return null;var i=o.validateField(e,t,r);return i?n.errors[e]=i:delete n.errors[e],n.isValid=0===Object.keys(n.errors).length,i}},{key:"getFormData",value:function(e){var t,n=new FormData(e),r={},o=function(e){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=J(e))){t&&(e=t);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(a)throw o}}}}(n.entries());try{for(o.s();!(t=o.n()).done;){var i=W(t.value,2),a=i[0],s=i[1];if(a.endsWith("[]")){var c=a.slice(0,-2);r[c]||(r[c]=[]),r[c].push(s)}else r[a]=s}}catch(e){o.e(e)}finally{o.f()}return e.querySelectorAll('input[type="checkbox"]').forEach((function(e){e.name&&(e.name.endsWith("[]")||(r[e.name]=e.checked))})),r}},{key:"checkIsDirty",value:function(e){var t=e.state,n=e.originalState;for(var r in t)if(t[r]!==n[r])return!0;for(var o in n)if(!(o in t))return!0;return!1}},{key:"focusFirstError",value:function(e,t){var n=Object.keys(t)[0];if(n&&"_form"!==n){var r=e.querySelector('[name="'.concat(n,'"]'));r&&"function"==typeof r.focus&&r.focus()}}},{key:"updateFormUI",value:function(e){var t=e.component,n=e.formId,r=e.state,o=e.errors,i=e.touched,a=e.isSubmitting,s=t.shadowRoot?t.shadowRoot.getElementById(n):t.querySelector("#".concat(n));s&&(this.updateFormFields(s,r),this.updateErrorMessages(s,o,i),this.updateSubmitButton(s,a),"function"==typeof e.handlers.onRender&&e.handlers.onRender(e))}},{key:"updateFormFields",value:function(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var o=W(r[n],2),i=o[0],a=o[1],s=e.querySelector('[name="'.concat(i,'"]'));if(s)if("checkbox"===s.type)s.checked=!!a;else if("radio"===s.type){var c=e.querySelector('[name="'.concat(i,'"][value="').concat(a,'"]'));c&&(c.checked=!0)}else s.value=a}}},{key:"updateErrorMessages",value:function(e,t,n){e.querySelectorAll(".error-message").forEach((function(e){return e.remove()})),e.querySelectorAll(".error").forEach((function(e){e.classList.remove("error"),e.removeAttribute("aria-invalid")}));for(var r=0,o=Object.entries(t);r<o.length;r++){var i=W(o[r],2),a=i[0],s=i[1];if("_form"===a||n[a])if("_form"===a){var c=document.createElement("div");c.className="error-message form-error",c.setAttribute("role","alert"),c.textContent=s,e.insertBefore(c,e.firstChild)}else{var u=e.querySelector('[name="'.concat(a,'"]'));if(!u)continue;u.classList.add("error"),u.setAttribute("aria-invalid","true");var l=document.createElement("div");l.className="error-message",l.id="".concat(a,"-error"),l.setAttribute("role","alert"),l.textContent=s,u.setAttribute("aria-describedby",l.id),u.parentNode.insertBefore(l,u.nextSibling)}}}},{key:"updateSubmitButton",value:function(e,t){var n=e.querySelector('button[type="submit"]');n&&(n.disabled=t,t?(n.setAttribute("data-original-text",n.textContent),n.textContent="Submitting..."):n.hasAttribute("data-original-text")&&(n.textContent=n.getAttribute("data-original-text"),n.removeAttribute("data-original-text")))}},{key:"saveFormState",value:function(e){try{var t=M.get("STORAGE_PREFIX","casl_"),n="".concat(t,"form_").concat(e.formId),r={state:e.state,timestamp:(new Date).toISOString()};localStorage.setItem(n,JSON.stringify(r)),"function"==typeof e.handlers.onSave&&e.handlers.onSave(e.state)}catch(e){console.warn("Error saving form state:",e)}}},{key:"loadFormState",value:function(e){try{var t=M.get("STORAGE_PREFIX","casl_"),n="".concat(t,"form_").concat(e),r=localStorage.getItem(n);if(!r)return null;var o=JSON.parse(r),i=M.get("FORM_STATE_MAX_AGE",864e5),a=new Date(o.timestamp).getTime();return Date.now()-a>i?(localStorage.removeItem(n),null):o.state}catch(e){return console.warn("Error loading form state:",e),null}}},{key:"clearSavedFormState",value:function(e){try{var t=M.get("STORAGE_PREFIX","casl_"),n="".concat(t,"form_").concat(e);localStorage.removeItem(n)}catch(e){console.warn("Error clearing form state:",e)}}},{key:"cleanupForm",value:function(e){"function"==typeof e.cleanupAutoSave&&e.cleanupAutoSave(),this.forms.delete(e.id)}}],t&&ne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}(),ie=(new oe,function(e,t){return"Moving to step ".concat(e," of ").concat(t,": ").concat(p[e-1])}),ae=function(e){return 1===e?"1 form field has an error. Please correct it before proceeding.":"".concat(e," form fields have errors. Please correct them before proceeding.")},se=function(e,t,n){return"Verification complete! Your CASL Key ID is ".concat(e," with a trust score of ").concat(t," out of 100. Trust level: ").concat(n,".")},ce=function(e){return"".concat(e," verification successful! This will improve your trust score.")},ue=function(e){return"".concat(e," verification could not be completed. You can try again or use a different verification method.")},le=function(e){return"".concat(e," verification in progress. Please wait.")};function de(){for(var e="CK",t=0;t<5;t++)e+="ABCDEFGHJKLMNPQRSTUVWXYZ23456789".charAt(Math.floor(32*Math.random()));return e}function he(e){return he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},he(e)}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return(t=we(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ge(){ge=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==he(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(he(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function me(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function ye(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){me(i,r,o,a,s,"next",e)}function s(e){me(i,r,o,a,s,"throw",e)}a(void 0)}))}}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,we(r.key),r)}}function we(e){var t=function(e){if("object"!=he(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=he(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==he(t)?t:t+""}var xe=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clientId=null},t=[{key:"initialize",value:(o=ye(ge().mark((function e(){return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.clientId=this.generateClientId()}catch(e){D.handleError(e)}case 1:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"generateClientId",value:function(){var e=localStorage.getItem("casl_client_id");if(e)return e;for(var t=[screen.width,screen.height,screen.colorDepth,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.language,navigator.platform].join("|"),n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n|=0;var o=Math.abs(n).toString(36);return localStorage.setItem("casl_client_id",o),o}},{key:"getAuthHeaders",value:(r=ye(ge().mark((function e(){var t,n=arguments;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",pe(pe({},t),{},{"X-Client-ID":this.clientId||this.generateClientId()}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"isAuthenticated",value:(n=ye(ge().mark((function e(t){var n,r,o;return ge().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=M.getApiBaseUrl(),e.t0=fetch,e.t1="".concat(n,"/user-check"),e.t2=pe,e.t3=pe,e.t4={},e.next=9,this.getAuthHeaders();case 9:return e.t5=e.sent,e.t6=(0,e.t3)(e.t4,e.t5),e.t7={},e.t8={"Content-Type":"application/json"},e.t9=(0,e.t2)(e.t6,e.t7,e.t8),e.t10=JSON.stringify({email:t}),e.t11={method:"POST",headers:e.t9,credentials:"include",body:e.t10},e.next=18,(0,e.t0)(e.t1,e.t11);case 18:return r=e.sent,e.next=21,r.json();case 21:return o=e.sent,e.abrupt("return",!0===o.found);case 25:return e.prev=25,e.t12=e.catch(0),D.handleError(e.t12),e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,this,[[0,25]])}))),function(e){return n.apply(this,arguments)})},{key:"logout",value:function(){try{return localStorage.removeItem("casl_client_id"),sessionStorage.removeItem("casl_refresh_token"),sessionStorage.removeItem("casl_token_expiry"),!0}catch(e){return D.handleError(e),!1}}}],t&&be(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}());function ke(e){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ke(e)}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){_e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _e(e,t,n){return(t=Ae(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pe(){Pe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==ke(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(ke(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Oe(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Te(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Oe(i,r,o,a,s,"next",e)}function s(e){Oe(i,r,o,a,s,"throw",e)}a(void 0)}))}}function je(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ae(r.key),r)}}function Ae(e){var t=function(e){if("object"!=ke(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ke(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ke(t)?t:t+""}var Ce=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=M.getApiBaseUrl(),this.initializeApiSecurity()},t=[{key:"initializeApiSecurity",value:(f=Te(Pe().mark((function e(){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xe.initialize();case 3:I.setLoading(!1),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),D.handleError(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(){return f.apply(this,arguments)})},{key:"request",value:(h=Te(Pe().mark((function e(t){var n,r,o,i,a,s,c,u,l,d,h,f,p,v,g,m,y,b,w=arguments;return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=w.length>1&&void 0!==w[1]?w[1]:"GET",r=w.length>2&&void 0!==w[2]?w[2]:null,o=!(w.length>3&&void 0!==w[3])||w[3],i=!(w.length>4&&void 0!==w[4])||w[4],a="req_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,5)),e.prev=5,I.updateState("ui",(function(e){return Ie(Ie({},e),{},{activeRequests:[].concat((t=e.activeRequests||[],function(e){if(Array.isArray(e))return Se(e)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),[a])});var t})),s="".concat(this.baseUrl,"/").concat(t),c={"Content-Type":"application/json","Accept-Language":this.getPreferredLanguage(),"X-Request-ID":a},!o){e.next=13;break}return e.next=12,xe.getAuthHeaders(c);case 12:c=e.sent;case 13:return u=r,r&&o&&M.get("ENCRYPT_REQUESTS",!1)&&(u={payload:xe.encryptData(r),timestamp:Date.now()}),l={method:n,headers:c,body:u?JSON.stringify(u):void 0},i&&(l.credentials="include"),e.next=19,this.timeoutFetch(s,l);case 19:if((d=e.sent).ok){e.next=39;break}return h=null,e.prev=22,e.next=25,d.json();case 25:h=e.sent,e.next=34;break;case 28:return e.prev=28,e.t0=e.catch(22),e.next=32,d.text();case 32:f=e.sent,h={message:f||"API Error: ".concat(d.status)};case 34:if(401!==d.status&&403!==d.status){e.next=38;break}throw D.createAuthError((null===(p=h)||void 0===p?void 0:p.message)||"Authentication error: ".concat(d.status),d.status);case 38:throw D.createApiError((null===(v=h)||void 0===v?void 0:v.message)||"API Error: ".concat(d.status),d.status,h);case 39:if(!(d.headers.get("content-type")||"").includes("application/json")){e.next=48;break}return e.next=43,d.json();case 43:if(g=e.sent,!o||!g.encrypted){e.next=46;break}return e.abrupt("return",xe.decryptData(g.payload));case 46:e.next=52;break;case 48:return e.next=50,d.text();case 50:m=e.sent,g={data:m};case 52:return e.abrupt("return",g);case 55:if(e.prev=55,e.t1=e.catch(5),!(401===e.t1.status||null!==(y=e.t1.message)&&void 0!==y&&y.includes("token expired")||null!==(b=e.t1.message)&&void 0!==b&&b.includes("unauthorized"))){e.next=70;break}return e.prev=58,e.next=61,xe.refreshApiToken();case 61:if(!e.sent){e.next=64;break}return e.abrupt("return",this.request(t,n,r,o,i));case 64:e.next=70;break;case 66:throw e.prev=66,e.t2=e.catch(58),D.handleError(e.t1),e.t1;case 70:throw D.handleError(e.t1),e.t1;case 72:return e.prev=72,I.updateState("ui",(function(e){return Ie(Ie({},e),{},{activeRequests:(e.activeRequests||[]).filter((function(e){return e!==a}))})})),e.finish(72);case 75:case"end":return e.stop()}}),e,this,[[5,55,72,75],[22,28],[58,66]])}))),function(e){return h.apply(this,arguments)})},{key:"timeoutFetch",value:(d=Te(Pe().mark((function e(t,n){var r,o=arguments;return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>2&&void 0!==o[2]?o[2]:3e4,e.abrupt("return",Promise.race([fetch(t,n),new Promise((function(e,t){return setTimeout((function(){return t(D.createApiError("Request timeout",408))}),r)}))]));case 2:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"getPreferredLanguage",value:function(){var e=I.getState("ui");return e&&e.language?e.language:localStorage.getItem(M.get("LOCALIZATION_KEY"))||navigator.language||M.get("DEFAULT_LANGUAGE")}},{key:"checkUserStatus",value:(l=Te(Pe().mark((function e(t){var n,r,o;return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,I.setVerification({loading:!0,error:null}),e.next=4,this.request("user-check","POST",{email:t.email,name:t.name,phone:t.phone,address:t.address});case 4:return(n=e.sent).found?r={caslKeyId:n.userData.caslKeyId,isExistingUser:!0,isVerified:n.userData.isVerified,verificationType:"existing",isChecking:!1,error:null,platformData:n.userData.platformData||null,idVerificationData:n.userData.idVerificationData||null}:(o=de(),r={caslKeyId:o,isExistingUser:!1,isVerified:!1,verificationType:null,isChecking:!1,error:null,platformData:null,idVerificationData:null}),I.setVerification(Ie(Ie({},r),{},{loading:!1})),e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(0),I.setVerification({loading:!1,error:e.t0.message||"Failed to verify user"}),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(e){return l.apply(this,arguments)})},{key:"uploadScreenshot",value:(u=Te(Pe().mark((function e(t,n){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateImageData(t),I.updateState("ui",{loading:!0}),e.prev=2,e.next=5,this.request("upload","POST",{userId:n,imageData:t});case 5:return e.abrupt("return",e.sent);case 6:return e.prev=6,I.updateState("ui",{loading:!1}),e.finish(6);case 9:case"end":return e.stop()}}),e,this,[[2,,6,9]])}))),function(e,t){return u.apply(this,arguments)})},{key:"checkVerificationStatus",value:(c=Te(Pe().mark((function e(t){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("status?userId=".concat(encodeURIComponent(t)),"GET"));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"submitVerification",value:(s=Te(Pe().mark((function e(t){var n;return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.updateState("ui",{loading:!0}),I.updateState("results",{isSubmitted:!1}),e.prev=2,e.next=5,this.request("verify","POST",t);case 5:return n=e.sent,I.updateState("results",Ie({isSubmitted:!0},n)),e.abrupt("return",n);case 8:return e.prev=8,I.updateState("ui",{loading:!1}),e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[2,,8,11]])}))),function(e){return s.apply(this,arguments)})},{key:"verifyGovernmentId",value:(a=Te(Pe().mark((function e(t,n,r){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateImageData(t),this.validateImageData(n),I.updateState("ui",{loading:!0}),e.prev=3,e.next=6,this.request("verify-id","POST",{userId:r,idImageData:t,selfieImageData:n});case 6:return e.abrupt("return",e.sent);case 7:return e.prev=7,I.updateState("ui",{loading:!1}),e.finish(7);case 10:case"end":return e.stop()}}),e,this,[[3,,7,10]])}))),function(e,t,n){return a.apply(this,arguments)})},{key:"requestPhoneVerification",value:(i=Te(Pe().mark((function e(t,n){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.updateState("ui",{loading:!0}),e.prev=1,e.next=4,this.request("verify-phone/request","POST",{userId:n,phoneNumber:t});case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,I.updateState("ui",{loading:!1}),e.finish(5);case 8:case"end":return e.stop()}}),e,this,[[1,,5,8]])}))),function(e,t){return i.apply(this,arguments)})},{key:"verifyPhoneCode",value:(o=Te(Pe().mark((function e(t,n,r){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.updateState("ui",{loading:!0}),e.prev=1,e.next=4,this.request("verify-phone/verify","POST",{userId:r,verificationId:n,code:t});case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,I.updateState("ui",{loading:!1}),e.finish(5);case 8:case"end":return e.stop()}}),e,this,[[1,,5,8]])}))),function(e,t,n){return o.apply(this,arguments)})},{key:"verifySocialMedia",value:(r=Te(Pe().mark((function e(t,n,r,o){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I.updateState("ui",{loading:!0}),e.prev=1,e.next=4,this.request("verify-social","POST",{userId:o,platform:t,profileUrl:n,accessToken:r});case 4:return e.abrupt("return",e.sent);case 5:return e.prev=5,I.updateState("ui",{loading:!1}),e.finish(5);case 8:case"end":return e.stop()}}),e,this,[[1,,5,8]])}))),function(e,t,n,o){return r.apply(this,arguments)})},{key:"getAvailableLanguages",value:(n=Te(Pe().mark((function e(){return Pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.request("languages","GET",null,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setLanguagePreference",value:function(e){localStorage.setItem(M.get("LOCALIZATION_KEY"),e),I.updateState("ui",{language:e})}},{key:"validateImageData",value:function(e){if(!e)throw D.createValidationError("Image data is required");if(!e.startsWith("data:image/"))throw D.createValidationError("Invalid image data format");var t=M.get("MAX_SCREENSHOT_SIZE");if(Math.ceil(3*e.length/4)>t)throw D.createValidationError("Image size exceeds maximum allowed size of ".concat(Math.floor(t/1048576),"MB"));var n=M.getAllowedImageTypes(),r=e.match(/^data:(image\/[a-zA-Z0-9+.-]+);base64,/);if(!r||!n.includes(r[1]))throw D.createValidationError("Image type not allowed")}}],t&&je(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o,i,a,s,c,u,l,d,h,f}(),De=new Ce;function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Ne(){Ne=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Le(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Le(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Fe(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Fe(i,r,o,a,s,"next",e)}function s(e){Fe(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Me(r.key),r)}}function Me(e){var t=function(e){if("object"!=Le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Le(t)?t:t+""}var Ge=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentLanguage="en",this.availableLanguages=[{code:"en",name:"English",direction:"ltr"},{code:"es",name:"Espa√±ol",direction:"ltr"},{code:"fr",name:"Fran√ßais",direction:"ltr"},{code:"de",name:"Deutsch",direction:"ltr"},{code:"zh",name:"‰∏≠Êñá",direction:"ltr"},{code:"ja",name:"Êó•Êú¨Ë™û",direction:"ltr"},{code:"ar",name:"ÿßŸÑÿπÿ±ÿ®Ÿäÿ©",direction:"rtl"},{code:"ru",name:"–†—É—Å—Å–∫–∏–π",direction:"ltr"},{code:"pt",name:"Portugu√™s",direction:"ltr"},{code:"hi",name:"‡§π‡§ø‡§®‡•ç‡§¶‡•Ä",direction:"ltr"}],this.translations={},this.init()},t=[{key:"init",value:(o=Ve(Ne().mark((function e(){return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.detectLanguage(),e.next=3,this.loadTranslations(this.currentLanguage);case 3:this.updateDocumentLanguage();case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"detectLanguage",value:function(){var e=localStorage.getItem("casl_language");if(e&&this.isLanguageSupported(e))this.currentLanguage=e;else{var t=navigator.language.split("-")[0];this.isLanguageSupported(t)&&(this.currentLanguage=t)}}},{key:"isLanguageSupported",value:function(e){return this.availableLanguages.some((function(t){return t.code===e}))}},{key:"loadTranslations",value:(r=Ve(Ne().mark((function e(t){return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.translations[t]){e.next=2;break}return e.abrupt("return");case 2:e.prev=2,"en"===t?this.translations.en={"app.title":"CASL Key Verification","app.submit":"Submit","app.next":"Next","app.previous":"Previous","app.loading":"Loading...","app.submitting":"Submitting...","app.required":"Required","app.optional":"Optional","app.error":"Error","app.success":"Success","auth.loginTitle":"Log In","auth.username":"Username","auth.password":"Password","auth.login":"Log In","auth.loggingIn":"Logging in...","auth.needAccount":"Need an account?","auth.registerTitle":"Register","auth.email":"Email","auth.confirmPassword":"Confirm Password","auth.passwordRequirements":"Password must be at least 8 characters and include a number","auth.register":"Register","auth.registering":"Registering...","auth.haveAccount":"Already have an account?","auth.passwordsDoNotMatch":"Passwords do not match","auth.genericError":"Authentication failed. Please try again.","auth.loggedInAs":"Logged in as {username}","auth.logout":"Log Out","auth.logoutError":"Error logging out","auth.welcome":"Welcome to CASL Key Verification","auth.welcomeDescription":"Verify your identity to get your CASL Key","auth.firstTime":"First time user","auth.returningUser":"Returning user","steps.userIdentification":"User Identification","steps.bookingInfo":"Booking Information","steps.stayIntent":"Stay Intent","steps.agreement":"Agreement","userIdentification.name":"Full Name","userIdentification.email":"Email Address","userIdentification.phone":"Phone Number","userIdentification.address":"Address","userIdentification.airbnbProfile":"Airbnb Profile Link","userIdentification.vrboProfile":"Vrbo Profile Link","userIdentification.otherPlatformProfile":"Other Platform Profile","userIdentification.selectPlatform":"Select platform","userIdentification.verifyWithScreenshot":"Verify with Account Screenshot","userIdentification.bgCheckConsent":"I consent to a background check to verify my identity.","userIdentification.checkingStatus":"Checking user status...","userIdentification.welcomeBack":"Welcome back! We found your existing CASL Key ID:","userIdentification.uploadScreenshot":"Please upload a screenshot of your Airbnb or VRBO profile page to verify your account.","userIdentification.dragScreenshot":"Drag a screenshot here or click to select a file","userIdentification.processing":"Your screenshot is being processed. This may take a minute...","userIdentification.verified":"Your account has been verified successfully!","userIdentification.manualReview":"Your screenshot has been submitted for manual review. We'll notify you once it's verified.","userIdentification.rejected":"We couldn't verify your account from this screenshot. Please try again with a clearer image.","bookingInfo.platform":"Platform used","bookingInfo.listingLink":"STR Listing Link","bookingInfo.checkInDate":"Check-in Date","bookingInfo.checkOutDate":"Check-out Date","stayIntent.purpose":"What is the primary purpose of your stay?","stayIntent.otherPurpose":"Please specify","stayIntent.totalGuests":"How many total guests will stay?","stayIntent.childrenUnder12":"Are there any children under 12?","stayIntent.nonOvernightGuests":"Will any guests not be staying overnight?","stayIntent.travelingNearHome":"Are you traveling within 20 miles of your home?","stayIntent.zipCode":"ZIP code","stayIntent.usedSTRBefore":"Have you used STRs before?","stayIntent.previousStayLinks":"Optional: Previous stay links","agreement.agreeToRules":"I agree to follow quiet hours and property rules","agreement.agreeNoParties":"I agree not to host parties or events without host approval","agreement.understandFlagging":"I understand that violation of these terms may result in being flagged in CASL Key's network","results.title":"CASL Key Verification Result","results.caslKeyId":"CASL Key ID:","results.scoreFactors":"Score Factors","results.noAdjustments":"No score adjustments applied.","results.trustBadgeInfo":"Trust Badge Information","results.trustBadgeDescription":"Your trust badge is valid for 12 months. Future hosts will see your verification status, but never your personal details.","results.startOver":"Start Over","trustLevel.verified":"Verified ‚Äì Low Risk","trustLevel.review":"Verified ‚Äì Review Recommended","trustLevel.manualReview":"Manual Review Pending","trustLevel.notEligible":"Not Eligible at This Time","message.verified":"You're officially CASL Key Verified! Your trust badge is valid for 12 months and can be shared with any CASL Key host. Keep your badge active by booking responsibly.","message.review":"You're almost there! While you're verified, your Trust Score indicates a few flags (e.g., local booking or large group). Hosts may ask additional questions.","message.manualReview":"We're completing a review of your profile. This typically takes 24-48 hours. We'll notify you once your profile has been reviewed.","message.notEligible":"We're unable to approve your CASL Key at this time. You may reapply in 90 days or contact support to resolve outstanding concerns.","tooltip.profileHelp":"Providing a platform profile helps verify your identity and may improve your trust score.","tooltip.listingLink":"Provide the exact URL of your booking to verify it's legitimate.","tooltip.stayPurpose":"This helps hosts understand why you're traveling.","tooltip.childrenUnder12":"Having children in your group may positively affect your trust score.","tooltip.nonOvernightGuests":"This helps hosts understand if additional visitors may be present during the day.","tooltip.travelingNearHome":"Local bookings may require additional context for verification.","tooltip.previousStayLinks":"Prior rental experience may positively impact your trust score.","tooltip.rules":"Following property-specific rules helps maintain great relationships with hosts and neighbors.","tooltip.noParties":"Always discuss any gathering plans with your host in advance.","tooltip.understandFlagging":"CASL Key aims to create a trusted network of verified guests and hosts. Complying with platform standards keeps your verification active.","language.select":"Select Language","language.current":"Current: English"}:"es"===t&&(this.translations.es={"app.title":"Verificaci√≥n CASL Key","app.submit":"Enviar","app.next":"Siguiente","app.previous":"Anterior","app.loading":"Cargando...","app.submitting":"Enviando...","app.required":"Obligatorio","app.optional":"Opcional","app.error":"Error","app.success":"√âxito","auth.loginTitle":"Iniciar Sesi√≥n","auth.username":"Nombre de Usuario","auth.password":"Contrase√±a","auth.login":"Iniciar Sesi√≥n","auth.loggingIn":"Iniciando sesi√≥n...","auth.needAccount":"¬øNecesitas una cuenta?","auth.registerTitle":"Registrarse","auth.email":"Correo Electr√≥nico","auth.confirmPassword":"Confirmar Contrase√±a","auth.passwordRequirements":"La contrase√±a debe tener al menos 8 caracteres e incluir un n√∫mero","auth.register":"Registrarse","auth.registering":"Registrando...","auth.haveAccount":"¬øYa tienes una cuenta?","auth.passwordsDoNotMatch":"Las contrase√±as no coinciden","auth.genericError":"Autenticaci√≥n fallida. Por favor, int√©ntalo de nuevo.","auth.loggedInAs":"Conectado como {username}","auth.logout":"Cerrar Sesi√≥n","auth.logoutError":"Error al cerrar sesi√≥n","auth.welcome":"Bienvenido a Verificaci√≥n CASL Key","auth.welcomeDescription":"Verifica tu identidad para obtener tu CASL Key","auth.firstTime":"Usuario por primera vez","auth.returningUser":"Usuario que regresa","steps.userIdentification":"Identificaci√≥n de Usuario","steps.bookingInfo":"Informaci√≥n de Reserva","steps.stayIntent":"Prop√≥sito de Estancia","steps.agreement":"Acuerdo","userIdentification.name":"Nombre Completo","userIdentification.email":"Correo Electr√≥nico","userIdentification.phone":"N√∫mero de Tel√©fono","userIdentification.address":"Direcci√≥n","userIdentification.airbnbProfile":"Enlace de Perfil de Airbnb","userIdentification.vrboProfile":"Enlace de Perfil de Vrbo","userIdentification.otherPlatformProfile":"Perfil de Otra Plataforma","userIdentification.selectPlatform":"Seleccionar plataforma","userIdentification.verifyWithScreenshot":"Verificar con Captura de Pantalla","userIdentification.bgCheckConsent":"Consiento a una verificaci√≥n de antecedentes para verificar mi identidad.","userIdentification.checkingStatus":"Comprobando estado del usuario...","userIdentification.welcomeBack":"¬°Bienvenido de nuevo! Encontramos tu CASL Key ID existente:","language.select":"Seleccionar Idioma","language.current":"Actual: Espa√±ol"}),e.next=12;break;case 6:return e.prev=6,e.t0=e.catch(2),console.error("Failed to load translations for ".concat(t,":"),e.t0),this.currentLanguage="en",e.next=12,this.loadTranslations("en");case 12:case"end":return e.stop()}}),e,this,[[2,6]])}))),function(e){return r.apply(this,arguments)})},{key:"translate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(this.translations[this.currentLanguage]||{})[e]||this.translations.en&&this.translations.en[e]||e;return Object.entries(t).forEach((function(e){var t,r,o=(r=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(t,r)||function(e,t){if(e){if("string"==typeof e)return Re(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,t):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];n=n.replace("{".concat(i,"}"),a)})),n}},{key:"changeLanguage",value:(n=Ve(Ne().mark((function e(t){var n;return Ne().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLanguageSupported(t)){e.next=3;break}return console.error("Language ".concat(t," is not supported")),e.abrupt("return");case 3:return this.currentLanguage=t,localStorage.setItem("casl_language",t),e.next=7,this.loadTranslations(t);case 7:this.updateDocumentLanguage(),n=new CustomEvent("caslLanguageChanged",{detail:{language:t,languageInfo:this.getLanguageInfo(t)},bubbles:!0,composed:!0}),document.dispatchEvent(n);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getLanguageInfo",value:function(e){return this.availableLanguages.find((function(t){return t.code===e}))||null}},{key:"updateDocumentLanguage",value:function(){var e=this.getLanguageInfo(this.currentLanguage);e&&(document.documentElement.dir=e.direction,document.documentElement.lang=e.code)}},{key:"renderLanguageSelector",value:function(){var e=this,t=(this.getLanguageInfo(this.currentLanguage),"");return this.availableLanguages.forEach((function(n){t+='\n        <option value="'.concat(n.code,'" ').concat(n.code===e.currentLanguage?"selected":"",">\n          ").concat(n.name,"\n        </option>\n      ")})),'\n      <div class="language-selector">\n        <label for="language-select">'.concat(this.translate("language.select"),'</label>\n        <select id="language-select" onchange="this.getRootNode().host.handleLanguageChange(event)">\n          ').concat(t,'\n        </select>\n        <p class="current-language">').concat(this.translate("language.current"),"</p>\n      </div>\n    ")}},{key:"formatDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{dateStyle:"medium"},n=e instanceof Date?e:new Date(e);return new Intl.DateTimeFormat(this.currentLanguage,t).format(n)}},{key:"formatNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Intl.NumberFormat(this.currentLanguage,t).format(e)}},{key:"formatCurrency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat(this.currentLanguage,{style:"currency",currency:t}).format(e)}}],t&&Ue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}(),ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return qe.translate(e,t)},qe=new Ge;function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Ke(){Ke=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==He(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(He(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Be(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Ye(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Be(i,r,o,a,s,"next",e)}function s(e){Be(i,r,o,a,s,"throw",e)}a(void 0)}))}}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Je(r.key),r)}}function Je(e){var t=function(e){if("object"!=He(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==He(t)?t:t+""}var Xe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.verificationStatus=null,this.idImageData=null,this.selfieImageData=null,this.verificationResult=null,this.isLoading=!1,this.error=null},t=[{key:"reset",value:function(){this.verificationStatus=null,this.idImageData=null,this.selfieImageData=null,this.verificationResult=null,this.isLoading=!1,this.error=null}},{key:"uploadIdImage",value:(o=Ye(Ke().mark((function e(t){return Ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.type.startsWith("image/")){e.next=3;break}return this.error=qe.translate("governmentId.invalidFileType"),e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,this.readFileAsDataURL(t);case 6:return this.idImageData=e.sent,e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(3),console.error("Error reading ID image:",e.t0),this.error=qe.translate("governmentId.errorReadingFile"),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(e){return o.apply(this,arguments)})},{key:"uploadSelfieImage",value:(r=Ye(Ke().mark((function e(t){return Ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.type.startsWith("image/")){e.next=3;break}return this.error=qe.translate("governmentId.invalidFileType"),e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,this.readFileAsDataURL(t);case 6:return this.selfieImageData=e.sent,e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(3),console.error("Error reading selfie image:",e.t0),this.error=qe.translate("governmentId.errorReadingFile"),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,this,[[3,10]])}))),function(e){return r.apply(this,arguments)})},{key:"readFileAsDataURL",value:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){return t(e.target.result)},r.onerror=function(e){return n(e)},r.readAsDataURL(e)}))}},{key:"verifyId",value:(n=Ye(Ke().mark((function e(t){var n;return Ke().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.idImageData&&this.selfieImageData){e.next=3;break}return this.error=qe.translate("governmentId.missingImages"),e.abrupt("return",null);case 3:return e.prev=3,this.isLoading=!0,this.error=null,this.verificationStatus="processing",e.next=9,De.verifyGovernmentId(this.idImageData,this.selfieImageData,t);case 9:return n=e.sent,this.verificationResult=n,this.verificationStatus=n.status,e.abrupt("return",n);case 15:return e.prev=15,e.t0=e.catch(3),console.error("Error verifying ID:",e.t0),this.error=e.t0.message||qe.translate("governmentId.verificationFailed"),this.verificationStatus="error",e.abrupt("return",null);case 21:return e.prev=21,this.isLoading=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[3,15,21,24]])}))),function(e){return n.apply(this,arguments)})},{key:"renderIdVerificationComponent",value:function(e){var t=qe.translate.bind(qe);return"verified"===this.verificationStatus?'\n        <div class="form-section">\n          <h3>'.concat(t("governmentId.verified"),'</h3>\n          <div class="alert alert-success">\n            <p>').concat(t("governmentId.verificationSuccessful"),"</p>\n          </div>\n        </div>\n      "):"processing"===this.verificationStatus?'\n        <div class="form-section">\n          <h3>'.concat(t("governmentId.verifying"),'</h3>\n          <div class="alert alert-info">\n            <p>').concat(t("governmentId.verificationInProgress"),"</p>\n          </div>\n        </div>\n      "):this.error?'\n        <div class="form-section">\n          <h3>'.concat(t("governmentId.verification"),'</h3>\n          <div class="alert alert-error">\n            <p>').concat(this.error,"</p>\n          </div>\n          ").concat(this.renderUploadForm(e),"\n        </div>\n      "):'\n      <div class="form-section">\n        <h3>'.concat(t("governmentId.verification"),"</h3>\n        <p>").concat(t("governmentId.description"),"</p>\n        ").concat(this.renderUploadForm(e),"\n      </div>\n    ")}},{key:"renderUploadForm",value:function(e){var t=qe.translate.bind(qe);return'\n      <div class="id-verification-form">\n        <div class="id-upload-section">\n          <h4>'.concat(t("governmentId.uploadId"),"</h4>\n          <p>").concat(t("governmentId.idInstructions"),'</p>\n          \n          <div class="screenshot-container" id="id-image-dropzone">\n            ').concat(this.idImageData?'\n              <img src="'.concat(this.idImageData,'" class="screenshot-preview" alt="Government ID preview" />\n              <button onclick="this.getRootNode().host.clearIdImage()" class="neutral">\n                ').concat(t("governmentId.removeImage"),"\n              </button>\n            "):"\n              <p>".concat(t("governmentId.dragId"),'</p>\n              <input \n                type="file" \n                accept="image/*" \n                id="id-image-input" \n                class="file-input"\n                aria-label="').concat(t("governmentId.uploadId"),'"\n                onchange="this.getRootNode().host.handleIdImageUpload(event)" \n              />\n            '),'\n          </div>\n        </div>\n        \n        <div class="selfie-upload-section">\n          <h4>').concat(t("governmentId.uploadSelfie"),"</h4>\n          <p>").concat(t("governmentId.selfieInstructions"),'</p>\n          \n          <div class="screenshot-container" id="selfie-image-dropzone">\n            ').concat(this.selfieImageData?'\n              <img src="'.concat(this.selfieImageData,'" class="screenshot-preview" alt="Selfie preview" />\n              <button onclick="this.getRootNode().host.clearSelfieImage()" class="neutral">\n                ').concat(t("governmentId.removeImage"),"\n              </button>\n            "):"\n              <p>".concat(t("governmentId.dragSelfie"),'</p>\n              <input \n                type="file" \n                accept="image/*" \n                id="selfie-image-input" \n                class="file-input"\n                aria-label="').concat(t("governmentId.uploadSelfie"),'"\n                onchange="this.getRootNode().host.handleSelfieImageUpload(event)" \n              />\n            '),'\n          </div>\n        </div>\n        \n        <div class="verification-privacy-notice">\n          <h4>').concat(t("governmentId.privacyNotice"),"</h4>\n          <p>").concat(t("governmentId.privacyDescription"),'</p>\n        </div>\n        \n        <div class="verification-actions">\n          <button \n            onclick="this.getRootNode().host.verifyGovId(\'').concat(e,"')\"\n            ").concat(this.idImageData&&this.selfieImageData&&!this.isLoading?"":"disabled",'\n            class="success"\n          >\n            ').concat(this.isLoading?t("app.loading"):t("governmentId.verifyNow"),"\n          </button>\n        </div>\n      </div>\n    ")}}],t&&We(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}(),$e=new Xe;function Ze(e){return Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ze(e)}function Qe(){Qe=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Ze(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Ze(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function et(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function tt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){et(i,r,o,a,s,"next",e)}function s(e){et(i,r,o,a,s,"throw",e)}a(void 0)}))}}function nt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rt(r.key),r)}}function rt(e){var t=function(e){if("object"!=Ze(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ze(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ze(t)?t:t+""}var ot=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.verificationStatus=null,this.verificationId=null,this.phoneNumber=null,this.isLoading=!1,this.error=null,this.codeSent=!1,this.remainingTime=0,this.timerInterval=null},t=[{key:"reset",value:function(){this.verificationStatus=null,this.verificationId=null,this.phoneNumber=null,this.isLoading=!1,this.error=null,this.codeSent=!1,this.remainingTime=0,this.clearTimer()}},{key:"clearTimer",value:function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)}},{key:"startTimer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:120;this.clearTimer(),this.remainingTime=t,this.timerInterval=setInterval((function(){if(e.remainingTime--,e.remainingTime<=0){e.clearTimer(),e.codeSent=!1;var t=new CustomEvent("phoneVerificationTimerExpired",{bubbles:!0,composed:!0});document.dispatchEvent(t)}}),1e3)}},{key:"formatPhoneNumber",value:function(e){if(!e)return"";var t=e.replace(/\D/g,"");return 10===t.length?"(".concat(t.substring(0,3),") ").concat(t.substring(3,6),"-").concat(t.substring(6)):11===t.length&&"1"===t[0]?"+1 (".concat(t.substring(1,4),") ").concat(t.substring(4,7),"-").concat(t.substring(7)):"+".concat(t)}},{key:"requestVerificationCode",value:(r=tt(Qe().mark((function e(t,n){var r;return Qe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this.error=qe.translate("phoneVerification.invalidPhone"),e.abrupt("return",!1);case 3:return e.prev=3,this.isLoading=!0,this.error=null,this.phoneNumber=t,e.next=9,De.requestPhoneVerification(t,n);case 9:return r=e.sent,this.verificationId=r.verificationId,this.codeSent=!0,this.startTimer(r.expiresIn||120),e.abrupt("return",!0);case 16:return e.prev=16,e.t0=e.catch(3),console.error("Error requesting phone verification:",e.t0),this.error=e.t0.message||qe.translate("phoneVerification.requestFailed"),e.abrupt("return",!1);case 21:return e.prev=21,this.isLoading=!1,e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[3,16,21,24]])}))),function(e,t){return r.apply(this,arguments)})},{key:"verifyCode",value:(n=tt(Qe().mark((function e(t,n){var r;return Qe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return this.error=qe.translate("phoneVerification.emptyCode"),e.abrupt("return",null);case 3:if(this.verificationId){e.next=6;break}return this.error=qe.translate("phoneVerification.noVerificationInProgress"),e.abrupt("return",null);case 6:return e.prev=6,this.isLoading=!0,this.error=null,e.next=11,De.verifyPhoneCode(t,this.verificationId,n);case 11:return r=e.sent,this.verificationStatus=r.verified?"verified":"failed",r.verified&&this.clearTimer(),e.abrupt("return",r);case 17:return e.prev=17,e.t0=e.catch(6),console.error("Error verifying code:",e.t0),this.error=e.t0.message||qe.translate("phoneVerification.verificationFailed"),this.verificationStatus="error",e.abrupt("return",null);case 23:return e.prev=23,this.isLoading=!1,e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[6,17,23,26]])}))),function(e,t){return n.apply(this,arguments)})},{key:"renderPhoneVerificationComponent",value:function(e){var t=qe.translate.bind(qe);return"verified"===this.verificationStatus?'\n        <div class="form-section">\n          <h3>'.concat(t("phoneVerification.verified"),'</h3>\n          <div class="alert alert-success">\n            <p>').concat(t("phoneVerification.phoneVerified",{phone:this.formatPhoneNumber(this.phoneNumber)}),"</p>\n          </div>\n        </div>\n      "):"failed"===this.verificationStatus?'\n        <div class="form-section">\n          <h3>'.concat(t("phoneVerification.verification"),'</h3>\n          <div class="alert alert-error">\n            <p>').concat(t("phoneVerification.incorrectCode"),"</p>\n          </div>\n          ").concat(this.renderVerificationForm(e),"\n        </div>\n      "):this.error?'\n        <div class="form-section">\n          <h3>'.concat(t("phoneVerification.verification"),'</h3>\n          <div class="alert alert-error">\n            <p>').concat(this.error,"</p>\n          </div>\n          ").concat(this.renderVerificationForm(e),"\n        </div>\n      "):'\n      <div class="form-section">\n        <h3>'.concat(t("phoneVerification.verification"),"</h3>\n        <p>").concat(t("phoneVerification.description"),"</p>\n        ").concat(this.renderVerificationForm(e),"\n      </div>\n    ")}},{key:"renderVerificationForm",value:function(e){var t=qe.translate.bind(qe);if(this.codeSent){var n=Math.floor(this.remainingTime/60),r=this.remainingTime%60,o="".concat(n,":").concat(r<10?"0":"").concat(r);return'\n        <div class="phone-verification-form">\n          <p>'.concat(t("phoneVerification.codeSent",{phone:this.formatPhoneNumber(this.phoneNumber)}),'</p>\n          \n          <div class="code-input-section">\n            <label for="verification-code">').concat(t("phoneVerification.enterCode"),'</label>\n            <input \n              type="text" \n              id="verification-code" \n              maxlength="6" \n              placeholder="123456" \n              pattern="[0-9]*" \n              inputmode="numeric"\n              autocomplete="one-time-code"\n            />\n            \n            <div class="timer">\n              <span>').concat(t("phoneVerification.codeExpires"),": ").concat(o,'</span>\n            </div>\n          </div>\n          \n          <div class="verification-actions">\n            <button \n              onclick="this.getRootNode().host.verifyPhoneCode(\'').concat(e,"')\"\n              ").concat(this.isLoading?"disabled":"",'\n              class="success"\n            >\n              ').concat(this.isLoading?t("app.loading"):t("phoneVerification.verify"),"\n            </button>\n            \n            <button \n              onclick=\"this.getRootNode().host.resendVerificationCode('").concat(e,"')\"\n              ").concat(this.isLoading||this.remainingTime>0?"disabled":"",'\n              class="neutral"\n            >\n              ').concat(t("phoneVerification.resend"),"\n            </button>\n          </div>\n        </div>\n      ")}return'\n      <div class="phone-verification-form">\n        <div class="phone-input-section">\n          <label for="phone-input">'.concat(t("phoneVerification.phoneNumber"),'</label>\n          <input \n            type="tel" \n            id="phone-input" \n            placeholder="+1 (555) 123-4567"\n            value="').concat(this.phoneNumber||"",'"\n          />\n        </div>\n        \n        <div class="verification-actions">\n          <button \n            onclick="this.getRootNode().host.requestPhoneVerification(\'').concat(e,"')\"\n            ").concat(this.isLoading?"disabled":"",'\n            class="success"\n          >\n            ').concat(this.isLoading?t("app.loading"):t("phoneVerification.sendCode"),"\n          </button>\n        </div>\n      </div>\n    ")}}],t&&nt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}(),it=new ot;function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function st(){st=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==at(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(at(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function ct(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function ut(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ct(i,r,o,a,s,"next",e)}function s(e){ct(i,r,o,a,s,"throw",e)}a(void 0)}))}}function lt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,dt(r.key),r)}}function dt(e){var t=function(e){if("object"!=at(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=at(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==at(t)?t:t+""}var ht=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.verificationStatus=null,this.platform=null,this.profileUrl=null,this.isLoading=!1,this.error=null,this.availablePlatforms=[{id:"facebook",name:"Facebook",icon:"facebook"},{id:"linkedin",name:"LinkedIn",icon:"linkedin"},{id:"instagram",name:"Instagram",icon:"instagram"},{id:"twitter",name:"Twitter",icon:"twitter"},{id:"tiktok",name:"TikTok",icon:"tiktok"}]},t=[{key:"reset",value:function(){this.verificationStatus=null,this.platform=null,this.profileUrl=null,this.isLoading=!1,this.error=null}},{key:"verifySocialProfile",value:(r=ut(st().mark((function e(t,n,r){var o;return st().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=3;break}return this.error=qe.translate("socialVerification.missingInfo"),e.abrupt("return",null);case 3:return e.prev=3,this.isLoading=!0,this.error=null,this.platform=t,this.profileUrl=n,e.next=11,De.verifySocialMedia(t,n,null,r);case 11:return o=e.sent,this.verificationStatus=o.status,e.abrupt("return",o);case 16:return e.prev=16,e.t0=e.catch(3),console.error("Error verifying social profile:",e.t0),this.error=e.t0.message||qe.translate("socialVerification.verificationFailed"),this.verificationStatus="error",e.abrupt("return",null);case 22:return e.prev=22,this.isLoading=!1,e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[3,16,22,25]])}))),function(e,t,n){return r.apply(this,arguments)})},{key:"isValidPlatform",value:function(e){return this.availablePlatforms.some((function(t){return t.id===e}))}},{key:"getPlatformInfo",value:function(e){return this.availablePlatforms.find((function(t){return t.id===e}))||null}},{key:"renderSocialVerificationComponent",value:function(e){var t=qe.translate.bind(qe);if("verified"===this.verificationStatus){var n=this.getPlatformInfo(this.platform),r=n?n.name:this.platform;return'\n        <div class="form-section">\n          <h3>'.concat(t("socialVerification.verified"),'</h3>\n          <div class="alert alert-success">\n            <p>').concat(t("socialVerification.profileVerified",{platform:r}),"</p>\n          </div>\n        </div>\n      ")}return"manual_review"===this.verificationStatus?'\n        <div class="form-section">\n          <h3>'.concat(t("socialVerification.manualReview"),'</h3>\n          <div class="alert alert-warning">\n            <p>').concat(t("socialVerification.pendingReview"),"</p>\n          </div>\n        </div>\n      "):"failed"===this.verificationStatus||"error"===this.verificationStatus?'\n        <div class="form-section">\n          <h3>'.concat(t("socialVerification.verification"),'</h3>\n          <div class="alert alert-error">\n            <p>').concat(this.error||t("socialVerification.verificationFailed"),"</p>\n          </div>\n          ").concat(this.renderVerificationForm(e),"\n        </div>\n      "):'\n      <div class="form-section">\n        <h3>'.concat(t("socialVerification.verification"),"</h3>\n        <p>").concat(t("socialVerification.description"),"</p>\n        ").concat(this.renderVerificationForm(e),"\n      </div>\n    ")}},{key:"renderVerificationForm",value:function(e){var t=this,n=qe.translate.bind(qe),r="";return this.availablePlatforms.forEach((function(e){r+='\n        <option value="'.concat(e.id,'" ').concat(t.platform===e.id?"selected":"",">\n          ").concat(e.name,"\n        </option>\n      ")})),'\n      <div class="social-verification-form">\n        <div class="platform-selection">\n          <label for="social-platform">'.concat(n("socialVerification.selectPlatform"),'</label>\n          <select \n            id="social-platform" \n            onchange="this.getRootNode().host.handleSocialPlatformChange(event)"\n          >\n            <option value="">').concat(n("socialVerification.choosePlatform"),"</option>\n            ").concat(r,'\n          </select>\n        </div>\n        \n        <div class="profile-url-section">\n          <label for="profile-url">').concat(n("socialVerification.profileUrl"),'</label>\n          <input \n            type="url" \n            id="profile-url" \n            placeholder="https://www.example.com/profile/username"\n            value="').concat(this.profileUrl||"",'"\n          />\n          <p class="hint">').concat(n("socialVerification.profileUrlHint"),'</p>\n        </div>\n        \n        <div class="verification-privacy-notice">\n          <h4>').concat(n("socialVerification.privacyNotice"),"</h4>\n          <p>").concat(n("socialVerification.privacyDescription"),'</p>\n        </div>\n        \n        <div class="verification-actions">\n          <button \n            onclick="this.getRootNode().host.verifySocialProfile(\'').concat(e,"')\"\n            ").concat(this.isLoading?"disabled":"",'\n            class="success"\n          >\n            ').concat(this.isLoading?n("app.loading"):n("socialVerification.verify"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"getOAuthUrl",value:function(e){var t="https://casl-key-auth.example.com/oauth";switch(e){case"facebook":return"".concat(t,"/facebook");case"linkedin":return"".concat(t,"/linkedin");case"instagram":return"".concat(t,"/instagram");default:return null}}},{key:"handleOAuthCallback",value:(n=ut(st().mark((function e(t,n){var r,o;return st().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.code&&t.state){e.next=3;break}return this.error=qe.translate("socialVerification.invalidCallback"),e.abrupt("return",!1);case 3:if(e.prev=3,this.isLoading=!0,r=t.state.split("-")[0],this.isValidPlatform(r)){e.next=8;break}throw new Error(qe.translate("socialVerification.invalidPlatform"));case 8:return e.next=10,De.verifySocialMedia(r,null,t.code,n);case 10:return o=e.sent,this.platform=r,this.verificationStatus=o.status,e.abrupt("return",!0);case 16:return e.prev=16,e.t0=e.catch(3),console.error("Error handling OAuth callback:",e.t0),this.error=e.t0.message||qe.translate("socialVerification.oauthFailed"),this.verificationStatus="error",e.abrupt("return",!1);case 22:return e.prev=22,this.isLoading=!1,e.finish(22);case 25:case"end":return e.stop()}}),e,this,[[3,16,22,25]])}))),function(e,t){return n.apply(this,arguments)})}],t&&lt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r}(),ft=new ht;function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function vt(){vt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==pt(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(pt(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function gt(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function mt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){gt(i,r,o,a,s,"next",e)}function s(e){gt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bt(r.key),r)}}function bt(e){var t=function(e){if("object"!=pt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=pt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pt(t)?t:t+""}var wt=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.API_URL="https://api.checkr.com/v1",this.API_KEY=process.env.CHECKR_API_KEY||"placeholder_key"},t=[{key:"initiateBackgroundCheck",value:(o=mt(vt().mark((function e(t){return vt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Initiating background check for:",t.name),t.caslKeyId,t.name,t.email,t.phone,t.address,e.next=5,new Promise((function(e){return setTimeout(e,1500)}));case 5:return e.abrupt("return",{checkId:"check_".concat(Date.now()),status:"complete",passed:!0});case 8:throw e.prev=8,e.t0=e.catch(0),console.error("Background check error:",e.t0),new Error("Error initiating background check. Please try again.");case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),function(e){return o.apply(this,arguments)})},{key:"checkStatus",value:(r=mt(vt().mark((function e(t){return vt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Checking status for background check:",t),e.next=4,new Promise((function(e){return setTimeout(e,800)}));case 4:return e.abrupt("return",{checkId:t,status:"complete",passed:!0});case 7:throw e.prev=7,e.t0=e.catch(0),console.error("Background check status error:",e.t0),new Error("Error checking background check status.");case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e){return r.apply(this,arguments)})},{key:"getNeutralSummary",value:(n=mt(vt().mark((function e(t){return vt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:return e.abrupt("return",{backgroundCheckPassed:!0,summary:"Background check completed successfully.",recommendation:"Meets CASL Key's recommended trust standards."});case 6:throw e.prev=6,e.t0=e.catch(0),console.error("Background check summary error:",e.t0),new Error("Error retrieving background check summary.");case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(e){return n.apply(this,arguments)})},{key:"shouldPromptForBackgroundCheck",value:function(e,t){var n=!!(e.airbnbProfile||e.vrboProfile||e.otherPlatformProfile),r=e.travelingNearHome,o=e.totalGuests>5;return t<70||!n||r||o}}],t&&yt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,o}());function xt(e,t){var n,r=100,o=[];"Special Occasion"===e.stayPurpose&&(r-=5,o.push({reason:"Special occasion/birthday",points:-5})),e.totalGuests>5&&(r-=3,o.push({reason:"6+ guests",points:-3})),e.nonOvernightGuests&&(r-=2,o.push({reason:"Additional (non-overnight) visitors",points:-2})),e.travelingNearHome&&(r-=3,o.push({reason:"Booking within 20 miles of home",points:-3})),e.usedSTRBefore||(r-=5,o.push({reason:"First-time STR guest",points:-5}));var i=kt(e.checkInDate);return null!==i&&i<=2&&(r-=3,o.push({reason:"Booking within 48 hours of check-in",points:-3})),e.childrenUnder12&&(r+=1,o.push({reason:"Group includes minors under 12",points:1})),function(e,t){if(!e||!t)return null;var n=new Date(e),r=new Date(t);if(isNaN(n.getTime())||isNaN(r.getTime()))return null;var o=r.getTime()-n.getTime();return Math.ceil(o/864e5)}(e.checkInDate,e.checkOutDate)>7&&(r+=2,o.push({reason:"Booking for over 7 nights",points:2})),t.platformData&&(t.platformData.reviewCount>5?(r+=3,o.push({reason:"Well-reviewed on platform",points:3})):t.platformData.reviewCount>0&&(r+=1,o.push({reason:"Has platform reviews",points:1}))),null!==(n=t.idVerificationData)&&void 0!==n&&n.verified&&(r+=5,o.push({reason:"Verified background check",points:5})),e.usedSTRBefore&&e.previousStayLinks.trim()&&(r+=3,o.push({reason:"Previous stays provided with links",points:3})),{score:Math.max(0,Math.min(100,r)),adjustments:o}}function kt(e){if(!e)return null;var t=new Date;t.setHours(0,0,0,0);var n=new Date(e);n.setHours(0,0,0,0);var r=n.getTime()-t.getTime();return Math.ceil(r/864e5)}function St(e){return e>=85?u:e>=70?l:e>=50?d:h}function Et(e){switch(e){case u:return"You're officially CASL Key Verified! Your trust badge is valid for 12 months and can be shared with any CASL Key host. Keep your badge active by booking responsibly.";case l:return"You're almost there! While you're verified, your Trust Score indicates a few flags (e.g., local booking or large group). Hosts may ask additional questions.";case d:return"We're completing a review of your profile. This typically takes 24-48 hours. We'll notify you once your profile has been reviewed.";case h:return"We're unable to approve your CASL Key at this time. You may reapply in 90 days or contact support to resolve outstanding concerns.";default:return"Thank you for completing your CASL Key verification."}}function It(e){var t,n=e.caslKeyId,r=e.trustLevel,o=e.score,i=(e.user,e.verification),a=e.booking,s=e.stayDetails;t=o>=85?"85-100":o>=70?"70-84":o>=50?"50-69":"Below 50";var c,f,p=!!i.verificationType&&["platform","screenshot","existing"].includes(i.verificationType),v=i.backgroundCheckCompleted?"completed":"not_completed",g={localBooking:s.travelingNearHome||!1,highGuestCount:s.totalGuests>5||!1,noSTRHistory:!s.previousExperience||!1,lastMinuteBooking:(c=a.checkInDate,f=kt(c),null!==f&&f<=2||!1)},m="",y="";switch(r){case u:m="This guest meets CASL Key trust standards.",y="ID verified. Platform account confirmed. No safety concerns flagged.";break;case l:m="This guest is verified but has traits that may require additional context.",y="ID verified. Some booking characteristics suggest reviewing context.";break;case d:m="This guest is pending manual review. You'll be notified when complete.",y="Guest has initiated verification process. Review in progress.";break;case h:m="This guest does not currently meet eligibility requirements.",y="Not eligible at this time."}return{caslKeyId:n,trustLevel:r,scoreRange:t,platformVerified:p,backgroundCheckStatus:v,bookingMatch:!0,flags:g,recommendation:m,summary:y}}function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return(t=Gt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tt(){Tt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Nt(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Nt(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function jt(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function At(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){jt(i,r,o,a,s,"next",e)}function s(e){jt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Ct(e){var t="function"==typeof Map?new Map:void 0;return Ct=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(Dt())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&Lt(o,n.prototype),o}(e,arguments,Rt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Lt(n,e)},Ct(e)}function Dt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Dt=function(){return!!e})()}function Lt(e,t){return Lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Lt(e,t)}function Rt(e){return Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rt(e)}function Nt(e){return Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Nt(e)}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Gt(r.key),r)}}function Mt(e,t,n){return t&&Ut(e.prototype,t),n&&Ut(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Gt(e){var t=function(e){if("object"!=Nt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Nt(t)?t:t+""}var zt=new(function(){return Mt((function e(){Vt(this,e),this.metrics={},this.thresholds={render:50,api:1e3,memory:50},this.supportsMemoryAPI=!!(performance&&performance.memory&&performance.memory.usedJSHeapSize)}),[{key:"startTimer",value:function(e){this.metrics[e]||(this.metrics[e]={}),this.metrics[e].startTime=performance.now()}},{key:"endTimer",value:function(e){var t;if(null!==(t=this.metrics[e])&&void 0!==t&&t.startTime){var n=performance.now()-this.metrics[e].startTime;if(this.metrics[e].durations||(this.metrics[e].durations=[],this.metrics[e].total=0,this.metrics[e].count=0),this.metrics[e].durations.push(n),this.metrics[e].total+=n,this.metrics[e].count++,this.metrics[e].durations.length>100){var r=this.metrics[e].durations.shift();this.metrics[e].total-=r,this.metrics[e].count--}var o=this.thresholds[e]||100;return n>o&&console.warn("Performance warning: ".concat(e," took ").concat(n.toFixed(2),"ms (threshold: ").concat(o,"ms)")),n}return 0}},{key:"checkMemoryUsage",value:function(){if(this.supportsMemoryAPI){var e={total:performance.memory.totalJSHeapSize/1048576,used:performance.memory.usedJSHeapSize/1048576,limit:performance.memory.jsHeapSizeLimit/1048576};return e.used>this.thresholds.memory&&console.warn("Memory usage warning: ".concat(e.used.toFixed(2),"MB used (threshold: ").concat(this.thresholds.memory,"MB)")),e}return null}},{key:"getAllMetrics",value:function(){var e=this,t={};Object.keys(this.metrics).forEach((function(n){var r,o;e.metrics[n].count&&(t[n]={average:e.metrics[n].total/e.metrics[n].count,count:e.metrics[n].count,max:Math.max.apply(Math,(o=e.metrics[n].durations||[0],function(e){if(Array.isArray(e))return Ft(e)}(o)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||function(e,t){if(e){if("string"==typeof e)return Ft(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ft(e,t):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),latest:(null===(r=e.metrics[n].durations)||void 0===r?void 0:r.slice(-1)[0])||0})}));var n=this.checkMemoryUsage();return n&&(t.memory=n),t}}])}()),qt=function(e){function t(){var e;return Vt(this,t),(e=function(e,t,n){return t=Rt(t),function(e,t){if(t&&("object"==Nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Dt()?Reflect.construct(t,n||[],Rt(e).constructor):t.apply(e,n))}(this,t)).attachShadow({mode:"open"}),e._renderCount=0,e._validationTimer=null,e._verificationPollInterval=null,e._prevRenderState=null,e._trustPreviewCache={},e.componentId=T.initComponent(e),e.liveRegion=B.createLiveRegion("polite","verification-status"),e.firstRender=!0,e.uxMetrics={formStarted:!1,stepsCompleted:new Set,startTime:performance.now()},e.initializeState(),e.render(),e.setupEventListeners(),e.initializeServices(),e.addSkipLink(),window.location.search.includes("debug=true")&&e.enableDebugMode(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lt(e,t)}(t,e),Mt(t,[{key:"initializeState",value:function(){var e=this;this.unsubscribeHandlers=[],this.unsubscribeHandlers.push(I.subscribe("formData",(function(t){var n=e.formData;e.formData=t,e.hasImportantFieldsChanged(n,t)&&(e.validateForm(),e.debounceSaveFormData()),e.render()}))),this.unsubscribeHandlers.push(I.subscribe("verification",(function(t){e.userIdentification=t,e.validateForm(),e.render()}))),this.unsubscribeHandlers.push(I.subscribe("ui",(function(t){e.isLoading===t.loading&&e.apiError===t.alert||(e.isLoading=t.loading,e.apiError=t.alert,e.render())}))),this.unsubscribeHandlers.push(I.subscribe("results",(function(t){e.submitted!==t.isSubmitted&&(e.submitted=t.isSubmitted,e.score=t.score,e.trustLevel=t.trustLevel,e.message=t.message,e.adjustments=t.adjustments,e.render())}))),this.currentStep=I.getState("formData").currentStep||0,this.showScreenshotUpload=!1,this.screenshotData=null,this.verificationStatus=i,this.showRestoredMessage=!1,this.showVerificationMethods=!1,this.selectedVerificationMethod=null,this.formData=I.getState("formData"),this.userIdentification=I.getState("verification");var t=I.getState("ui");this.isLoading=t.loading,this.apiError=t.alert;var n=I.getState("results");this.submitted=n.isSubmitted,this.score=n.score,this.trustLevel=n.trustLevel,this.message=n.message,this.adjustments=n.adjustments,this.errors={},this.trustPreview=null,this.loadTrustPreview()}},{key:"hasImportantFieldsChanged",value:function(e,t){if(!e)return!0;if(e.currentStep!==t.currentStep)return!0;var n=[];switch(this.currentStep){case 0:n.push("name","email","phone","address","consentToBackgroundCheck");break;case 1:n.push("platform","listingLink","checkInDate","checkOutDate");break;case 2:n.push("stayPurpose","totalGuests","travelingNearHome","usedSTRBefore");break;case 3:n.push("agreeToRules","agreeNoParties","understandFlagging")}return n.some((function(n){return e[n]!==t[n]}))}},{key:"shouldUpdateRender",value:function(){this._prevRenderState||(this._prevRenderState={});var e={currentStep:this.currentStep,isLoading:this.isLoading,apiError:null!==this.apiError,submitted:this.submitted,showScreenshotUpload:this.showScreenshotUpload,verificationStatus:this.verificationStatus,errorCount:Object.keys(this.errors).length,showVerificationMethods:this.showVerificationMethods},t=!this._prevRenderState.currentState||JSON.stringify(e)!==JSON.stringify(this._prevRenderState.currentState);return this._prevRenderState.currentState=e,t}},{key:"initializeServices",value:(E=At(Tt().mark((function e(){return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return zt.startTimer("services_init"),e.prev=1,e.next=4,xe.initialize();case 4:return e.next=6,qe.init();case 6:this.loadSavedData(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),D.handleError(e.t0);case 12:return e.prev=12,zt.endTimer("services_init"),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[1,9,12,15]])}))),function(){return E.apply(this,arguments)})},{key:"debounceSaveFormData",value:function(){var e=this;clearTimeout(this._saveFormDataTimer),this._saveFormDataTimer=setTimeout((function(){e.saveFormData()}),300)}},{key:"connectedCallback",value:function(){console.log("Enhanced CASL Verification Element connected"),document.body.appendChild(this.liveRegion)}},{key:"disconnectedCallback",value:function(){this.logPerformanceReport(),this.unsubscribeHandlers.forEach((function(e){return e()})),T.cleanupComponent(this.componentId),clearTimeout(this._validationTimer),clearTimeout(this._saveFormDataTimer),this._verificationPollInterval&&(clearInterval(this._verificationPollInterval),this._verificationPollInterval=null),this.screenshotData=null,this.liveRegion.parentNode&&this.liveRegion.parentNode.removeChild(this.liveRegion),this._prevRenderState=null,this._trustPreviewCache=null}},{key:"addSkipLink",value:function(){B.addSkipLink("verification-main-content")}},{key:"logPerformanceReport",value:function(){var e,t,n=zt.getAllMetrics();console.group("CASL Verification Performance Report"),console.log("Render time (avg):",(null===(e=n.render)||void 0===e?void 0:e.average.toFixed(2))+"ms"),console.log("API calls (avg):",Object.keys(n).filter((function(e){return e.startsWith("api_")})).map((function(e){return"".concat(e,": ").concat(n[e].average.toFixed(2),"ms")})).join(", ")),console.log("Memory usage:",(null===(t=n.memory)||void 0===t?void 0:t.used.toFixed(2))+"MB"),console.log("Steps completed:",Array.from(this.uxMetrics.stepsCompleted).join(", ")),console.log("Render count:",this._renderCount),console.groupEnd()}},{key:"enableDebugMode",value:function(){var e=this;return window._CASLDebugTools||(window._CASLDebugTools={getState:function(){return{formData:e.formData,userIdentification:e.userIdentification,currentStep:e.currentStep,errors:e.errors,verificationStatus:e.verificationStatus}},getPerformanceMetrics:function(){return zt.getAllMetrics()},forceRender:function(){return e.render()},reset:function(){return e.handleReset()},info:function(){var t;return console.table({componentId:e.componentId,renderCount:e._renderCount||0,memoryUsage:(null===(t=zt.checkMemoryUsage())||void 0===t?void 0:t.used)+"MB",currentStep:e.currentStep,errorCount:Object.keys(e.errors).length})}},console.info("CASL Debug Tools enabled. Access via window._CASLDebugTools")),window._CASLDebugTools}},{key:"render",value:function(){var e;if(this.shouldUpdateRender()){this._renderCount=(this._renderCount||0)+1,zt.startTimer("render"),performance.mark("render_start");var t=this.submitted?this.renderResults():this.renderForm(),n="\n      <style>".concat('\n    :host {\n      display: block;\n      font-family: Arial, sans-serif;\n      \n      /* Primary colors with contrast-safe text colors */\n      --primary-color: #4285F4;\n      --primary-color-dark: #1a5dd4;\n      --on-primary-color: #ffffff;\n      \n      --success-color: #4CAF50;\n      --on-success-color: #ffffff;\n      \n      --warning-color: #EC9F05; /* Darkened for better contrast */\n      --on-warning-color: #000000;\n      \n      --error-color: #c62828;\n      --on-error-color: #ffffff;\n      \n      --neutral-color: #5C5C5C; /* Darkened for better contrast */\n      --on-neutral-color: #ffffff;\n      \n      --surface-color: #ffffff;\n      --on-surface-color: #212121;\n      \n      --disabled-color: #9E9E9E;\n      --on-disabled-color: #212121;\n      \n      --border-radius: 8px;\n      --box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      --focus-ring-color: #4285F4;\n      --focus-ring-width: 3px;\n    }\n    \n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    \n    .form-section {\n      background-color: var(--surface-color);\n      padding: 20px;\n      border-radius: var(--border-radius);\n      margin-bottom: 20px;\n      box-shadow: var(--box-shadow);\n    }\n    \n    button {\n      padding: 10px 20px;\n      background-color: var(--primary-color);\n      color: var(--on-primary-color);\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      margin: 5px;\n      transition: background-color 0.2s, opacity 0.2s;\n      min-height: 44px;\n    }\n    \n    button:hover {\n      background-color: var(--primary-color-dark);\n    }\n    \n    button:focus {\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 2px;\n    }\n    \n    button:disabled {\n      background-color: var(--disabled-color);\n      color: var(--on-disabled-color);\n      cursor: not-allowed;\n    }\n    \n    button.success {\n      background-color: var(--success-color);\n      color: var(--on-success-color);\n    }\n    \n    button.success:hover {\n      background-color: #3d8b40;\n    }\n    \n    button.warning {\n      background-color: var(--warning-color);\n      color: var(--on-warning-color);\n    }\n    \n    button.warning:hover {\n      background-color: #c78500;\n    }\n    \n    button.neutral {\n      background-color: var(--neutral-color);\n      color: var(--on-neutral-color);\n    }\n    \n    button.neutral:hover {\n      background-color: #3d3d3d;\n    }\n    \n    input, select, textarea {\n      width: 100%;\n      padding: 12px;\n      margin-bottom: 10px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 16px;\n      transition: border-color 0.2s;\n      min-height: 44px;\n    }\n    \n    input:focus, select:focus, textarea:focus {\n      border-color: var(--primary-color);\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 0;\n    }\n    \n    textarea {\n      resize: vertical;\n      min-height: 80px;\n    }\n    \n    label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n    }\n    \n    .error {\n      color: var(--error-color);\n      font-size: 14px;\n      margin-top: -5px;\n      margin-bottom: 10px;\n    }\n    \n    .navigation-buttons {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 20px;\n    }\n    \n    .alert {\n      padding: 12px 15px;\n      border-radius: 4px;\n      margin-bottom: 15px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    \n    .alert-success {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n      border-left: 4px solid var(--success-color);\n    }\n    \n    .alert-error {\n      background-color: #ffebee;\n      color: var(--error-color);\n      border-left: 4px solid var(--error-color);\n    }\n    \n    .alert-info {\n      background-color: #e3f2fd;\n      color: #0d47a1;\n      border-left: 4px solid var(--primary-color);\n    }\n    \n    .alert-warning {\n      background-color: #fff8e1;\n      color: #f57f17;\n      border-left: 4px solid var(--warning-color);\n    }\n    \n    .progress-steps {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 30px;\n    }\n    \n    .step {\n      text-align: center;\n      position: relative;\n      width: 25%;\n    }\n    \n    .step-indicator {\n      width: 30px;\n      height: 30px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto 5px;\n      z-index: 2;\n      position: relative;\n    }\n    \n    .progress-bar {\n      height: 8px;\n      background-color: #eee;\n      border-radius: 4px;\n      margin-bottom: 25px;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .progress-indicator {\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      background-color: var(--primary-color);\n      border-radius: 4px;\n      transition: width 0.3s ease;\n    }\n    \n    .screenshot-container {\n      border: 2px dashed #ccc;\n      padding: 20px;\n      text-align: center;\n      margin-bottom: 20px;\n      border-radius: 4px;\n      transition: border-color 0.2s;\n      position: relative;\n      min-height: 150px;\n    }\n    \n    .screenshot-container:hover {\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-container.drag-over {\n      background-color: #f0f7ff;\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-preview {\n      max-width: 100%;\n      max-height: 300px;\n      margin-top: 10px;\n      border-radius: 4px;\n    }\n    \n   .file-input {\n     position: absolute;\n     width: 100%;\n     height: 100%;\n     top: 0;\n     left: 0;\n     opacity: 0;\n     cursor: pointer;\n   }\n   \n   .result-card {\n     background-color: white;\n     padding: 30px;\n     border-radius: var(--border-radius);\n     box-shadow: var(--box-shadow);\n     text-align: center;\n     margin-bottom: 20px;\n   }\n   \n   .trust-badge {\n     display: inline-block;\n     padding: 10px 20px;\n     border-radius: 4px;\n     font-weight: bold;\n     color: white;\n     margin: 15px 0;\n   }\n   \n   .score-display {\n     margin: 20px 0;\n   }\n   \n   .score-number {\n     font-size: 48px;\n     font-weight: bold;\n   }\n   \n   .score-max {\n     color: #666;\n   }\n   \n   .result-message {\n     padding: 15px;\n     background-color: #f5f5f5;\n     border-radius: 8px;\n     font-size: 18px;\n     margin: 20px 0;\n   }\n   \n   .adjustments-list {\n     margin-top: 30px;\n     text-align: left;\n   }\n   \n   .adjustment-item {\n     display: flex;\n     justify-content: space-between;\n     padding: 10px;\n     border-bottom: 1px solid #eee;\n   }\n   \n   .adjustment-points {\n     font-weight: bold;\n   }\n   \n   .adjustment-positive {\n     color: var(--success-color);\n   }\n   \n   .adjustment-negative {\n     color: var(--error-color);\n   }\n   \n   .tooltip {\n     position: relative;\n     display: inline-block;\n     margin-left: 5px;\n     cursor: help;\n   }\n   \n   .tooltip .tooltip-icon {\n     background-color: #ddd;\n     color: #333;\n     width: 24px;\n     height: 24px;\n     border-radius: 50%;\n     display: inline-flex;\n     align-items: center;\n     justify-content: center;\n     font-size: 14px;\n     font-weight: bold;\n   }\n   \n   .tooltip .tooltip-text {\n     visibility: hidden;\n     width: 250px;\n     background-color: #333;\n     color: #fff;\n     text-align: center;\n     border-radius: 6px;\n     padding: 8px;\n     position: absolute;\n     z-index: 1;\n     bottom: 125%;\n     left: 50%;\n     transform: translateX(-50%);\n     opacity: 0;\n     transition: opacity 0.3s;\n     font-size: 14px;\n     font-weight: normal;\n   }\n   \n   .tooltip:hover .tooltip-text {\n     visibility: visible;\n     opacity: 1;\n   }\n   \n   .checkbox-container {\n     display: flex;\n     align-items: flex-start;\n     margin-bottom: 10px;\n     min-height: 44px;\n   }\n   \n   .checkbox-container input[type="checkbox"] {\n     width: auto;\n     min-width: 24px;\n     min-height: 24px;\n     margin-right: 10px;\n     margin-top: 3px;\n   }\n   \n   .checkbox-label {\n     font-weight: normal;\n     flex: 1;\n   }\n   \n   .trust-preview {\n     background-color: #f5f5f5;\n     border: 1px solid #ddd;\n     border-radius: var(--border-radius);\n     padding: 15px;\n     margin-top: 20px;\n   }\n   \n   .trust-preview h3 {\n     margin-top: 0;\n     font-size: 16px;\n     color: #333;\n   }\n   \n   .preview-badge {\n     display: inline-block;\n     padding: 6px 12px;\n     border-radius: 4px;\n     font-size: 14px;\n     color: white;\n     margin-right: 10px;\n   }\n   \n   /* Mobile accessibility styles */\n   @media (max-width: 768px) {\n     .container {\n       padding: 10px;\n     }\n     \n     .form-section {\n       padding: 15px;\n     }\n     \n     .progress-steps {\n       display: none;\n     }\n     \n     .mobile-step-indicator {\n       display: block !important;\n       text-align: center;\n       margin-bottom: 20px;\n     }\n     \n     /* Ensure touch targets are at least 44x44px */\n     button, \n     [role="button"], \n     a,\n     .checkbox-container,\n     input[type="checkbox"],\n     input[type="radio"],\n     input[type="submit"],\n     select,\n     .tooltip {\n       min-height: 44px;\n       min-width: 44px;\n     }\n     \n     /* Improve touch target sizes on mobile */\n     button {\n       padding: 12px 20px;\n       width: 100%;\n       margin: 8px 0;\n       font-size: 16px;\n     }\n     \n     .navigation-buttons {\n       flex-direction: column-reverse;\n       gap: 10px;\n     }\n     \n     /* Adjust form layouts for better touch interaction */\n     .form-section {\n       padding: 20px 16px;\n     }\n     \n     /* Improve checkbox touch targets */\n     .checkbox-container {\n       padding: 8px 0;\n       margin: 8px 0;\n     }\n     \n     .checkbox-container input[type="checkbox"] {\n       transform: scale(1.25);\n       margin-right: 12px;\n       margin-top: 6px;\n     }\n     \n     /* Larger tap target for tooltip */\n     .tooltip .tooltip-icon {\n       width: 30px;\n       height: 30px;\n       font-size: 16px;\n     }\n     \n     /* Adjust spacing between elements */\n     label {\n       margin-bottom: 8px;\n       display: block;\n     }\n     \n     input, select, textarea {\n       padding: 14px;\n       font-size: 16px; /* Prevents iOS zoom on focus */\n       margin-bottom: 16px;\n     }\n     \n     /* Improved error display */\n     .error {\n       padding: 8px 0;\n       font-size: 14px;\n     }\n   }\n   \n   /* Reduced motion preferences */\n   @media (prefers-reduced-motion: reduce) {\n     /* Remove all animations and transitions */\n     *, *::before, *::after {\n       animation-duration: 0.001ms !important;\n       animation-iteration-count: 1 !important;\n       transition-duration: 0.001ms !important;\n       scroll-behavior: auto !important;\n     }\n     \n     /* Specific elements that need animation removal */\n     .progress-indicator {\n       transition: none !important;\n     }\n     \n     .tooltip .tooltip-text {\n       transition: none !important;\n     }\n     \n     /* Replace animations with immediate state changes */\n     .tooltip:hover .tooltip-text {\n       visibility: visible;\n       opacity: 1;\n       transition: none !important;\n     }\n   }\n   \n   /* Focus styles and accessibility support */\n   :focus-visible {\n     outline: var(--focus-ring-width) solid var(--focus-ring-color);\n     outline-offset: 2px;\n     border-radius: 2px;\n   }\n   \n   /* High contrast mode support */\n   @media (forced-colors: active) {\n     .progress-indicator {\n       background-color: SelectedItem;\n     }\n     \n     button {\n       border: 1px solid ButtonText;\n     }\n     \n     :focus-visible {\n       outline: 3px solid CanvasText !important;\n       outline-offset: 3px;\n     }\n   }\n   \n   /* Skip link for keyboard users */\n   .skip-to-content {\n     position: absolute;\n     top: -5rem;\n     left: 0;\n     padding: 1rem;\n     background: var(--primary-color);\n     color: white;\n     z-index: 100;\n     opacity: 0;\n     transition: top 0.2s, opacity 0.2s;\n   }\n   \n   .skip-to-content:focus {\n     top: 0;\n     opacity: 1;\n   }\n   \n   /* Screen reader only text */\n   .sr-only {\n     position: absolute;\n     width: 1px;\n     height: 1px;\n     padding: 0;\n     margin: -1px;\n     overflow: hidden;\n     clip: rect(0, 0, 0, 0);\n     white-space: nowrap;\n     border-width: 0;\n   }\n   \n   /* Form validation visual cues */\n   input:invalid,\n   select:invalid,\n   textarea:invalid {\n     border-color: var(--error-color);\n   }\n   \n   /* Required fields indicator */\n   label.required::after {\n     content: "*";\n     color: var(--error-color);\n     margin-left: 2px;\n   }\n ','</style>\n      <div \n        class="container" \n        dir="').concat((null===(e=qe.getLanguageInfo(qe.currentLanguage))||void 0===e?void 0:e.direction)||"ltr",'"\n      >\n        <div class="header">\n          <h1 id="page-title">CASL Key Verification</h1>\n          ').concat(qe.renderLanguageSelector(),'\n        </div>\n        \n        <main id="verification-main-content" tabindex="-1">\n          ').concat(t,"\n        </main>\n      </div>\n    ");n=T.replaceInlineHandlers(n),n=B.enhanceHtml(n),this.shadowRoot.innerHTML=n,this.announceStatusChanges(),this.firstRender&&(this.firstRender=!1),zt.endTimer("render"),performance.mark("render_end"),performance.measure("render","render_start","render_end"),this._renderCount%10==0&&zt.checkMemoryUsage()}}},{key:"renderForm",value:function(){return this.showVerificationMethods?"\n        ".concat(v(this.showRestoredMessage,this.apiError),"\n        ").concat(this.selectedVerificationMethod?function(e,t){switch(e){case"government-id":return $e.renderIdVerificationComponent(t);case"phone":return it.renderPhoneVerificationComponent(t);case"social":return ft.renderSocialVerificationComponent(t);default:return""}}(this.selectedVerificationMethod,this.userIdentification.caslKeyId):function(e){var t,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return qe.translate(e,t)},r=null===(t=e.idVerificationData)||void 0===t?void 0:t.verified,o="verified"===it.verificationStatus,i="verified"===ft.verificationStatus;return'\n    <div class="verification-methods-selector">\n      <h3>'.concat(n("verificationMethods.additionalVerification"),"</h3>\n      <p>").concat(n("verificationMethods.description"),'</p>\n      \n      <div class="verification-method-options">\n        <div class="verification-method-card ').concat(r?"verified":"",'" onclick="this.getRootNode().host.selectVerificationMethod(\'government-id\')">\n          <div class="method-icon">ü™™</div>\n          <div class="method-info">\n            <h4>').concat(n("verificationMethods.governmentId"),"</h4>\n            <p>").concat(n("verificationMethods.governmentIdDesc"),"</p>\n            ").concat(r?'<span class="verified-badge">‚úÖ '.concat(n("verificationMethods.verified"),"</span>"):"",'\n          </div>\n        </div>\n        \n        <div class="verification-method-card ').concat(o?"verified":"",'" onclick="this.getRootNode().host.selectVerificationMethod(\'phone\')">\n          <div class="method-icon">üì±</div>\n          <div class="method-info">\n            <h4>').concat(n("verificationMethods.phone"),"</h4>\n            <p>").concat(n("verificationMethods.phoneDesc"),"</p>\n            ").concat(o?'<span class="verified-badge">‚úÖ '.concat(n("verificationMethods.verified"),"</span>"):"",'\n          </div>\n        </div>\n        \n        <div class="verification-method-card ').concat(i?"verified":"",'" onclick="this.getRootNode().host.selectVerificationMethod(\'social\')">\n          <div class="method-icon">üë§</div>\n          <div class="method-info">\n            <h4>').concat(n("verificationMethods.social"),"</h4>\n            <p>").concat(n("verificationMethods.socialDesc"),"</p>\n            ").concat(i?'<span class="verified-badge">‚úÖ '.concat(n("verificationMethods.verified"),"</span>"):"",'\n          </div>\n        </div>\n      </div>\n      \n      <p class="verification-benefits">\n        ').concat(n("verificationMethods.benefits"),"\n      </p>\n    </div>\n  ")}(this.userIdentification),'\n        <div class="navigation-buttons">\n          <button \n            data-event-click="toggleVerificationMethods"\n            class="neutral"\n            aria-label="Return to main form"\n          >\n            <span aria-hidden="true">‚Üê</span> Return to Main Form\n          </button>\n        </div>\n      '):"\n      ".concat((e=this.currentStep,t=(e+1)/p.length*100,n="",p.forEach((function(t,r){var o=r===e,i=r<e,a=r<=e?"var(--primary-color)":"#999",s=i?"var(--primary-color)":o?"white":"#ddd",c=i?"white":o?"var(--primary-color)":"#666",u=o?"2px solid var(--primary-color)":"none";n+='\n      <div \n        class="step '.concat(o?"active":""," ").concat(i?"completed":"",'" \n        style="color: ').concat(a,'" \n        role="tab" \n        id="step-').concat(r,'"\n        aria-selected="').concat(o?"true":"false",'" \n        aria-label="Step ').concat(r+1,": ").concat(t," ").concat(i?"(completed)":o?"(current)":"",'"\n        aria-controls="step-content-').concat(r,'"\n      >\n        <div \n          class="step-indicator" \n          style="background-color: ').concat(s,"; color: ").concat(c,"; border: ").concat(u,'"\n          aria-hidden="true"\n        >\n          ').concat(i?"‚úì":r+1,'\n        </div>\n        <span class="step-label">').concat(t,"</span>\n      </div>\n    ")})),'\n    <div class="progress-container" role="navigation" aria-label="Form progress">\n      <div \n        class="progress-steps" \n        role="tablist" \n        aria-orientation="horizontal"\n      >\n        '.concat(n,'\n      </div>\n      \n      <div \n        class="progress-bar" \n        role="progressbar" \n        aria-valuenow="').concat(e+1,'" \n        aria-valuemin="1" \n        aria-valuemax="').concat(p.length,'"\n        aria-valuetext="Step ').concat(e+1," of ").concat(p.length,": ").concat(p[e],'"\n      >\n        <div \n          class="progress-indicator" \n          style="width: ').concat(t,'%"\n          aria-hidden="true"\n        ></div>\n      </div>\n      \n      <div class="sr-only">\n        You are on step ').concat(e+1," of ").concat(p.length,": ").concat(p[e],'\n      </div>\n    </div>\n    \n    <div \n      class="mobile-step-indicator" \n      style="text-align: center; margin-bottom: 20px; display: none"\n      aria-hidden="true" \n    >\n      <span style="font-weight: bold">Step ').concat(e+1," of ").concat(p.length,": ").concat(p[e],"</span>\n    </div>\n  ")),"\n      ").concat(v(this.showRestoredMessage,this.apiError),"\n      ").concat(this.renderCurrentStep(),"\n      ").concat(this.trustPreview?function(e){if(!e)return"";var t=e.trustLevel,n=e.scoreRange,r=e.flags,o="#4CAF50",i="Verified";"review"===t?(o="#FFC107",i="Context Needed"):"manual_review"===t?(o="#9E9E9E",i="Review Pending"):"not_eligible"===t&&(o="#757575",i="Not Eligible");var a=[];r&&(r.localBooking&&a.push("Local booking"),r.highGuestCount&&a.push("6+ guests"),r.noSTRHistory&&a.push("First-time STR user"),r.lastMinuteBooking&&a.push("Last-minute booking"));var s=a.length>0?"Flags: ".concat(a.join(", ")):"No flags";return'\n    <div \n      class="trust-preview" \n      role="region" \n      aria-labelledby="trust-preview-heading"\n    >\n      <h3 id="trust-preview-heading">Trust Preview (what hosts will see)</h3>\n      <div>\n        <span \n          class="preview-badge" \n          style="background-color: '.concat(o,';"\n          aria-label="Trust badge: ').concat(i,'"\n        >\n          ').concat(i,"\n        </span>\n<span>Score range: ").concat(n,"</span>\n     </div>\n     <p>").concat(s,"</p>\n     <p><small>Hosts will never see your personal details, only a verification status.</small></p>\n   </div>\n ")}(this.trustPreview):"","\n      ").concat(function(e,t,n){var r=e===p.length-1,o=0===e,i=!t||n,a=r?"Submit":"Next",s=r?"Submitting...":"Loading...";return'\n    <div \n      class="navigation-buttons" \n      role="group" \n      aria-label="Form navigation"\n    >\n      <button \n        type="button"\n        class="btn-previous"\n        onclick="this.getRootNode().host.handlePreviousStep()"\n        '.concat(o?"disabled":"",'\n        aria-disabled="').concat(o,'"\n        aria-label="').concat(o?"Previous step (disabled, this is the first step)":"Go to previous step",'"\n      >\n        <span aria-hidden="true">‚Üê </span>Previous\n      </button>\n      \n      <button \n        type="button"\n        class="btn-next ').concat(r?"btn-submit":"",'"\n        onclick="this.getRootNode().host.handleNextStep()"\n        ').concat(i?"disabled":"",'\n        aria-disabled="').concat(i,'"\n        aria-label="').concat(i?t?"Please wait":"Please fix form errors before continuing":r?"Submit form":"Go to next step",'"\n      >\n        ').concat(n?'\n          <span class="spinner" aria-hidden="true">\n            \x3c!-- Loading indicator SVG --\x3e\n            <svg width="16" height="16" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">\n              <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="4" opacity="0.25" />\n              <circle \n                cx="12" \n                cy="12" \n                r="10" \n                fill="none" \n                stroke="currentColor" \n                stroke-width="4" \n                stroke-dasharray="30 100" \n                style="animation: spin 1s linear infinite" \n              />\n            </svg>\n            <style>\n              @keyframes spin {\n                from { transform: rotate(0deg); }\n                to { transform: rotate(360deg); }\n              }\n              \n              @media (prefers-reduced-motion: reduce) {\n                .spinner svg circle {\n                  animation: none !important;\n                }\n              }\n            </style>\n          </span>\n          <span aria-live="polite">'.concat(s,"</span>\n        "):"".concat(a).concat(r?"":' <span aria-hidden="true">‚Üí</span>'),"\n      </button>\n    </div>\n  ")}(this.currentStep,this.isFormValid,this.isLoading),"\n    ");var e,t,n}},{key:"renderCurrentStep",value:function(){switch(this.currentStep){case 0:return function(e,t,n,r,o,i){if(n.isChecking)return'\n      <div \n        id="step-content-0"\n        class="form-section loading-state" \n        style="text-align: center"\n      >\n        <h2>User Identification</h2>\n        <p>Checking user status...</p>\n        <div \n          class="loading-spinner" \n          role="status" \n          aria-live="polite"\n        >\n          <div class="spinner-visual" aria-hidden="true"></div>\n          <span class="sr-only">Verifying your information. Please wait.</span>\n        </div>\n      </div>\n    ';var u="";r&&(u='\n      <div \n        class="screenshot-section" \n        aria-labelledby="screenshot-heading"\n      >\n        <h3 id="screenshot-heading">Platform Verification via Screenshot</h3>\n        <p>Please upload a screenshot of your Airbnb or VRBO profile page to verify your account.</p>\n        \n        <div \n          class="screenshot-container" \n          id="screenshot-dropzone"\n          ondragover="this.getRootNode().host.handleDragOver(event)"\n          ondragleave="this.getRootNode().host.handleDragLeave(event)"\n          ondrop="this.getRootNode().host.handleDrop(event)"\n          aria-describedby="screenshot-instructions"\n        >\n          '.concat(o?'\n            <p id="screenshot-instructions">Screenshot Preview:</p>\n            <img \n              src="'.concat(o,'" \n              class="screenshot-preview" \n              alt="Uploaded profile screenshot" \n            />\n            <button \n              onclick="this.getRootNode().host.clearScreenshot()" \n              class="neutral"\n              aria-label="Remove uploaded screenshot"\n            >\n              Remove Screenshot\n            </button>\n          '):'\n            <p id="screenshot-instructions">Drag a screenshot here or click to select a file</p>\n            <input \n              type="file" \n              accept="image/*" \n              id="screenshot-input" \n              class="file-input"\n              aria-label="Upload profile screenshot"\n              onchange="this.getRootNode().host.handleScreenshotUpload(event)" \n              aria-describedby="screenshot-instructions"\n            />\n          ',"\n        </div>\n        \n        ").concat(i===a?'\n          <div \n            class="alert alert-info" \n            role="status" \n            aria-live="polite"\n          >\n            <p>Your screenshot is being processed. This may take a minute...</p>\n            <div class="spinner-visual" aria-hidden="true"></div>\n          </div>\n        ':i===s?'\n          <div \n            class="alert alert-success" \n            role="status" \n            aria-live="polite"\n          >\n            <p><span aria-hidden="true">‚úÖ</span> Your account has been verified successfully!</p>\n          </div>\n        ':i===c?'\n          <div \n            class="alert alert-warning" \n            role="status" \n            aria-live="polite"\n          >\n            <p><span aria-hidden="true">üëÄ</span> Your screenshot has been submitted for manual review. We\'ll notify you once it\'s verified.</p>\n          </div>\n        ':"REJECTED"===i?'\n          <div \n            class="alert alert-error" \n            role="alert" \n            aria-live="assertive"\n          >\n            <p><span aria-hidden="true">‚ùå</span> We couldn\'t verify your account from this screenshot. Please try again with a clearer image.</p>\n          </div>\n        ':"","\n      </div>\n    "));var l,d=!(e.airbnbProfile||e.vrboProfile||e.otherPlatformProfile||n.isVerified||i===s||i===c);return'\n    <div \n      id="step-content-0"\n      class="form-section" \n      role="form" \n      aria-labelledby="user-id-heading"\n    >\n      <h2 id="user-id-heading">User Identification</h2>\n      \n      <div class="sr-only" id="form-instructions">\n        This form has multiple steps. Required fields are marked with an asterisk (*).\n        Use the Next and Previous buttons to navigate between steps.\n      </div>\n      \n      '.concat(n.error?'\n        <div \n          class="alert alert-error" \n          role="alert" \n          aria-live="assertive"\n        >\n          '.concat(n.error,"\n        </div>\n      "):"","\n      \n      ").concat(n.caslKeyId&&n.isExistingUser?'\n        <div \n          class="alert alert-success" \n          role="status" \n          aria-live="polite"\n        >\n          Welcome back! We found your existing CASL Key ID: '.concat(n.caslKeyId,"\n        </div>\n      "):"",'\n      \n      <div class="form-group">\n        <label for="name-input" class="required">Full Name</label>\n        <input \n          type="text" \n          id="name-input"\n          name="name" \n          value="').concat(e.name,'" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.name?"true":"false",'"\n          aria-describedby="').concat(t.name?"name-error":"",'"\n          autocomplete="name"\n          required\n        />\n        ').concat(t.name?'<div id="name-error" class="error" role="alert">'.concat(t.name,"</div>"):"",'\n      </div>\n      \n      <div class="form-group">\n        <label for="email-input" class="required">Email Address</label>\n        <input \n          type="email" \n          id="email-input"\n          name="email" \n          value="').concat(e.email,'" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.email?"true":"false",'"\n          aria-describedby="').concat(t.email?"email-error":"",'"\n          autocomplete="email"\n          required\n        />\n        ').concat(t.email?'<div id="email-error" class="error" role="alert">'.concat(t.email,"</div>"):"",'\n      </div>\n      \n      <div class="form-group">\n        <label for="phone-input" class="required">Phone Number</label>\n        <input \n          type="tel" \n          id="phone-input"\n          name="phone" \n          value="').concat(e.phone,'" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.phone?"true":"false",'"\n          aria-describedby="').concat(t.phone?"phone-error":"",'"\n          autocomplete="tel"\n          required\n        />\n        ').concat(t.phone?'<div id="phone-error" class="error" role="alert">'.concat(t.phone,"</div>"):"",'\n      </div>\n      \n      <div class="form-group">\n        <label for="address-input" class="required">Address</label>\n        <input \n          type="text" \n          id="address-input"\n          name="address" \n          value="').concat(e.address,'" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.address?"true":"false",'"\n          aria-describedby="').concat(t.address?"address-error":"",'"\n          autocomplete="street-address"\n          required\n        />\n        ').concat(t.address?'<div id="address-error" class="error" role="alert">'.concat(t.address,"</div>"):"",'\n      </div>\n      \n      <h3 id="platform-verification-heading">\n        Platform Verification\n        ').concat(g("Providing a platform profile helps verify your identity and may improve your trust score."),'\n      </h3>\n      \n      <div \n        class="platform-verification-section" \n        aria-labelledby="platform-verification-heading"\n      >\n        <div class="form-group">\n          <label for="airbnb-input">Airbnb Profile Link (Optional)</label>\n          <input \n            type="url" \n            id="airbnb-input"\n            name="airbnbProfile" \n            value="').concat(e.airbnbProfile,'" \n            placeholder="https://www.airbnb.com/users/show/123456789"\n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-describedby="airbnb-desc"\n          />\n          <div id="airbnb-desc" class="field-description">\n            Providing a profile helps with verification\n          </div>\n        </div>\n  \n        <div class="form-group">\n          <label for="vrbo-input">Vrbo Profile Link (Optional)</label>\n          <input \n            type="url" \n            id="vrbo-input"\n            name="vrboProfile" \n            value="').concat(e.vrboProfile,'" \n            placeholder="https://www.vrbo.com/user/12345abcde"\n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-describedby="vrbo-desc"\n          />\n          <div id="vrbo-desc" class="field-description">\n            You can provide Vrbo profile instead of Airbnb\n          </div>\n        </div>\n  \n        <div class="form-group">\n          <label for="other-platform-select">Other Platform Profile (Optional)</label>\n          <div \n            class="input-group" \n            style="display: flex; gap: 10px;"\n          >\n            <select\n              id="other-platform-select"\n              name="otherPlatformType"\n              value="').concat(e.otherPlatformType,'"\n              onchange="this.getRootNode().host.handleInputChange(event)"\n              style="flex: 1"\n              aria-label="Select other platform type"\n            >\n              <option value="">Select platform</option>\n              <option value="booking" ').concat("booking"===e.otherPlatformType?"selected":"",'>Booking.com</option>\n              <option value="tripadvisor" ').concat("tripadvisor"===e.otherPlatformType?"selected":"",'>TripAdvisor</option>\n              <option value="homeaway" ').concat("homeaway"===e.otherPlatformType?"selected":"",'>HomeAway</option>\n              <option value="other" ').concat("other"===e.otherPlatformType?"selected":"",'>Other</option>\n            </select>\n            \n            <input\n              type="url"\n              id="other-platform-input"\n              name="otherPlatformProfile"\n              value="').concat(e.otherPlatformProfile,'"\n              placeholder="https://example.com/profile/123"\n              onchange="this.getRootNode().host.handleInputChange(event)"\n              style="flex: 2"\n              aria-label="Other platform profile URL"\n            />\n          </div>\n          <div id="other-platform-desc" class="field-description">\n            You can provide a profile from any other travel platform\n          </div>\n        </div>\n      </div>\n      \n      ').concat(e.airbnbProfile||e.vrboProfile||e.otherPlatformProfile?"":'\n        <div class="verification-options">\n          <button \n            onclick="this.getRootNode().host.toggleScreenshotUpload(true)" \n            class="success"\n            style="margin-bottom: 15px"\n            aria-expanded="'.concat(r?"true":"false",'"\n            aria-controls="screenshot-section"\n          >\n            Verify with Account Screenshot\n          </button>\n          \n          ').concat((l=d,l?'\n    <div \n      class="alert alert-info" \n      role="region" \n      aria-labelledby="bg-check-heading"\n    >\n      <div>\n        <h3 id="bg-check-heading">Background Check Information</h3>\n        <p>\n          Background checks are only used to verify your identity and include only:\n        </p>\n        <ul>\n          <li>National Criminal Database (recent, relevant crimes only)</li>\n          <li>Sex Offender Registry</li>\n          <li>Global Watchlist (OFAC/Sanctions)</li>\n        </ul>\n        <p>\n          We never share specific personal information with hosts - only a "meets standards" verification.\n        </p>\n      </div>\n    </div>\n  ':""),'\n          \n          <div class="checkbox-container">\n            <input \n              type="checkbox" \n              id="bg-check-consent"\n              name="consentToBackgroundCheck" \n              ').concat(e.consentToBackgroundCheck?"checked":"",' \n              onchange="this.getRootNode().host.handleInputChange(event)"\n              aria-describedby="bg-check-desc"\n            />\n            <label for="bg-check-consent" class="checkbox-label">\n              I consent to a background check to verify my identity. \n              This is necessary if you don\'t provide any platform profile links.\n              ').concat(g("Background checks only verify your identity. Only a pass/fail result is stored, never your personal details."),'\n            </label>\n            <div id="bg-check-desc" class="field-description sr-only">\n              Check this box to consent to a background check for identity verification\n            </div>\n          </div>\n        </div>\n      '),"\n      \n      ").concat(t.verification?'<div class="error" role="alert">'.concat(t.verification,"</div>"):"","\n      \n      ").concat(u,"\n    </div>\n  ")}(this.formData,this.errors,this.userIdentification,this.showScreenshotUpload,this.screenshotData,this.verificationStatus);case 1:return e=this.formData,t=this.errors,'\n    <div class="form-section" role="form" aria-labelledby="booking-info-heading">\n      <h2 id="booking-info-heading">Booking Information</h2>\n      \n      <div style="margin-bottom: 15px;">\n        <label for="platform-select">Platform used*</label>\n        <select \n          id="platform-select"\n          name="platform" \n          value="'.concat(e.platform,'" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.platform?"true":"false",'"\n          aria-describedby="').concat(t.platform?"platform-error":"",'"\n        >\n          <option value="">Select platform</option>\n          <option value="Airbnb" ').concat("Airbnb"===e.platform?"selected":"",'>Airbnb</option>\n          <option value="Vrbo" ').concat("Vrbo"===e.platform?"selected":"",'>Vrbo</option>\n          <option value="Booking.com" ').concat("Booking.com"===e.platform?"selected":"",'>Booking.com</option>\n          <option value="Other" ').concat("Other"===e.platform?"selected":"",">Other</option>\n        </select>\n        ").concat(t.platform?'<p id="platform-error" class="error" role="alert">'.concat(t.platform,"</p>"):"",'\n      </div>\n      \n      <div style="margin-bottom: 15px;">\n        <label for="listing-input">STR Listing Link*\n          ').concat(g("Provide the exact URL of your booking to verify it's legitimate."),'\n        </label>\n        <input \n          type="url" \n          id="listing-input"\n          name="listingLink" \n          value="').concat(e.listingLink,'" \n          placeholder="https://www.example.com/listing/123" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.listingLink?"true":"false",'"\n          aria-describedby="').concat(t.listingLink?"listing-error":"",'"\n        />\n        ').concat(t.listingLink?'<p id="listing-error" class="error" role="alert">'.concat(t.listingLink,"</p>"):"",'\n        <p style="font-size: 12px; color: #666;">This link verifies your booking is real</p>\n      </div>\n      \n      <div style="display: flex; gap: 15px; margin-bottom: 15px;">\n        <div style="flex: 1;">\n          <label for="checkin-input">Check-in Date*</label>\n          <input \n            type="date" \n            id="checkin-input"\n            name="checkInDate" \n            value="').concat(e.checkInDate,'" \n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-required="true"\n            aria-invalid="').concat(t.checkInDate?"true":"false",'"\n            aria-describedby="').concat(t.checkInDate?"checkin-error":"",'"\n          />\n          ').concat(t.checkInDate?'<p id="checkin-error" class="error" role="alert">'.concat(t.checkInDate,"</p>"):"",'\n        </div>\n        \n        <div style="flex: 1;">\n          <label for="checkout-input">Check-out Date*</label>\n          <input \n            type="date" \n            id="checkout-input"\n            name="checkOutDate" \n            value="').concat(e.checkOutDate,'" \n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-required="true"\n            aria-invalid="').concat(t.checkOutDate?"true":"false",'"\n            aria-describedby="').concat(t.checkOutDate?"checkout-error":"",'"\n          />\n          ').concat(t.checkOutDate?'<p id="checkout-error" class="error" role="alert">'.concat(t.checkOutDate,"</p>"):"","\n        </div>\n      </div>\n    </div>\n  ");case 2:return function(e,t){return'\n    <div \n      id="step-content-2"\n      class="form-section" \n      role="form" \n      aria-labelledby="stay-intent-heading"\n    >\n      <h2 id="stay-intent-heading">Stay Intent & Group Profile</h2>\n      \n      <div class="form-group">\n        <label for="purpose-select" class="required">\n          What is the primary purpose of your stay?\n          '.concat(g("This helps hosts understand why you're traveling."),'\n        </label>\n        <select \n          id="purpose-select"\n          name="stayPurpose" \n          value="').concat(e.stayPurpose,'" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.stayPurpose?"true":"false",'"\n          aria-describedby="').concat(t.stayPurpose?"purpose-error":"purpose-desc",'"\n          required\n        >\n          <option value="">Select purpose</option>\n          <option value="Business" ').concat("Business"===e.stayPurpose?"selected":"",'>Business</option>\n          <option value="Family Visit" ').concat("Family Visit"===e.stayPurpose?"selected":"",'>Family Visit</option>\n          <option value="Vacation" ').concat("Vacation"===e.stayPurpose?"selected":"",'>Vacation</option>\n          <option value="Special Occasion" ').concat("Special Occasion"===e.stayPurpose?"selected":"",'>Special Occasion</option>\n          <option value="Relocation" ').concat("Relocation"===e.stayPurpose?"selected":"",'>Relocation</option>\n          <option value="Medical Stay" ').concat("Medical Stay"===e.stayPurpose?"selected":"",'>Medical Stay</option>\n          <option value="Other" ').concat("Other"===e.stayPurpose?"selected":"",'>Other</option>\n        </select>\n        <div id="purpose-desc" class="field-description sr-only">\n          Select the main reason for your stay from the options\n        </div>\n        ').concat(t.stayPurpose?'<div id="purpose-error" class="error" role="alert">'.concat(t.stayPurpose,"</div>"):"","\n      </div>\n      \n      ").concat("Other"===e.stayPurpose?'\n        <div class="form-group">\n          <label for="other-purpose-input" class="required">Please specify</label>\n          <input \n            type="text" \n            id="other-purpose-input"\n            name="otherPurpose" \n            value="'.concat(e.otherPurpose,'" \n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-required="true"\n            aria-invalid="').concat(t.otherPurpose?"true":"false",'"\n            aria-describedby="').concat(t.otherPurpose?"other-purpose-error":"",'"\n            required\n          />\n          ').concat(t.otherPurpose?'<div id="other-purpose-error" class="error" role="alert">'.concat(t.otherPurpose,"</div>"):"","\n        </div>\n      "):"",'\n      \n      <div class="form-group">\n        <label for="guests-input" class="required">How many total guests will stay?</label>\n        <input \n          type="number" \n          id="guests-input"\n          name="totalGuests" \n          value="').concat(e.totalGuests,'" \n          min="1" \n          max="20" \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.totalGuests?"true":"false",'"\n          aria-describedby="').concat(t.totalGuests?"guests-error":"guests-desc",'"\n          required\n        />\n        <div id="guests-desc" class="field-description sr-only">\n          Enter a number between 1 and 20\n        </div>\n        ').concat(t.totalGuests?'<div id="guests-error" class="error" role="alert">'.concat(t.totalGuests,"</div>"):"",'\n      </div>\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="children-checkbox"\n          name="childrenUnder12" \n          ').concat(e.childrenUnder12?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-describedby="children-desc"\n        />\n        <label for="children-checkbox" class="checkbox-label">\n          Are there any children under 12?\n          ').concat(g("Having children in your group may positively affect your trust score."),'\n        </label>\n        <div id="children-desc" class="field-description sr-only">\n          Check this box if your group includes children under 12 years old\n        </div>\n      </div>\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="non-overnight-checkbox"\n          name="nonOvernightGuests" \n          ').concat(e.nonOvernightGuests?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-describedby="non-overnight-desc"\n        />\n        <label for="non-overnight-checkbox" class="checkbox-label">\n          Will any guests not be staying overnight?\n          ').concat(g("This helps hosts understand if additional visitors may be present during the day."),'\n        </label>\n        <div id="non-overnight-desc" class="field-description sr-only">\n          Check this box if additional people will visit but not stay overnight\n        </div>\n      </div>\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="local-travel-checkbox"\n          name="travelingNearHome" \n          ').concat(e.travelingNearHome?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-describedby="local-travel-desc"\n        />\n        <label for="local-travel-checkbox" class="checkbox-label">\n          Are you traveling within 20 miles of your home?\n          ').concat(g("Local bookings may require additional context for verification."),'\n        </label>\n        <div id="local-travel-desc" class="field-description sr-only">\n          Check this box if your stay is within 20 miles of your primary residence\n        </div>\n      </div>\n      \n      ').concat(e.travelingNearHome?'\n        <div class="form-group nested-field">\n          <label for="zipcode-input" class="required">ZIP code</label>\n          <input \n            type="text" \n            id="zipcode-input"\n            name="zipCode" \n            value="'.concat(e.zipCode,'" \n            placeholder="Enter your ZIP code" \n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-required="').concat(e.travelingNearHome?"true":"false",'"\n            aria-invalid="').concat(t.zipCode?"true":"false",'"\n            aria-describedby="').concat(t.zipCode?"zipcode-error":"",'"\n            autocomplete="postal-code"\n            pattern="[0-9]{5}(-[0-9]{4})?"\n            ').concat(e.travelingNearHome?"required":"","\n          />\n          ").concat(t.zipCode?'<div id="zipcode-error" class="error" role="alert">'.concat(t.zipCode,"</div>"):"","\n        </div>\n      "):"",'\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="used-str-checkbox"\n          name="usedSTRBefore" \n          ').concat(e.usedSTRBefore?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-describedby="used-str-desc"\n        />\n        <label for="used-str-checkbox" class="checkbox-label">\n          Have you used short-term rentals before?\n          ').concat(g("Prior rental experience may positively impact your trust score."),'\n        </label>\n        <div id="used-str-desc" class="field-description sr-only">\n          Check this box if you have previously stayed at a short-term rental\n        </div>\n      </div>\n      \n      ').concat(e.usedSTRBefore?'\n        <div class="form-group nested-field">\n          <label for="previous-stays-input">Optional: Previous stay links</label>\n          <textarea \n            id="previous-stays-input"\n            name="previousStayLinks" \n            placeholder="Enter links to previous stays (optional)" \n            rows="2"\n            onchange="this.getRootNode().host.handleInputChange(event)"\n            aria-describedby="previous-stays-desc"\n          >'.concat(e.previousStayLinks,'</textarea>\n          <div id="previous-stays-desc" class="field-description">\n            Providing links to previous stays can improve your trust score\n          </div>\n        </div>\n      '):"","\n    </div>\n  ")}(this.formData,this.errors);case 3:return function(e,t){return'\n    <div class="form-section" role="form" aria-labelledby="agreement-heading">\n      <h2 id="agreement-heading">Agreement Acknowledgement</h2>\n      \n      <div class="alert alert-info">\n        <p>\n          These acknowledgements help ensure positive experiences for both guests and hosts.\n          Your agreement to these terms is part of the CASL Key trust verification process.\n        </p>\n      </div>\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="rules-checkbox"\n          name="agreeToRules" \n          '.concat(e.agreeToRules?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.agreeToRules?"true":"false",'"\n          aria-describedby="').concat(t.agreeToRules?"rules-error":"",'"\n        />\n        <label for="rules-checkbox" class="checkbox-label">\n          I agree to follow quiet hours and property rules*\n          ').concat(g("Following property-specific rules helps maintain great relationships with hosts and neighbors."),"\n        </label>\n        ").concat(t.agreeToRules?'<p id="rules-error" class="error" role="alert">'.concat(t.agreeToRules,"</p>"):"",'\n      </div>\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="parties-checkbox"\n          name="agreeNoParties" \n          ').concat(e.agreeNoParties?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.agreeNoParties?"true":"false",'"\n          aria-describedby="').concat(t.agreeNoParties?"parties-error":"",'"\n        />\n        <label for="parties-checkbox" class="checkbox-label">\n          I agree not to host unauthorized gatherings or events*\n          ').concat(g("Always discuss any gathering plans with your host in advance."),"\n        </label>\n        ").concat(t.agreeNoParties?'<p id="parties-error" class="error" role="alert">'.concat(t.agreeNoParties,"</p>"):"",'\n      </div>\n      \n      <div class="checkbox-container">\n        <input \n          type="checkbox" \n          id="flagging-checkbox"\n          name="understandFlagging" \n          ').concat(e.understandFlagging?"checked":"",' \n          onchange="this.getRootNode().host.handleInputChange(event)"\n          aria-required="true"\n          aria-invalid="').concat(t.understandFlagging?"true":"false",'"\n          aria-describedby="').concat(t.understandFlagging?"flagging-error":"",'"\n        />\n        <label for="flagging-checkbox" class="checkbox-label">\n          I understand that following the community standards helps maintain my CASL Key verification status*\n          ').concat(g("CASL Key aims to create a trusted network of verified guests and hosts. Complying with platform standards keeps your verification active."),"\n        </label>\n        ").concat(t.understandFlagging?'<p id="flagging-error" class="error" role="alert">'.concat(t.understandFlagging,"</p>"):"",'\n      </div>\n      \n      <div style="margin-top: 20px; padding: 15px; background-color: #f9f9f9; border-radius: 8px;">\n        <h3>Privacy & Fair Housing Statement</h3>\n        <p>\n          CASL Key is committed to equal opportunity housing. We do not discriminate based on race, color, \n          national origin, religion, sex, familial status, disability, or any other protected characteristic.\n        </p>\n        <p>\n          Your verification information is used solely to establish trust. Hosts will only see your \n          verification status - never your personal details.\n        </p>\n      </div>\n    </div>\n  ')}(this.formData,this.errors);default:return""}var e,t}},{key:"renderResults",value:function(){return e=this.userIdentification,t=this.trustLevel,n=this.score,r=this.message,o=this.adjustments,i=f[t]||{badgeColor:"#4CAF50",icon:"‚úÖ",label:"Verified"},'\n    <div class="results-container" role="region" aria-labelledby="results-heading">\n      <h1 id="results-heading">CASL Key Verification Result</h1>\n      \n      <div \n        class="result-card" \n        aria-live="polite"\n      >\n        <div class="result-header">\n          <h2>CASL Key ID: '.concat(e.caslKeyId||"Not Assigned",'</h2>\n        </div>\n        \n        <div \n          class="trust-badge" \n          style="background-color: ').concat(i.badgeColor,'"\n          aria-label="Trust level: ').concat(i.label,'"\n        >\n          <span aria-hidden="true">').concat(i.icon," ").concat(i.label,'</span>\n        </div>\n        \n        <div \n          class="score-display" \n          aria-label="Trust score: ').concat(n,' out of 100"\n        >\n          <span class="score-number">').concat(n,'</span>\n          <span class="score-max">/100</span>\n        </div>\n        \n        <p \n          class="result-message" \n          aria-live="polite"\n        >\n          ').concat(r,'\n        </p>\n        \n        <div \n          class="adjustments-list" \n          aria-labelledby="score-factors-heading"\n        >\n          <h3 id="score-factors-heading">Score Factors</h3>\n          \n          ').concat(o&&o.length>0?"\n            <div>\n              ".concat(o.map((function(e){return'\n                <div \n                  class="adjustment-item" \n                  aria-label="'.concat(e.reason,": ").concat(e.points>0?"plus":"minus"," ").concat(Math.abs(e.points),' points"\n                >\n                  <span>').concat(e.reason,'</span>\n                  <span \n                    class="adjustment-points ').concat(e.points>0?"adjustment-positive":"adjustment-negative",'"\n                    aria-hidden="true"\n                  >\n                    ').concat(e.points>0?"+":"").concat(e.points,"\n                  </span>\n                </div>\n              ")})).join(""),"\n            </div>\n          "):'\n            <p style="color: #666">No score adjustments applied.</p>\n          ','\n        </div>\n        \n        <div class="trust-badge-info" style="margin-top: 30px;">\n          <h3>Trust Badge Information</h3>\n          <p>\n            Your trust badge is valid for 12 months. Future hosts will see your verification status, \n            but never your personal details.\n          </p>\n        </div>\n        \n        <div class="action-buttons" style="display: flex; justify-content: center; gap: 15px; margin-top: 30px">\n          <button \n            onclick="this.getRootNode().host.handleReset()" \n            aria-label="Start over with a new verification"\n          >\n            Start Over\n          </button>\n          \n          <button \n            onclick="this.getRootNode().host.printResults()" \n            aria-label="Print verification results"\n            class="neutral"\n          >\n            Print Results\n          </button>\n        </div>\n      </div>\n    </div>\n  ');var e,t,n,r,o,i}},{key:"announceStatusChanges",value:function(){if(this.firstRender)B.announce("This form has multiple steps. Required fields are marked with an asterisk. Use the Next and Previous buttons to navigate between steps.","polite");else if(this.isLoading){var e=0===this.currentStep?"verification status":3===this.currentStep?"submission":"data";B.announce(function(e){return"Loading ".concat(e||"content",". Please wait.")}(e),"polite")}else this.apiError?B.announce(this.apiError,"assertive"):this.submitted?B.announce(se(this.userIdentification.caslKeyId,this.score,this.trustLevel?p[this.trustLevel]:"Unknown"),"polite"):this.errors&&Object.keys(this.errors).length>0&&B.announce(ae(Object.keys(this.errors).length),"assertive")}},{key:"handleInputChange",value:function(e){var t=this;performance.mark("input_change_start");var n=e.target,r=n.name,o=n.value,i=n.type,a=n.checked,s="checkbox"===i?a:o,c=Pt({},this.formData);c[r]=s,"stayPurpose"===r&&"Other"!==o&&(c.otherPurpose=""),"travelingNearHome"!==r||a||(c.zipCode=""),I.updateFormData(c),"text"===i||"email"===i||"tel"===i||"url"===i?(clearTimeout(this._validationTimer),this._validationTimer=setTimeout((function(){t.validateForm(),t.render()}),300)):this.validateForm(),"consentToBackgroundCheck"===r&&a&&(this.updateTrustPreview(),B.announce("Background check consent provided. This will be used for identity verification.","polite")),performance.mark("input_change_end"),performance.measure("input_change","input_change_start","input_change_end")}},{key:"handleLanguageChange",value:function(e){var t=e.target.value;qe.changeLanguage(t);var n=qe.getLanguageInfo(t);n&&B.announce("Language changed to ".concat(n.name),"polite")}},{key:"toggleScreenshotUpload",value:function(e){this.showScreenshotUpload=e,e&&B.announce("Screenshot upload section opened. You can upload a profile screenshot for verification.","polite"),this.render()}},{key:"toggleVerificationMethods",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.showVerificationMethods=e,this.selectedVerificationMethod=null,e?B.announce("Additional verification methods available. Choose a method to continue.","polite"):B.announce("Returning to main verification form.","polite"),this.render()}},{key:"selectVerificationMethod",value:function(e){$e.reset(),it.reset(),ft.reset(),this.selectedVerificationMethod=e,B.announce("Selected ".concat(e," verification method. Follow the instructions to complete verification."),"polite"),this.render()}},{key:"compressImage",value:(S=At(Tt().mark((function e(t){var n,r,o=arguments;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:1200,r=o.length>2&&void 0!==o[2]?o[2]:.8,e.abrupt("return",new Promise((function(e,o){if(t.length<1e5)e(t);else{var i=new Image;i.onload=function(){var t=i.width,o=i.height;t>n&&(o=o*n/t,t=n);var a=document.createElement("canvas");a.width=t,a.height=o,a.getContext("2d").drawImage(i,0,0,t,o),e(a.toDataURL("image/jpeg",r))},i.onerror=o,i.src=t}})));case 3:case"end":return e.stop()}}),e)}))),function(e){return S.apply(this,arguments)})},{key:"handleScreenshotUpload",value:(k=At(Tt().mark((function e(t){var n,r,o,i=this;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(performance.mark("screenshot_upload_start"),n=t.target.files[0]){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,M.getAllowedImageTypes().includes(n.type)){e.next=8;break}throw D.createValidationError(ze("errors.invalidImageType"));case 8:if(r=M.get("MAX_SCREENSHOT_SIZE"),!(n.size>r)){e.next=11;break}throw D.createValidationError(ze("errors.imageTooLarge",{size:Math.floor(r/1048576)}));case 11:(o=new FileReader).onload=function(){var e=At(Tt().mark((function e(t){var n;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i.compressImage(t.target.result);case 3:n=e.sent,i.screenshotData=n,B.announce("Screenshot uploaded successfully. Processing for verification.","polite"),i.render(),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.warn("Image compression failed, using original:",e.t0),i.screenshotData=t.target.result,i.render();case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),o.readAsDataURL(n),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(4),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Error uploading screenshot: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 21:performance.mark("screenshot_upload_end"),performance.measure("screenshot_upload","screenshot_upload_start","screenshot_upload_end");case 23:case"end":return e.stop()}}),e,null,[[4,16]])}))),function(e){return k.apply(this,arguments)})},{key:"handleDragOver",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.shadowRoot.getElementById("screenshot-dropzone");t&&(t.classList.add("drag-over"),t.setAttribute("aria-dropeffect","copy"))}},{key:"handleDragLeave",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.shadowRoot.getElementById("screenshot-dropzone");t&&(t.classList.remove("drag-over"),t.setAttribute("aria-dropeffect","none"))}},{key:"handleDrop",value:function(e){e.preventDefault(),e.stopPropagation();var t=this.shadowRoot.getElementById("screenshot-dropzone");t&&(t.classList.remove("drag-over"),t.setAttribute("aria-dropeffect","none"));var n=e.dataTransfer.files[0];n&&this.handleScreenshotUpload({target:{files:[n]}})}},{key:"clearScreenshot",value:function(){this.screenshotData=null,B.announce("Screenshot has been removed.","polite"),this.render()}},{key:"uploadScreenshot",value:(x=At(Tt().mark((function e(){var t;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(performance.mark("screenshot_api_start"),zt.startTimer("api_screenshot_upload"),this.screenshotData){e.next=6;break}return I.showAlert(ze("errors.noScreenshot")),B.announce(ze("errors.noScreenshot"),"assertive"),e.abrupt("return",!1);case 6:return I.setLoading(!0),this.verificationStatus=a,B.announce("Processing your screenshot. This may take a minute.","polite"),this.render(),e.prev=10,t=this.userIdentification.caslKeyId||"user_".concat(Date.now()),e.next=14,De.uploadScreenshot(this.screenshotData,t);case 14:return e.sent,this.startVerificationStatusPolling(t),e.abrupt("return",!0);case 19:return e.prev=19,e.t0=e.catch(10),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Error uploading screenshot: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive"),I.setLoading(!1),e.abrupt("return",!1);case 26:return e.prev=26,zt.endTimer("api_screenshot_upload"),performance.mark("screenshot_api_end"),performance.measure("screenshot_api","screenshot_api_start","screenshot_api_end"),e.finish(26);case 31:case"end":return e.stop()}}),e,this,[[10,19,26,31]])}))),function(){return x.apply(this,arguments)})},{key:"startVerificationStatusPolling",value:function(e){var t=this;this._verificationPollInterval&&clearInterval(this._verificationPollInterval);var n=M.get("VERIFICATION_POLL_INTERVAL",3e3);this._verificationPollInterval=setInterval(At(Tt().mark((function n(){var r;return Tt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return zt.startTimer("api_status_check"),n.prev=1,n.next=4,De.checkVerificationStatus(e);case 4:r=n.sent,t.verificationStatus=r.status,r.status!==a&&(clearInterval(t._verificationPollInterval),t._verificationPollInterval=null,I.setLoading(!1),r.status===s?(I.setVerification(Pt(Pt({},t.userIdentification),{},{isVerified:!0,verificationType:"screenshot",platformData:r.verificationDetails||null})),t.updateTrustPreview(),B.announce("Your account has been successfully verified!","polite")):r.status===c?B.announce(ze("accessibility.manualReviewRequired"),"polite"):B.announce(ze("accessibility.verificationFailed"),"assertive")),n.next=17;break;case 9:n.prev=9,n.t0=n.catch(1),D.handleError(n.t0),clearInterval(t._verificationPollInterval),t._verificationPollInterval=null,I.showAlert(D.getUserFriendlyMessage(n.t0)),B.announce("Error checking verification status: ".concat(D.getUserFriendlyMessage(n.t0)),"assertive"),I.setLoading(!1);case 17:return n.prev=17,zt.endTimer("api_status_check"),n.finish(17);case 20:case"end":return n.stop()}}),n,null,[[1,9,17,20]])}))),n)}},{key:"updateTrustPreview",value:function(){var e="".concat(this.formData.travelingNearHome,"_").concat(this.formData.totalGuests,"_").concat(this.formData.usedSTRBefore,"_").concat(!!this.userIdentification.backgroundCheckStatus);if(this._trustPreviewCache&&this._trustPreviewCache[e])this.trustPreview=this._trustPreviewCache[e];else{var t=xt(this.formData,this.userIdentification),n=St(t.score),r={caslKeyId:this.userIdentification.caslKeyId||"Pending",trustLevel:n,scoreRange:t.score>=85?"85-100":t.score>=70?"70-84":t.score>=50?"50-69":"Below 50",flags:{localBooking:this.formData.travelingNearHome||!1,highGuestCount:this.formData.totalGuests>5||!1,noSTRHistory:!this.formData.usedSTRBefore||!1,lastMinuteBooking:!1}};this._trustPreviewCache||(this._trustPreviewCache={}),this._trustPreviewCache[e]=r,this.saveTrustPreview(r),this.trustPreview=r}}},{key:"loadTrustPreview",value:function(){try{var e="".concat(M.get("STORAGE_PREFIX","casl_"),"trust_preview"),t=localStorage.getItem(e);return t&&(this.trustPreview=JSON.parse(t)),this.trustPreview}catch(e){return console.error("Error loading trust preview:",e),null}}},{key:"saveTrustPreview",value:function(e){try{var t="".concat(M.get("STORAGE_PREFIX","casl_"),"trust_preview");localStorage.setItem(t,JSON.stringify(e)),this.trustPreview=e}catch(e){console.error("Error saving trust preview:",e)}}},{key:"validateForm",value:function(){zt.startTimer("validation");var e,t,n={};switch(this.currentStep){case 0:n=function(e,t,n){var r={name:"",email:"",phone:"",address:"",verification:""};e.name.trim()||(r.name="Name is required"),e.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(r.email="Please enter a valid email address"):r.email="Email is required",e.phone.trim()?/^[\d\s\+\-\(\)]{10,15}$/.test(e.phone.replace(/\s/g,""))||(r.phone="Please enter a valid phone number"):r.phone="Phone number is required",e.address.trim()||(r.address="Address is required");var o=!!(e.airbnbProfile.trim()||e.vrboProfile.trim()||e.otherPlatformProfile.trim()),i=t.isVerified||n===s||n===c;return o||e.consentToBackgroundCheck||i||(r.verification="Either a platform profile, screenshot verification, or consent to background check is required"),r}(this.formData,this.userIdentification,this.verificationStatus);break;case 1:n=function(e){var t={platform:"",listingLink:"",checkInDate:"",checkOutDate:""};if(e.platform||(t.platform="Please select a platform"),e.listingLink.trim()?/^https?:\/\/.+/.test(e.listingLink)||(t.listingLink="Please enter a valid URL beginning with http:// or https://"):t.listingLink="Listing link is required",e.checkInDate||(t.checkInDate="Check-in date is required"),e.checkOutDate||(t.checkOutDate="Check-out date is required"),e.checkInDate&&e.checkOutDate){var n=new Date(e.checkInDate);new Date(e.checkOutDate)<=n&&(t.checkOutDate="Check-out date must be after check-in date")}return t}(this.formData);break;case 2:t={stayPurpose:"",otherPurpose:"",totalGuests:"",zipCode:""},(e=this.formData).stayPurpose||(t.stayPurpose="Please select a purpose"),"Other"!==e.stayPurpose||e.otherPurpose.trim()||(t.otherPurpose="Please specify your purpose"),e.totalGuests<1?t.totalGuests="At least 1 guest is required":e.totalGuests>20&&(t.totalGuests="Maximum 20 guests allowed"),e.travelingNearHome&&!e.zipCode.trim()&&(t.zipCode="ZIP code is required when staying near home"),n=t;break;case 3:n=function(e){var t={agreeToRules:"",agreeNoParties:"",understandFlagging:""};return e.agreeToRules||(t.agreeToRules="You must agree to follow property rules"),e.agreeNoParties||(t.agreeNoParties="You must agree to the no unauthorized parties policy"),e.understandFlagging||(t.understandFlagging="You must acknowledge the terms policy"),t}(this.formData)}JSON.stringify(this.errors)!==JSON.stringify(n)&&(this.errors=n,this.isFormValid=function(e){return Object.values(e).every((function(e){return!e}))}(n)),zt.endTimer("validation")}},{key:"handleNextStep",value:(w=At(Tt().mark((function e(){var t;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(performance.mark("navigation_next_start"),zt.startTimer("next_step"),this.isFormValid){e.next=7;break}return B.announce(ae(Object.keys(this.errors).length),"assertive"),this.focusFirstError(),zt.endTimer("next_step"),e.abrupt("return");case 7:if(this.uxMetrics.formStarted||(this.uxMetrics.formStarted=!0),this.uxMetrics.stepsCompleted.has(this.currentStep)||(this.uxMetrics.stepsCompleted.add(this.currentStep),t=performance.now()-(this.uxMetrics.lastStepTime||this.uxMetrics.startTime),console.info("Step ".concat(this.currentStep," completion time: ").concat(t.toFixed(2),"ms"))),this.uxMetrics.lastStepTime=performance.now(),0!==this.currentStep){e.next=28;break}if(!this.showScreenshotUpload||!this.screenshotData||this.verificationStatus===s||this.verificationStatus===c){e.next=18;break}return e.next=14,this.uploadScreenshot();case 14:if(e.sent){e.next=18;break}return zt.endTimer("next_step"),e.abrupt("return");case 18:return e.next=20,this.handleCheckUser();case 20:if(e.sent){e.next=24;break}return zt.endTimer("next_step"),e.abrupt("return");case 24:if(!this.formData.consentToBackgroundCheck||this.userIdentification.backgroundCheckStatus){e.next=27;break}return e.next=27,this.initiateBackgroundCheck();case 27:this.updateTrustPreview();case 28:this.currentStep<p.length-1?(this.currentStep+=1,I.updateFormData(Pt(Pt({},this.formData),{},{currentStep:this.currentStep})),this.validateForm(),B.announce(ie(this.currentStep+1,p.length),"polite")):this.handleSubmit(),zt.endTimer("next_step"),performance.mark("navigation_next_end"),performance.measure("navigation_next","navigation_next_start","navigation_next_end");case 32:case"end":return e.stop()}}),e,this)}))),function(){return w.apply(this,arguments)})},{key:"focusFirstError",value:function(){var e=this;setTimeout((function(){var t=Object.keys(e.errors);if(t.length>0){var n=t[0],r=e.shadowRoot.querySelector('[name="'.concat(n,'"]'));r&&r.focus()}}),100)}},{key:"handlePreviousStep",value:function(){performance.mark("navigation_prev_start"),this.currentStep>0&&(this.currentStep-=1,I.updateFormData(Pt(Pt({},this.formData),{},{currentStep:this.currentStep})),this.validateForm(),B.announce(ie(this.currentStep+1,p.length),"polite")),performance.mark("navigation_prev_end"),performance.measure("navigation_prev","navigation_prev_start","navigation_prev_end")}},{key:"handleCheckUser",value:(b=At(Tt().mark((function e(){var t,n;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(performance.mark("api_user_check_start"),zt.startTimer("api_user_check"),this.formData.email){e.next=6;break}return I.showAlert(ze("errors.emailRequired")),B.announce(ze("errors.emailRequired"),"assertive"),e.abrupt("return",!1);case 6:return I.setLoading(!0),B.announce("Verifying your information. Please wait.","polite"),e.prev=8,t={email:this.formData.email,name:this.formData.name,phone:this.formData.phone,address:this.formData.address},I.setVerification(Pt(Pt({},this.userIdentification),{},{isChecking:!0,error:null})),e.next=13,De.checkUserStatus(t);case 13:return n=e.sent,(this.verificationStatus===s||this.verificationStatus===c)&&!n.isVerified&&(n.isVerified=!0,n.verificationType="screenshot"),I.setVerification(Pt(Pt({},n),{},{isChecking:!1})),n.isExistingUser?B.announce("Welcome back! We found your existing CASL Key ID: ".concat(n.caslKeyId),"polite"):B.announce("User verification completed successfully.","polite"),e.abrupt("return",!0);case 21:return e.prev=21,e.t0=e.catch(8),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),I.setVerification(Pt(Pt({},this.userIdentification),{},{isChecking:!1,error:e.t0.message||ze("errors.userCheckFailed")})),B.announce("Error checking user: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive"),e.abrupt("return",!1);case 28:return e.prev=28,I.setLoading(!1),zt.endTimer("api_user_check"),performance.mark("api_user_check_end"),performance.measure("api_user_check","api_user_check_start","api_user_check_end"),e.finish(28);case 34:case"end":return e.stop()}}),e,this,[[8,21,28,34]])}))),function(){return b.apply(this,arguments)})},{key:"initiateBackgroundCheck",value:(y=At(Tt().mark((function e(){var t,n;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.formData.consentToBackgroundCheck){e.next=2;break}return e.abrupt("return");case 2:return performance.mark("api_bg_check_start"),zt.startTimer("api_bg_check"),I.setLoading(!0),B.announce("Initiating background check. This may take a moment.","polite"),e.prev=6,t={caslKeyId:this.userIdentification.caslKeyId,name:this.formData.name,email:this.formData.email,phone:this.formData.phone,address:this.formData.address},e.next=10,wt.initiateBackgroundCheck(t);case 10:n=e.sent,I.setVerification(Pt(Pt({},this.userIdentification),{},{backgroundCheckStatus:n.passed?"passed":"failed",isVerified:this.userIdentification.isVerified||n.passed})),n.passed?B.announce("Background check completed successfully.","polite"):B.announce("Background check could not be completed. You may try another verification method.","assertive"),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(6),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Background check error: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 20:return e.prev=20,I.setLoading(!1),zt.endTimer("api_bg_check"),performance.mark("api_bg_check_end"),performance.measure("api_bg_check","api_bg_check_start","api_bg_check_end"),e.finish(20);case 26:case"end":return e.stop()}}),e,this,[[6,15,20,26]])}))),function(){return y.apply(this,arguments)})},{key:"handleIdImageUpload",value:(m=At(Tt().mark((function e(t){var n;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt.startTimer("id_image_upload"),n=t.target.files[0]){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,$e.uploadIdImage(n);case 6:e.sent?B.announce("ID image uploaded successfully.","polite"):(I.showAlert($e.error),B.announce("ID upload error: ".concat($e.error),"assertive")),zt.endTimer("id_image_upload"),this.render();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return m.apply(this,arguments)})},{key:"handleSelfieImageUpload",value:(h=At(Tt().mark((function e(t){var n;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt.startTimer("selfie_image_upload"),n=t.target.files[0]){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,$e.uploadSelfieImage(n);case 6:e.sent?B.announce("Selfie image uploaded successfully.","polite"):(I.showAlert($e.error),B.announce("Selfie upload error: ".concat($e.error),"assertive")),zt.endTimer("selfie_image_upload"),this.render();case 10:case"end":return e.stop()}}),e,this)}))),function(e){return h.apply(this,arguments)})},{key:"clearIdImage",value:function(){$e.idImageData=null,B.announce("ID image removed.","polite"),this.render()}},{key:"clearSelfieImage",value:function(){$e.selfieImageData=null,B.announce("Selfie image removed.","polite"),this.render()}},{key:"verifyGovId",value:(d=At(Tt().mark((function e(t){var n;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return zt.startTimer("api_verify_gov_id"),I.setLoading(!0),B.announce(le("government ID"),"polite"),e.prev=3,e.next=6,$e.verifyId(t);case 6:(n=e.sent)&&"verified"===n.status?(I.setVerification(Pt(Pt({},this.userIdentification),{},{idVerificationData:{verified:!0,method:"government-id",timestamp:(new Date).toISOString()}})),this.updateTrustPreview(),B.announce(ce("government ID"),"polite")):B.announce(ue("government ID"),"assertive"),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(3),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Government ID verification error: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 15:return e.prev=15,I.setLoading(!1),zt.endTimer("api_verify_gov_id"),e.finish(15);case 19:case"end":return e.stop()}}),e,this,[[3,10,15,19]])}))),function(e){return d.apply(this,arguments)})},{key:"requestPhoneVerification",value:(l=At(Tt().mark((function e(t){var n,r;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt.startTimer("api_request_phone_verification"),n=this.shadowRoot.getElementById("phone-input")){e.next=4;break}return e.abrupt("return");case 4:if(r=n.value){e.next=9;break}return I.showAlert(ze("errors.phoneRequired")),B.announce(ze("errors.phoneRequired"),"assertive"),e.abrupt("return");case 9:return I.setLoading(!0),B.announce("Sending verification code to your phone. Please wait.","polite"),e.prev=11,e.next=14,it.requestVerificationCode(r,t);case 14:e.sent?B.announce("Verification code sent to your phone. Please check your messages.","polite"):(I.showAlert(it.error),B.announce("Phone verification error: ".concat(it.error),"assertive")),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(11),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Phone verification error: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 23:return e.prev=23,I.setLoading(!1),zt.endTimer("api_request_phone_verification"),this.render(),e.finish(23);case 28:case"end":return e.stop()}}),e,this,[[11,18,23,28]])}))),function(e){return l.apply(this,arguments)})},{key:"verifyPhoneCode",value:(u=At(Tt().mark((function e(t){var n,r,o;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt.startTimer("api_verify_phone_code"),n=this.shadowRoot.getElementById("verification-code")){e.next=4;break}return e.abrupt("return");case 4:if(r=n.value){e.next=9;break}return I.showAlert(ze("errors.codeRequired")),B.announce(ze("errors.codeRequired"),"assertive"),e.abrupt("return");case 9:return I.setLoading(!0),B.announce("Verifying code. Please wait.","polite"),e.prev=11,e.next=14,it.verifyCode(r,t);case 14:(o=e.sent)&&o.verified?(I.setVerification(Pt(Pt({},this.userIdentification),{},{phoneVerificationData:{verified:!0,phoneNumber:it.phoneNumber,timestamp:(new Date).toISOString()}})),this.updateTrustPreview(),B.announce(ce("phone"),"polite")):it.error&&(I.showAlert(it.error),B.announce("Phone verification error: ".concat(it.error),"assertive")),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(11),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Phone verification error: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 23:return e.prev=23,I.setLoading(!1),zt.endTimer("api_verify_phone_code"),this.render(),e.finish(23);case 28:case"end":return e.stop()}}),e,this,[[11,18,23,28]])}))),function(e){return u.apply(this,arguments)})},{key:"resendVerificationCode",value:(o=At(Tt().mark((function e(t){return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return it.clearTimer(),B.announce("Resending verification code. Please wait.","polite"),e.next=4,this.requestPhoneVerification(t);case 4:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"handleSocialPlatformChange",value:function(e){var t=e.target.value;ft.platform=t,t&&B.announce("Selected platform: ".concat(t),"polite"),this.render()}},{key:"verifySocialProfile",value:(r=At(Tt().mark((function e(t){var n,r,o,i,a;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt.startTimer("api_verify_social_profile"),n=this.shadowRoot.getElementById("social-platform"),r=this.shadowRoot.getElementById("profile-url"),n&&r){e.next=5;break}return e.abrupt("return");case 5:if(o=n.value,i=r.value,o){e.next=11;break}return I.showAlert(ze("errors.platformRequired")),B.announce(ze("errors.platformRequired"),"assertive"),e.abrupt("return");case 11:if(i){e.next=15;break}return I.showAlert(ze("errors.profileUrlRequired")),B.announce(ze("errors.profileUrlRequired"),"assertive"),e.abrupt("return");case 15:return I.setLoading(!0),B.announce(le("social media"),"polite"),e.prev=17,e.next=20,ft.verifySocialProfile(o,i,t);case 20:(a=e.sent)&&"verified"===a.status?(I.setVerification(Pt(Pt({},this.userIdentification),{},{socialVerificationData:{verified:!0,platform:o,profileUrl:i,timestamp:(new Date).toISOString()}})),this.updateTrustPreview(),B.announce(ce("social media"),"polite")):ft.error&&(I.showAlert(ft.error),B.announce("Social verification error: ".concat(ft.error),"assertive")),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(17),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Social verification error: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 29:return e.prev=29,I.setLoading(!1),zt.endTimer("api_verify_social_profile"),this.render(),e.finish(29);case 34:case"end":return e.stop()}}),e,this,[[17,24,29,34]])}))),function(e){return r.apply(this,arguments)})},{key:"handleSubmit",value:(n=At(Tt().mark((function e(){var t,n,r,o,i,a,s,c,u,l,d;return Tt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(performance.mark("form_submit_start"),zt.startTimer("form_submission"),zt.checkMemoryUsage(),this.isFormValid){e.next=7;break}return B.announce(ae(Object.keys(this.errors).length),"assertive"),zt.endTimer("form_submission"),e.abrupt("return");case 7:return I.setLoading(!0),B.announce("Submitting verification information. Please wait.","polite"),t=(performance.now()-this.uxMetrics.startTime)/1e3,n=this.uxMetrics.stepsCompleted.size/p.length,console.info("Form completion time:",t.toFixed(2)+"s","Completion rate:",n),e.prev=12,zt.startTimer("score_calculation"),a=xt(this.formData,this.userIdentification),s=St(a.score),c=Et(s),zt.endTimer("score_calculation"),I.setResults({score:a.score,trustLevel:s,message:c,adjustments:a.adjustments,isSubmitted:!1}),u={caslKeyId:this.userIdentification.caslKeyId,user:{name:this.formData.name,email:this.formData.email,phone:this.formData.phone,address:this.formData.address},verification:{score:a.score,trustLevel:s,verificationType:this.userIdentification.verificationType,backgroundCheckStatus:this.userIdentification.backgroundCheckStatus,idVerificationStatus:(null===(r=this.userIdentification.idVerificationData)||void 0===r?void 0:r.verified)||!1,phoneVerificationStatus:(null===(o=this.userIdentification.phoneVerificationData)||void 0===o?void 0:o.verified)||!1,socialVerificationStatus:(null===(i=this.userIdentification.socialVerificationData)||void 0===i?void 0:i.verified)||!1,adjustments:a.adjustments,verificationDate:(new Date).toISOString()},booking:{platform:this.formData.platform,listingLink:this.formData.listingLink,checkInDate:this.formData.checkInDate,checkOutDate:this.formData.checkOutDate},stayDetails:{purpose:this.formData.stayPurpose,totalGuests:this.formData.totalGuests,childrenUnder12:this.formData.childrenUnder12,nonOvernightGuests:this.formData.nonOvernightGuests,travelingNearHome:this.formData.travelingNearHome,zipCode:this.formData.zipCode,previousExperience:this.formData.usedSTRBefore,previousStayLinks:this.formData.previousStayLinks}},zt.startTimer("host_summary"),l=It(u),zt.endTimer("host_summary"),zt.startTimer("api_submit_verification"),e.next=26,De.submitVerification(Pt(Pt({},u),{},{hostSummary:l}));case 26:zt.endTimer("api_submit_verification"),I.setResults({score:a.score,trustLevel:s,message:c,adjustments:a.adjustments,isSubmitted:!0,hostSummary:l}),this.clearSavedData(),B.announce(se(this.userIdentification.caslKeyId,a.score,s?p[s]:"Unknown"),"polite"),d=new CustomEvent("verificationComplete",{detail:{caslKeyId:this.userIdentification.caslKeyId,score:a.score,trustLevel:s,verificationData:u,hostSummary:l},bubbles:!0,composed:!0}),this.dispatchEvent(d),e.next=39;break;case 34:e.prev=34,e.t0=e.catch(12),D.handleError(e.t0),I.showAlert(D.getUserFriendlyMessage(e.t0)),B.announce("Submission error: ".concat(D.getUserFriendlyMessage(e.t0)),"assertive");case 39:return e.prev=39,I.setLoading(!1),zt.endTimer("form_submission"),performance.mark("form_submit_end"),performance.measure("form_submission","form_submit_start","form_submit_end"),zt.checkMemoryUsage(),e.finish(39);case 46:case"end":return e.stop()}}),e,this,[[12,34,39,46]])}))),function(){return n.apply(this,arguments)})},{key:"printResults",value:function(){var e,t,n;zt.startTimer("print_results");var r=window.open("","_blank");if(!r)return I.showAlert("Please allow pop-ups to print verification"),B.announce("Print failed. Please allow pop-ups in your browser.","assertive"),void zt.endTimer("print_results");var o={caslKeyId:this.userIdentification.caslKeyId,score:this.score,trustLevel:this.trustLevel,message:this.message,adjustments:this.adjustments,verificationDate:(new Date).toISOString()},i=(new Date).toLocaleDateString(),a=this.trustLevel?p[this.trustLevel]:"Unknown";r.document.write('\n     <!DOCTYPE html>\n     <html lang="'.concat(qe.currentLanguage,'">\n     <head>\n       <title>CASL Key Verification - ').concat(o.caslKeyId,'</title>\n       <meta name="viewport" content="width=device-width, initial-scale=1.0">\n       <style>\n         body {\n           font-family: Arial, sans-serif;\n           margin: 2cm;\n           color: #333;\n           line-height: 1.5;\n         }\n         \n         h1, h2, h3, h4 {\n           color: #2c3e50;\n         }\n         \n         .header {\n           text-align: center;\n           margin-bottom: 2em;\n           border-bottom: 1px solid #eee;\n           padding-bottom: 1em;\n         }\n         \n         .logo {\n           font-size: 24px;\n           font-weight: bold;\n         }\n         \n         .verification-id {\n           font-size: 18px;\n           margin: 1em 0;\n         }\n         \n         .verification-date {\n           color: #7f8c8d;\n         }\n         \n         .trust-badge {\n           display: inline-block;\n           padding: 0.5em 1em;\n           border-radius: 4px;\n           color: white;\n           font-weight: bold;\n           margin: 1em 0;\n           background-color: ').concat("verified"===o.trustLevel?"#4CAF50":"review"===o.trustLevel?"#FFC107":"manual_review"===o.trustLevel?"#9E9E9E":"#757575",';\n         }\n         \n         .score {\n           font-size: 24px;\n           margin: 1em 0;\n         }\n         \n         .section {\n           margin: 1.5em 0;\n         }\n         \n         table {\n           width: 100%;\n           border-collapse: collapse;\n           margin: 1em 0;\n         }\n         \n         th, td {\n           padding: 0.5em;\n           text-align: left;\n           border-bottom: 1px solid #eee;\n         }\n         \n         th {\n           width: 30%;\n           font-weight: bold;\n         }\n         \n         .footer {\n           margin-top: 2em;\n           text-align: center;\n           font-size: 14px;\n           color: #7f8c8d;\n         }\n         \n         .verification-link {\n           margin-top: 1em;\n           font-size: 12px;\n         }\n         \n         @media print {\n           body {\n             font-size: 12pt;\n           }\n           \n           button {\n             display: none;\n           }\n         }\n       </style>\n     </head>\n     <body>\n       <div class="header">\n         <div class="logo" role="heading" aria-level="1">CASL Key Verification</div>\n         <div class="verification-id">ID: ').concat(o.caslKeyId,'</div>\n         <div class="verification-date">Verified on ').concat(i,'</div>\n       </div>\n       \n       <div class="section" role="region" aria-labelledby="trust-level-heading">\n         <h2 id="trust-level-heading">Trust Level</h2>\n         <div class="trust-badge">').concat(a,'</div>\n         <div class="score">\n           <span class="score-number">').concat(o.score,'</span>\n           <span class="score-max">/100</span>\n         </div>\n         <p>').concat(o.message,'</p>\n       </div>\n       \n       <div class="section" role="region" aria-labelledby="verification-methods-heading">\n         <h2 id="verification-methods-heading">Verification Methods</h2>\n         <ul>\n           ').concat(this.userIdentification.verificationType?"<li>".concat(this.userIdentification.verificationType," verification</li>"):"","\n           ").concat(this.userIdentification.backgroundCheckStatus?"<li>Background check</li>":"","\n           ").concat(null!==(e=this.userIdentification.idVerificationData)&&void 0!==e&&e.verified?"<li>Government ID verification</li>":"","\n           ").concat(null!==(t=this.userIdentification.phoneVerificationData)&&void 0!==t&&t.verified?"<li>Phone verification</li>":"","\n           ").concat(null!==(n=this.userIdentification.socialVerificationData)&&void 0!==n&&n.verified?"<li>Social media verification</li>":"",'\n         </ul>\n       </div>\n       \n       <div class="section" role="region" aria-labelledby="score-factors-heading">\n         <h2 id="score-factors-heading">Score Factors</h2>\n         ').concat(o.adjustments&&o.adjustments.length>0?"\n           <ul>\n             ".concat(o.adjustments.map((function(e){return'\n               <li class="'.concat(e.points>0?"positive":"negative",'">\n                 ').concat(e.reason," (").concat(e.points>0?"+":"").concat(e.points,")\n               </li>\n             ")})).join(""),"\n           </ul>\n         "):"\n           <p>No score adjustments applied.</p>\n         ",'\n       </div>\n       \n       <div class="footer">\n         <p>This verification certificate was generated by CASL Key Verification System.</p>\n         <p>¬© ').concat((new Date).getFullYear(),' CASL Key Verification</p>\n         <div class="verification-link">\n           Verify this certificate online at: https://casl-key.example.com/verify/').concat(o.caslKeyId,"\n         </div>\n       </div>\n       \n       <script>\n         // Auto-print\n         window.onload = function() {\n           window.print();\n         };\n       <\/script>\n     </body>\n     </html>\n   ")),r.document.close(),B.announce("Verification details opened in new window for printing.","polite"),zt.endTimer("print_results")}},{key:"handleReset",value:function(){performance.mark("form_reset_start"),zt.startTimer("form_reset"),I.resetSection("formData"),I.resetSection("verification"),I.resetSection("results"),I.hideAlert(),$e.reset(),it.reset(),ft.reset(),this.currentStep=0,this.showScreenshotUpload=!1,this.screenshotData=null,this.verificationStatus=i,this.showRestoredMessage=!1,this.showVerificationMethods=!1,this.selectedVerificationMethod=null,this.trustPreview=null,localStorage.removeItem("".concat(M.get("STORAGE_PREFIX","casl_"),"trust_preview")),this.clearSavedData(),this._trustPreviewCache={},this.uxMetrics={formStarted:!1,stepsCompleted:new Set,startTime:performance.now()},this.validateForm(),B.announce("Form has been reset. Starting over.","polite"),this._prevRenderState=null,this.render(),zt.endTimer("form_reset"),performance.mark("form_reset_end"),performance.measure("form_reset","form_reset_start","form_reset_end")}},{key:"saveFormData",value:function(){if(!this.submitted){zt.startTimer("save_form_data");try{var e=M.get("STORAGE_PREFIX","casl_"),t={formData:this.formData,currentStep:this.currentStep,timestamp:(new Date).toISOString()};localStorage.setItem("".concat(e,"saved_form_data"),JSON.stringify(t))}catch(e){console.warn("Error saving form data:",e)}finally{zt.endTimer("save_form_data")}}}},{key:"loadSavedData",value:function(){var e=this;zt.startTimer("load_saved_data");try{var t=M.get("STORAGE_PREFIX","casl_"),n=localStorage.getItem("".concat(t,"saved_form_data"));if(!n)return;var r=JSON.parse(n),o=M.get("FORM_STATE_MAX_AGE",864e5),i=new Date(r.timestamp).getTime();if(Date.now()-i>o)return void localStorage.removeItem("".concat(t,"saved_form_data"));r.formData&&(I.updateFormData(Pt(Pt({},r.formData),{},{currentStep:r.currentStep||0})),this.currentStep=r.currentStep||0,this.formData=r.formData,this.showRestoredMessage=!0,setTimeout((function(){e.showRestoredMessage=!1,e.render()}),5e3),this.validateForm(),B.announce("Your previous form data has been restored.","polite"))}catch(e){console.warn("Error loading saved form data:",e)}finally{zt.endTimer("load_saved_data")}}},{key:"clearSavedData",value:function(){try{var e=M.get("STORAGE_PREFIX","casl_");localStorage.removeItem("".concat(e,"saved_form_data")),this.showRestoredMessage=!1,B.announce("Saved form data has been cleared.","polite")}catch(e){console.warn("Error clearing saved data:",e)}}},{key:"clearApiError",value:function(){I.hideAlert(),B.announce("Error message dismissed.","polite")}},{key:"setupEventListeners",value:function(){var e=this;this.registerEventHandlers(),document.addEventListener("caslLanguageChanged",(function(){e.render();var t=qe.getLanguageInfo(qe.currentLanguage);t&&B.announce("Language changed to ".concat(t.name),"polite")})),document.addEventListener("phoneVerificationTimerExpired",(function(){e.render(),B.announce("Verification code has expired. You can request a new code.","polite")}));var t=window.matchMedia("(prefers-reduced-motion: reduce)");t&&t.addEventListener("change",(function(){e.render()}))}},{key:"registerEventHandlers",value:function(){var e=this;T.registerHandler(this.componentId,"handleInputChange",this.handleInputChange.bind(this)),T.registerHandler(this.componentId,"handleLanguageChange",this.handleLanguageChange.bind(this)),T.registerHandler(this.componentId,"handleNextStep",this.handleNextStep.bind(this)),T.registerHandler(this.componentId,"handlePreviousStep",this.handlePreviousStep.bind(this)),T.registerHandler(this.componentId,"toggleScreenshotUpload",(function(t,n){return e.toggleScreenshotUpload(!0)})),T.registerHandler(this.componentId,"handleScreenshotUpload",this.handleScreenshotUpload.bind(this)),T.registerHandler(this.componentId,"clearScreenshot",this.clearScreenshot.bind(this)),T.registerHandler(this.componentId,"handleDragOver",this.handleDragOver.bind(this)),T.registerHandler(this.componentId,"handleDragLeave",this.handleDragLeave.bind(this)),T.registerHandler(this.componentId,"handleDrop",this.handleDrop.bind(this)),T.registerHandler(this.componentId,"toggleVerificationMethods",(function(t,n){return e.toggleVerificationMethods("true"===(null==n?void 0:n.getAttribute("data-show")))})),T.registerHandler(this.componentId,"selectVerificationMethod",(function(t,n){return e.selectVerificationMethod(n.getAttribute("data-method"))})),T.registerHandler(this.componentId,"handleIdImageUpload",this.handleIdImageUpload.bind(this)),T.registerHandler(this.componentId,"handleSelfieImageUpload",this.handleSelfieImageUpload.bind(this)),T.registerHandler(this.componentId,"clearIdImage",this.clearIdImage.bind(this)),T.registerHandler(this.componentId,"clearSelfieImage",this.clearSelfieImage.bind(this)),T.registerHandler(this.componentId,"verifyGovId",(function(t,n){return e.verifyGovId(n.getAttribute("data-user-id"))})),T.registerHandler(this.componentId,"requestPhoneVerification",(function(t,n){return e.requestPhoneVerification(n.getAttribute("data-user-id"))})),T.registerHandler(this.componentId,"verifyPhoneCode",(function(t,n){return e.verifyPhoneCode(n.getAttribute("data-user-id"))})),T.registerHandler(this.componentId,"resendVerificationCode",(function(t,n){return e.resendVerificationCode(n.getAttribute("data-user-id"))})),T.registerHandler(this.componentId,"handleSocialPlatformChange",this.handleSocialPlatformChange.bind(this)),T.registerHandler(this.componentId,"verifySocialProfile",(function(t,n){return e.verifySocialProfile(n.getAttribute("data-user-id"))})),T.registerHandler(this.componentId,"printResults",this.printResults.bind(this)),T.registerHandler(this.componentId,"handleReset",this.handleReset.bind(this)),T.registerHandler(this.componentId,"clearApiError",this.clearApiError.bind(this))}}]);var n,r,o,u,l,d,h,m,y,b,w,x,k,S,E}(Ct(HTMLElement));function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Kt(){Kt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Ht(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Ht(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Bt(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Yt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Bt(i,r,o,a,s,"next",e)}function s(e){Bt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Jt(r.key),r)}}function Jt(e){var t=function(e){if("object"!=Ht(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ht(t)?t:t+""}customElements.define("casl-verification",qt);var Xt=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userPoolId=null,this.clientId=null,this.region="us-east-2",this.currentUser=null,this.accessToken=null,this.refreshToken=null,this._initialized=this.initialize()},t=[{key:"initialize",value:(f=Yt(Kt().mark((function e(){var t,n,r;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchConfiguration();case 3:if(r=e.sent,this.userPoolId=null===(t=r.auth)||void 0===t?void 0:t.userPoolId,this.clientId=null===(n=r.auth)||void 0===n?void 0:n.userPoolWebClientId,this.userPoolId&&this.clientId){e.next=8;break}throw new Error("[userService] Missing required config values");case 8:return e.next=10,this.loadStoredSession();case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error("Failed to initialize user service:",e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])}))),function(){return f.apply(this,arguments)})},{key:"whenReady",value:(h=Yt(Kt().mark((function e(){return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._initialized;case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("[UserService] Initialization error in whenReady():",e.t0);case 8:case"end":return e.stop()}}),e,this,[[0,5]])}))),function(){return h.apply(this,arguments)})},{key:"fetchConfiguration",value:(d=Yt(Kt().mark((function e(){var t;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/casl-config"),{method:"GET",headers:{"Content-Type":"application/json"}});case 3:if((t=e.sent).ok){e.next=6;break}throw new Error("Failed config fetch: ".concat(t.status));case 6:return e.next=8,t.json();case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(0),console.error("Error fetching configuration:",e.t0),e.abrupt("return",{auth:{userPoolId:"us-east-2_wxVzxzC7V",userPoolWebClientId:"6eihn0891v31dsovg33g2e1h90"}});case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),function(){return d.apply(this,arguments)})},{key:"loadStoredSession",value:(l=Yt(Kt().mark((function e(){var t,n,r;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=localStorage.getItem("casl_access_token"),n=localStorage.getItem("casl_refresh_token"),r=localStorage.getItem("casl_user_data"),!(t&&n&&r)){e.next=18;break}return e.next=7,this.validateToken(t);case 7:if(!e.sent){e.next=14;break}this.accessToken=t,this.refreshToken=n,this.currentUser=JSON.parse(r),e.next=18;break;case 14:return e.next=16,this.refreshSession(n);case 16:e.sent||this.clearSession();case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(0),console.error("Error loading session:",e.t0),this.clearSession();case 24:case"end":return e.stop()}}),e,this,[[0,20]])}))),function(){return l.apply(this,arguments)})},{key:"validateToken",value:(u=Yt(Kt().mark((function e(t){var n;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/validate-token"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});case 3:return n=e.sent,e.abrupt("return",n.ok);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Token validation error:",e.t0),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),function(e){return u.apply(this,arguments)})},{key:"refreshSession",value:(c=Yt(Kt().mark((function e(t){var n,r;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/refresh-token"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});case 3:if((n=e.sent).ok){e.next=6;break}throw new Error("Refresh failed");case 6:return e.next=8,n.json();case 8:return r=e.sent,this.accessToken=r.accessToken,this.refreshToken=r.refreshToken,localStorage.setItem("casl_access_token",this.accessToken),localStorage.setItem("casl_refresh_token",this.refreshToken),e.abrupt("return",!0);case 16:return e.prev=16,e.t0=e.catch(0),console.error("Refresh error:",e.t0),e.abrupt("return",!1);case 20:case"end":return e.stop()}}),e,this,[[0,16]])}))),function(e){return c.apply(this,arguments)})},{key:"registerUser",value:(s=Yt(Kt().mark((function e(t){var n,r,i;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t.username,email:t.email,password:t.password})});case 3:if((n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:throw r=e.sent,new Error(r.message||"Registration failed");case 9:return e.next=11,n.json();case 11:return i=e.sent,e.abrupt("return",{success:!0,username:t.username,requiresConfirmation:i.requiresConfirmation||!1});case 15:throw e.prev=15,e.t0=e.catch(0),console.error("Registration error:",e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])}))),function(e){return s.apply(this,arguments)})},{key:"confirmRegistration",value:(a=Yt(Kt().mark((function e(t,n){var r,i;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/confirm-registration"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,code:n})});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.json();case 7:throw i=e.sent,new Error(i.message||"Confirmation failed");case 9:return e.abrupt("return",!0);case 12:throw e.prev=12,e.t0=e.catch(0),console.error("Confirmation error:",e.t0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])}))),function(e,t){return a.apply(this,arguments)})},{key:"loginUser",value:(i=Yt(Kt().mark((function e(t,n){var r,i,a;return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(o,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})});case 3:if((r=e.sent).ok){e.next=9;break}return e.next=7,r.json();case 7:throw i=e.sent,new Error(i.message||"Login failed");case 9:return e.next=11,r.json();case 11:return a=e.sent,this.accessToken=a.accessToken,this.refreshToken=a.refreshToken,this.currentUser={username:t,email:a.email,id:a.userId,attributes:a.attributes||{}},localStorage.setItem("casl_access_token",this.accessToken),localStorage.setItem("casl_refresh_token",this.refreshToken),localStorage.setItem("casl_user_data",JSON.stringify(this.currentUser)),e.abrupt("return",this.currentUser);case 21:throw e.prev=21,e.t0=e.catch(0),console.error("Login error:",e.t0),e.t0;case 25:case"end":return e.stop()}}),e,this,[[0,21]])}))),function(e,t){return i.apply(this,arguments)})},{key:"logoutUser",value:(r=Yt(Kt().mark((function e(){return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.accessToken){e.next=4;break}return e.next=4,fetch("".concat(o,"/logout"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.accessToken)}});case 4:return this.clearSession(),e.abrupt("return",!0);case 8:return e.prev=8,e.t0=e.catch(0),console.error("Logout error:",e.t0),this.clearSession(),e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this,[[0,8]])}))),function(){return r.apply(this,arguments)})},{key:"clearSession",value:function(){this.accessToken=null,this.refreshToken=null,this.currentUser=null,localStorage.removeItem("casl_access_token"),localStorage.removeItem("casl_refresh_token"),localStorage.removeItem("casl_user_data")}},{key:"getCurrentUser",value:(n=Yt(Kt().mark((function e(){return Kt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentUser||!this.accessToken){e.next=12;break}return e.next=3,this.validateToken(this.accessToken);case 3:if(!e.sent){e.next=6;break}return e.abrupt("return",{isAuthenticated:!0,user:this.currentUser});case 6:return e.next=8,this.refreshSession(this.refreshToken);case 8:if(!e.sent){e.next=11;break}return e.abrupt("return",{isAuthenticated:!0,user:this.currentUser});case 11:this.clearSession();case 12:return e.abrupt("return",{isAuthenticated:!1,user:null});case 13:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getAuthHeaders",value:function(){return this.accessToken?{Authorization:"Bearer ".concat(this.accessToken)}:{}}}],t&&Wt(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,a,s,c,u,l,d,h,f}());function $t(e){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$t(e)}function Zt(){Zt=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==$t(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError($t(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Qt(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function en(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Qt(i,r,o,a,s,"next",e)}function s(e){Qt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function tn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nn(r.key),r)}}function nn(e){var t=function(e){if("object"!=$t(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=$t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==$t(t)?t:t+""}function rn(e){var t="function"==typeof Map?new Map:void 0;return rn=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(on())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&an(o,n.prototype),o}(e,arguments,sn(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),an(n,e)},rn(e)}function on(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(on=function(){return!!e})()}function an(e,t){return an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},an(e,t)}function sn(e){return sn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sn(e)}var cn=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=sn(t),function(e,t){if(t&&("object"==$t(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,on()?Reflect.construct(t,n||[],sn(e).constructor):t.apply(e,n))}(this,t)).attachShadow({mode:"open"}),e.initializeState(),e.render(),e.setupEventListeners(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&an(e,t)}(t,e),n=t,r=[{key:"initializeState",value:function(){this.isLoading=!1,this.isAuthenticated=!1,this.isRegistering=!1,this.error=null,this.user=null,this.checkAuthentication()}},{key:"checkAuthentication",value:(c=en(Zt().mark((function e(){var t;return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xt.getCurrentUser();case 3:(t=e.sent).isAuthenticated&&(this.isAuthenticated=!0,this.user=t.user),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Authentication check failed:",e.t0);case 10:this.render();case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return c.apply(this,arguments)})},{key:"connectedCallback",value:function(){console.log("Authentication component connected")}},{key:"render",value:function(){var e,t;this.isAuthenticated?(this.dispatchAuthEvent("authenticated",this.user),t=this.renderAuthenticatedState()):t=this.isRegistering?this.renderRegistrationForm():this.renderLoginForm(),this.shadowRoot.innerHTML="\n      <style>".concat('\n    :host {\n      display: block;\n      font-family: Arial, sans-serif;\n      \n      /* Primary colors with contrast-safe text colors */\n      --primary-color: #4285F4;\n      --primary-color-dark: #1a5dd4;\n      --on-primary-color: #ffffff;\n      \n      --success-color: #4CAF50;\n      --on-success-color: #ffffff;\n      \n      --warning-color: #EC9F05; /* Darkened for better contrast */\n      --on-warning-color: #000000;\n      \n      --error-color: #c62828;\n      --on-error-color: #ffffff;\n      \n      --neutral-color: #5C5C5C; /* Darkened for better contrast */\n      --on-neutral-color: #ffffff;\n      \n      --surface-color: #ffffff;\n      --on-surface-color: #212121;\n      \n      --disabled-color: #9E9E9E;\n      --on-disabled-color: #212121;\n      \n      --border-radius: 8px;\n      --box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      --focus-ring-color: #4285F4;\n      --focus-ring-width: 3px;\n    }\n    \n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    \n    .form-section {\n      background-color: var(--surface-color);\n      padding: 20px;\n      border-radius: var(--border-radius);\n      margin-bottom: 20px;\n      box-shadow: var(--box-shadow);\n    }\n    \n    button {\n      padding: 10px 20px;\n      background-color: var(--primary-color);\n      color: var(--on-primary-color);\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      margin: 5px;\n      transition: background-color 0.2s, opacity 0.2s;\n      min-height: 44px;\n    }\n    \n    button:hover {\n      background-color: var(--primary-color-dark);\n    }\n    \n    button:focus {\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 2px;\n    }\n    \n    button:disabled {\n      background-color: var(--disabled-color);\n      color: var(--on-disabled-color);\n      cursor: not-allowed;\n    }\n    \n    button.success {\n      background-color: var(--success-color);\n      color: var(--on-success-color);\n    }\n    \n    button.success:hover {\n      background-color: #3d8b40;\n    }\n    \n    button.warning {\n      background-color: var(--warning-color);\n      color: var(--on-warning-color);\n    }\n    \n    button.warning:hover {\n      background-color: #c78500;\n    }\n    \n    button.neutral {\n      background-color: var(--neutral-color);\n      color: var(--on-neutral-color);\n    }\n    \n    button.neutral:hover {\n      background-color: #3d3d3d;\n    }\n    \n    input, select, textarea {\n      width: 100%;\n      padding: 12px;\n      margin-bottom: 10px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 16px;\n      transition: border-color 0.2s;\n      min-height: 44px;\n    }\n    \n    input:focus, select:focus, textarea:focus {\n      border-color: var(--primary-color);\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 0;\n    }\n    \n    textarea {\n      resize: vertical;\n      min-height: 80px;\n    }\n    \n    label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n    }\n    \n    .error {\n      color: var(--error-color);\n      font-size: 14px;\n      margin-top: -5px;\n      margin-bottom: 10px;\n    }\n    \n    .navigation-buttons {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 20px;\n    }\n    \n    .alert {\n      padding: 12px 15px;\n      border-radius: 4px;\n      margin-bottom: 15px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    \n    .alert-success {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n      border-left: 4px solid var(--success-color);\n    }\n    \n    .alert-error {\n      background-color: #ffebee;\n      color: var(--error-color);\n      border-left: 4px solid var(--error-color);\n    }\n    \n    .alert-info {\n      background-color: #e3f2fd;\n      color: #0d47a1;\n      border-left: 4px solid var(--primary-color);\n    }\n    \n    .alert-warning {\n      background-color: #fff8e1;\n      color: #f57f17;\n      border-left: 4px solid var(--warning-color);\n    }\n    \n    .progress-steps {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 30px;\n    }\n    \n    .step {\n      text-align: center;\n      position: relative;\n      width: 25%;\n    }\n    \n    .step-indicator {\n      width: 30px;\n      height: 30px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto 5px;\n      z-index: 2;\n      position: relative;\n    }\n    \n    .progress-bar {\n      height: 8px;\n      background-color: #eee;\n      border-radius: 4px;\n      margin-bottom: 25px;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .progress-indicator {\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      background-color: var(--primary-color);\n      border-radius: 4px;\n      transition: width 0.3s ease;\n    }\n    \n    .screenshot-container {\n      border: 2px dashed #ccc;\n      padding: 20px;\n      text-align: center;\n      margin-bottom: 20px;\n      border-radius: 4px;\n      transition: border-color 0.2s;\n      position: relative;\n      min-height: 150px;\n    }\n    \n    .screenshot-container:hover {\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-container.drag-over {\n      background-color: #f0f7ff;\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-preview {\n      max-width: 100%;\n      max-height: 300px;\n      margin-top: 10px;\n      border-radius: 4px;\n    }\n    \n   .file-input {\n     position: absolute;\n     width: 100%;\n     height: 100%;\n     top: 0;\n     left: 0;\n     opacity: 0;\n     cursor: pointer;\n   }\n   \n   .result-card {\n     background-color: white;\n     padding: 30px;\n     border-radius: var(--border-radius);\n     box-shadow: var(--box-shadow);\n     text-align: center;\n     margin-bottom: 20px;\n   }\n   \n   .trust-badge {\n     display: inline-block;\n     padding: 10px 20px;\n     border-radius: 4px;\n     font-weight: bold;\n     color: white;\n     margin: 15px 0;\n   }\n   \n   .score-display {\n     margin: 20px 0;\n   }\n   \n   .score-number {\n     font-size: 48px;\n     font-weight: bold;\n   }\n   \n   .score-max {\n     color: #666;\n   }\n   \n   .result-message {\n     padding: 15px;\n     background-color: #f5f5f5;\n     border-radius: 8px;\n     font-size: 18px;\n     margin: 20px 0;\n   }\n   \n   .adjustments-list {\n     margin-top: 30px;\n     text-align: left;\n   }\n   \n   .adjustment-item {\n     display: flex;\n     justify-content: space-between;\n     padding: 10px;\n     border-bottom: 1px solid #eee;\n   }\n   \n   .adjustment-points {\n     font-weight: bold;\n   }\n   \n   .adjustment-positive {\n     color: var(--success-color);\n   }\n   \n   .adjustment-negative {\n     color: var(--error-color);\n   }\n   \n   .tooltip {\n     position: relative;\n     display: inline-block;\n     margin-left: 5px;\n     cursor: help;\n   }\n   \n   .tooltip .tooltip-icon {\n     background-color: #ddd;\n     color: #333;\n     width: 24px;\n     height: 24px;\n     border-radius: 50%;\n     display: inline-flex;\n     align-items: center;\n     justify-content: center;\n     font-size: 14px;\n     font-weight: bold;\n   }\n   \n   .tooltip .tooltip-text {\n     visibility: hidden;\n     width: 250px;\n     background-color: #333;\n     color: #fff;\n     text-align: center;\n     border-radius: 6px;\n     padding: 8px;\n     position: absolute;\n     z-index: 1;\n     bottom: 125%;\n     left: 50%;\n     transform: translateX(-50%);\n     opacity: 0;\n     transition: opacity 0.3s;\n     font-size: 14px;\n     font-weight: normal;\n   }\n   \n   .tooltip:hover .tooltip-text {\n     visibility: visible;\n     opacity: 1;\n   }\n   \n   .checkbox-container {\n     display: flex;\n     align-items: flex-start;\n     margin-bottom: 10px;\n     min-height: 44px;\n   }\n   \n   .checkbox-container input[type="checkbox"] {\n     width: auto;\n     min-width: 24px;\n     min-height: 24px;\n     margin-right: 10px;\n     margin-top: 3px;\n   }\n   \n   .checkbox-label {\n     font-weight: normal;\n     flex: 1;\n   }\n   \n   .trust-preview {\n     background-color: #f5f5f5;\n     border: 1px solid #ddd;\n     border-radius: var(--border-radius);\n     padding: 15px;\n     margin-top: 20px;\n   }\n   \n   .trust-preview h3 {\n     margin-top: 0;\n     font-size: 16px;\n     color: #333;\n   }\n   \n   .preview-badge {\n     display: inline-block;\n     padding: 6px 12px;\n     border-radius: 4px;\n     font-size: 14px;\n     color: white;\n     margin-right: 10px;\n   }\n   \n   /* Mobile accessibility styles */\n   @media (max-width: 768px) {\n     .container {\n       padding: 10px;\n     }\n     \n     .form-section {\n       padding: 15px;\n     }\n     \n     .progress-steps {\n       display: none;\n     }\n     \n     .mobile-step-indicator {\n       display: block !important;\n       text-align: center;\n       margin-bottom: 20px;\n     }\n     \n     /* Ensure touch targets are at least 44x44px */\n     button, \n     [role="button"], \n     a,\n     .checkbox-container,\n     input[type="checkbox"],\n     input[type="radio"],\n     input[type="submit"],\n     select,\n     .tooltip {\n       min-height: 44px;\n       min-width: 44px;\n     }\n     \n     /* Improve touch target sizes on mobile */\n     button {\n       padding: 12px 20px;\n       width: 100%;\n       margin: 8px 0;\n       font-size: 16px;\n     }\n     \n     .navigation-buttons {\n       flex-direction: column-reverse;\n       gap: 10px;\n     }\n     \n     /* Adjust form layouts for better touch interaction */\n     .form-section {\n       padding: 20px 16px;\n     }\n     \n     /* Improve checkbox touch targets */\n     .checkbox-container {\n       padding: 8px 0;\n       margin: 8px 0;\n     }\n     \n     .checkbox-container input[type="checkbox"] {\n       transform: scale(1.25);\n       margin-right: 12px;\n       margin-top: 6px;\n     }\n     \n     /* Larger tap target for tooltip */\n     .tooltip .tooltip-icon {\n       width: 30px;\n       height: 30px;\n       font-size: 16px;\n     }\n     \n     /* Adjust spacing between elements */\n     label {\n       margin-bottom: 8px;\n       display: block;\n     }\n     \n     input, select, textarea {\n       padding: 14px;\n       font-size: 16px; /* Prevents iOS zoom on focus */\n       margin-bottom: 16px;\n     }\n     \n     /* Improved error display */\n     .error {\n       padding: 8px 0;\n       font-size: 14px;\n     }\n   }\n   \n   /* Reduced motion preferences */\n   @media (prefers-reduced-motion: reduce) {\n     /* Remove all animations and transitions */\n     *, *::before, *::after {\n       animation-duration: 0.001ms !important;\n       animation-iteration-count: 1 !important;\n       transition-duration: 0.001ms !important;\n       scroll-behavior: auto !important;\n     }\n     \n     /* Specific elements that need animation removal */\n     .progress-indicator {\n       transition: none !important;\n     }\n     \n     .tooltip .tooltip-text {\n       transition: none !important;\n     }\n     \n     /* Replace animations with immediate state changes */\n     .tooltip:hover .tooltip-text {\n       visibility: visible;\n       opacity: 1;\n       transition: none !important;\n     }\n   }\n   \n   /* Focus styles and accessibility support */\n   :focus-visible {\n     outline: var(--focus-ring-width) solid var(--focus-ring-color);\n     outline-offset: 2px;\n     border-radius: 2px;\n   }\n   \n   /* High contrast mode support */\n   @media (forced-colors: active) {\n     .progress-indicator {\n       background-color: SelectedItem;\n     }\n     \n     button {\n       border: 1px solid ButtonText;\n     }\n     \n     :focus-visible {\n       outline: 3px solid CanvasText !important;\n       outline-offset: 3px;\n     }\n   }\n   \n   /* Skip link for keyboard users */\n   .skip-to-content {\n     position: absolute;\n     top: -5rem;\n     left: 0;\n     padding: 1rem;\n     background: var(--primary-color);\n     color: white;\n     z-index: 100;\n     opacity: 0;\n     transition: top 0.2s, opacity 0.2s;\n   }\n   \n   .skip-to-content:focus {\n     top: 0;\n     opacity: 1;\n   }\n   \n   /* Screen reader only text */\n   .sr-only {\n     position: absolute;\n     width: 1px;\n     height: 1px;\n     padding: 0;\n     margin: -1px;\n     overflow: hidden;\n     clip: rect(0, 0, 0, 0);\n     white-space: nowrap;\n     border-width: 0;\n   }\n   \n   /* Form validation visual cues */\n   input:invalid,\n   select:invalid,\n   textarea:invalid {\n     border-color: var(--error-color);\n   }\n   \n   /* Required fields indicator */\n   label.required::after {\n     content: "*";\n     color: var(--error-color);\n     margin-left: 2px;\n   }\n ','</style>\n      <div class="container" dir="').concat((null===(e=qe.getLanguageInfo(qe.currentLanguage))||void 0===e?void 0:e.direction)||"ltr",'">\n        ').concat(t,"\n      </div>\n    ")}},{key:"renderWelcomeScreen",value:function(){return'\n      <div class="welcome-screen">\n        <h1>'.concat(ze("auth.welcome"),"</h1>\n        <p>").concat(ze("auth.welcomeDescription"),'</p>\n        \n        <div class="welcome-options">\n          <button \n            class="btn-primary" \n            onclick="this.getRootNode().host.handleFirstTimeUser(true)"\n          >\n            ').concat(ze("auth.firstTime"),'\n          </button>\n          \n          <button \n            class="btn-secondary" \n            onclick="this.getRootNode().host.handleFirstTimeUser(false)"\n          >\n            ').concat(ze("auth.returningUser"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"renderLoginForm",value:function(){return'\n      <div class="auth-form">\n        <h2>'.concat(ze("auth.loginTitle"),"</h2>\n        \n        ").concat(this.error?'\n          <div class="alert alert-error" role="alert">\n            '.concat(this.error,"\n          </div>\n        "):"",'\n        \n        <form id="login-form">\n          <div class="form-group">\n            <label for="username">').concat(ze("auth.username"),'</label>\n            <input type="text" id="username" name="username" required />\n          </div>\n          \n          <div class="form-group">\n            <label for="password">').concat(ze("auth.password"),'</label>\n            <input type="password" id="password" name="password" required />\n          </div>\n          \n          <div class="form-actions">\n            <button \n              type="submit" \n              class="btn-primary" \n              ').concat(this.isLoading?"disabled":"","\n            >\n              ").concat(this.isLoading?ze("auth.loggingIn"):ze("auth.login"),'\n            </button>\n            \n            <button \n              type="button" \n              class="btn-link" \n              onclick="this.getRootNode().host.toggleRegistration(true)"\n            >\n              ').concat(ze("auth.needAccount"),"\n            </button>\n          </div>\n        </form>\n      </div>\n    ")}},{key:"renderRegistrationForm",value:function(){return'\n      <div class="auth-form">\n        <h2>'.concat(ze("auth.registerTitle"),"</h2>\n        \n        ").concat(this.error?'\n          <div class="alert alert-error" role="alert">\n            '.concat(this.error,"\n          </div>\n        "):"",'\n        \n        <form id="registration-form">\n          <div class="form-group">\n            <label for="reg-email">').concat(ze("auth.email"),'</label>\n            <input type="email" id="reg-email" name="email" required />\n          </div>\n          \n          <div class="form-group">\n            <label for="reg-username">').concat(ze("auth.username"),'</label>\n            <input type="text" id="reg-username" name="username" required />\n          </div>\n          \n          <div class="form-group">\n            <label for="reg-password">').concat(ze("auth.password"),'</label>\n            <input type="password" id="reg-password" name="password" required />\n            <div class="password-requirements">\n              <small>').concat(ze("auth.passwordRequirements"),'</small>\n            </div>\n          </div>\n          \n          <div class="form-group">\n            <label for="reg-confirm-password">').concat(ze("auth.confirmPassword"),'</label>\n            <input type="password" id="reg-confirm-password" name="confirmPassword" required />\n          </div>\n          \n          <div class="form-actions">\n            <button \n              type="submit" \n              class="btn-primary" \n              ').concat(this.isLoading?"disabled":"","\n            >\n              ").concat(this.isLoading?ze("auth.registering"):ze("auth.register"),'\n            </button>\n            \n            <button \n              type="button" \n              class="btn-link" \n              onclick="this.getRootNode().host.toggleRegistration(false)"\n            >\n              ').concat(ze("auth.haveAccount"),"\n            </button>\n          </div>\n        </form>\n      </div>\n    ")}},{key:"renderAuthenticatedState",value:function(){var e;return'\n      <div class="auth-status">\n        <p>'.concat(ze("auth.loggedInAs",{username:(null===(e=this.user)||void 0===e?void 0:e.username)||"User"}),'</p>\n        <button \n          class="btn-secondary" \n          onclick="this.getRootNode().host.handleLogout()"\n        >\n          ').concat(ze("auth.logout"),"\n        </button>\n      </div>\n    ")}},{key:"toggleRegistration",value:function(e){this.isRegistering=e,this.error=null,this.render()}},{key:"handleSubmit",value:(s=en(Zt().mark((function e(t){var n,r;return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.isLoading=!0,this.error=null,this.render(),n=t.target,r=new FormData(n),e.prev=6,!this.isRegistering){e.next=12;break}return e.next=10,this.handleRegistration(r);case 10:e.next=14;break;case 12:return e.next=14,this.handleLogin(r);case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("Authentication error:",e.t0),this.error=e.t0.message||ze("auth.genericError");case 20:return e.prev=20,this.isLoading=!1,this.render(),e.finish(20);case 24:case"end":return e.stop()}}),e,this,[[6,16,20,24]])}))),function(e){return s.apply(this,arguments)})},{key:"handleRegistration",value:(a=en(Zt().mark((function e(t){var n,r,o,i;return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.get("email"),r=t.get("username"),o=t.get("password"),i=t.get("confirmPassword"),o===i){e.next=6;break}throw new Error(ze("auth.passwordsDoNotMatch"));case 6:return e.next=8,Xt.registerUser({email:n,username:r,password:o});case 8:if(!e.sent.requiresConfirmation){e.next=13;break}this.dispatchAuthEvent("registration-pending",{username:r,email:n}),e.next=15;break;case 13:return e.next=15,this.handleLogin(t);case 15:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"handleLogin",value:(i=en(Zt().mark((function e(t){var n,r,o;return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.get("username"),r=t.get("password"),e.next=4,Xt.loginUser(n,r);case 4:o=e.sent,this.isAuthenticated=!0,this.user=o,this.dispatchAuthEvent("authenticated",o),this.render();case 9:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"handleLogout",value:(o=en(Zt().mark((function e(){return Zt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xt.logoutUser();case 3:this.isAuthenticated=!1,this.user=null,this.dispatchAuthEvent("logged-out"),this.render(),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Logout error:",e.t0),this.error=e.t0.message||ze("auth.logoutError"),this.render();case 14:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(){return o.apply(this,arguments)})},{key:"handleFirstTimeUser",value:function(e){this.isRegistering=!!e,this.render()}},{key:"dispatchAuthEvent",value:function(e){var t=new CustomEvent("casl-auth",{detail:{type:e,data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null},bubbles:!0,composed:!0});this.dispatchEvent(t)}},{key:"setupEventListeners",value:function(){var e=this;setTimeout((function(){var t=e.shadowRoot.getElementById("login-form");t&&t.addEventListener("submit",e.handleSubmit.bind(e));var n=e.shadowRoot.getElementById("registration-form");n&&n.addEventListener("submit",e.handleSubmit.bind(e))}),0)}}],r&&tn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a,s,c}(rn(HTMLElement));function un(e){return un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},un(e)}function ln(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(n),!0).forEach((function(t){hn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ln(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hn(e,t,n){return(t=mn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fn(){fn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==un(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(un(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function pn(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function vn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){pn(i,r,o,a,s,"next",e)}function s(e){pn(i,r,o,a,s,"throw",e)}a(void 0)}))}}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mn(r.key),r)}}function mn(e){var t=function(e){if("object"!=un(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=un(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==un(t)?t:t+""}function yn(e){var t="function"==typeof Map?new Map:void 0;return yn=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(bn())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&wn(o,n.prototype),o}(e,arguments,xn(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),wn(n,e)},yn(e)}function bn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(bn=function(){return!!e})()}function wn(e,t){return wn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wn(e,t)}function xn(e){return xn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xn(e)}customElements.define("casl-authentication",cn);var kn=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=xn(t),function(e,t){if(t&&("object"==un(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,bn()?Reflect.construct(t,n||[],xn(e).constructor):t.apply(e,n))}(this,t)).attachShadow({mode:"open"}),e.initializeState(),e.render(),e.setupEventListeners(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wn(e,t)}(t,e),n=t,r=[{key:"initializeState",value:function(){this.isLoading=!1,this.error=null,this.user=null,this.verificationHistory=[],this.packages=[],this.loadDashboardData()}},{key:"connectedCallback",value:function(){console.log("UserDashboard component connected"),document.addEventListener("casl-auth",this.handleAuthEvent.bind(this))}},{key:"disconnectedCallback",value:function(){document.removeEventListener("casl-auth",this.handleAuthEvent.bind(this))}},{key:"handleAuthEvent",value:function(e){var t=e.detail,n=t.type,r=t.data;"authenticated"===n?(this.user=r,this.loadDashboardData()):"logged-out"===n&&this.dispatchDashboardEvent("logout")}},{key:"loadDashboardData",value:(c=vn(fn().mark((function e(){var t;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.user){e.next=8;break}return e.next=3,Xt.getCurrentUser();case 3:if((t=e.sent).isAuthenticated){e.next=7;break}return this.dispatchDashboardEvent("auth-required"),e.abrupt("return");case 7:this.user=t.user;case 8:return this.isLoading=!0,this.error=null,this.render(),e.prev=11,e.next=14,this.loadVerificationHistory();case 14:return e.next=16,this.loadPackages();case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(11),console.error("Error loading dashboard data:",e.t0),this.error=e.t0.message||ze("dashboard.loadError");case 22:return e.prev=22,this.isLoading=!1,this.render(),e.finish(22);case 26:case"end":return e.stop()}}),e,this,[[11,18,22,26]])}))),function(){return c.apply(this,arguments)})},{key:"loadVerificationHistory",value:(s=vn(fn().mark((function e(){var t,n,r;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=dn({"Content-Type":"application/json"},Xt.getAuthHeaders()),e.next=3,fetch("".concat(o,"/verification-history"),{method:"GET",headers:t});case 3:if((n=e.sent).ok){e.next=6;break}throw new Error(ze("dashboard.historyLoadError"));case 6:return e.next=8,n.json();case 8:r=e.sent,this.verificationHistory=r.verifications||[];case 10:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"loadPackages",value:(a=vn(fn().mark((function e(){var t,n;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/packages"),{method:"GET",headers:{"Content-Type":"application/json"}});case 2:if((t=e.sent).ok){e.next=5;break}throw new Error(ze("dashboard.packagesLoadError"));case 5:return e.next=7,t.json();case 7:n=e.sent,this.packages=n.packages||[];case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"render",value:function(){var e,t;t=this.isLoading?this.renderLoading():this.error?this.renderError():this.renderDashboard(),this.shadowRoot.innerHTML="\n      <style>".concat('\n    :host {\n      display: block;\n      font-family: Arial, sans-serif;\n      \n      /* Primary colors with contrast-safe text colors */\n      --primary-color: #4285F4;\n      --primary-color-dark: #1a5dd4;\n      --on-primary-color: #ffffff;\n      \n      --success-color: #4CAF50;\n      --on-success-color: #ffffff;\n      \n      --warning-color: #EC9F05; /* Darkened for better contrast */\n      --on-warning-color: #000000;\n      \n      --error-color: #c62828;\n      --on-error-color: #ffffff;\n      \n      --neutral-color: #5C5C5C; /* Darkened for better contrast */\n      --on-neutral-color: #ffffff;\n      \n      --surface-color: #ffffff;\n      --on-surface-color: #212121;\n      \n      --disabled-color: #9E9E9E;\n      --on-disabled-color: #212121;\n      \n      --border-radius: 8px;\n      --box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      --focus-ring-color: #4285F4;\n      --focus-ring-width: 3px;\n    }\n    \n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    \n    .form-section {\n      background-color: var(--surface-color);\n      padding: 20px;\n      border-radius: var(--border-radius);\n      margin-bottom: 20px;\n      box-shadow: var(--box-shadow);\n    }\n    \n    button {\n      padding: 10px 20px;\n      background-color: var(--primary-color);\n      color: var(--on-primary-color);\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      margin: 5px;\n      transition: background-color 0.2s, opacity 0.2s;\n      min-height: 44px;\n    }\n    \n    button:hover {\n      background-color: var(--primary-color-dark);\n    }\n    \n    button:focus {\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 2px;\n    }\n    \n    button:disabled {\n      background-color: var(--disabled-color);\n      color: var(--on-disabled-color);\n      cursor: not-allowed;\n    }\n    \n    button.success {\n      background-color: var(--success-color);\n      color: var(--on-success-color);\n    }\n    \n    button.success:hover {\n      background-color: #3d8b40;\n    }\n    \n    button.warning {\n      background-color: var(--warning-color);\n      color: var(--on-warning-color);\n    }\n    \n    button.warning:hover {\n      background-color: #c78500;\n    }\n    \n    button.neutral {\n      background-color: var(--neutral-color);\n      color: var(--on-neutral-color);\n    }\n    \n    button.neutral:hover {\n      background-color: #3d3d3d;\n    }\n    \n    input, select, textarea {\n      width: 100%;\n      padding: 12px;\n      margin-bottom: 10px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 16px;\n      transition: border-color 0.2s;\n      min-height: 44px;\n    }\n    \n    input:focus, select:focus, textarea:focus {\n      border-color: var(--primary-color);\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 0;\n    }\n    \n    textarea {\n      resize: vertical;\n      min-height: 80px;\n    }\n    \n    label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n    }\n    \n    .error {\n      color: var(--error-color);\n      font-size: 14px;\n      margin-top: -5px;\n      margin-bottom: 10px;\n    }\n    \n    .navigation-buttons {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 20px;\n    }\n    \n    .alert {\n      padding: 12px 15px;\n      border-radius: 4px;\n      margin-bottom: 15px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    \n    .alert-success {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n      border-left: 4px solid var(--success-color);\n    }\n    \n    .alert-error {\n      background-color: #ffebee;\n      color: var(--error-color);\n      border-left: 4px solid var(--error-color);\n    }\n    \n    .alert-info {\n      background-color: #e3f2fd;\n      color: #0d47a1;\n      border-left: 4px solid var(--primary-color);\n    }\n    \n    .alert-warning {\n      background-color: #fff8e1;\n      color: #f57f17;\n      border-left: 4px solid var(--warning-color);\n    }\n    \n    .progress-steps {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 30px;\n    }\n    \n    .step {\n      text-align: center;\n      position: relative;\n      width: 25%;\n    }\n    \n    .step-indicator {\n      width: 30px;\n      height: 30px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto 5px;\n      z-index: 2;\n      position: relative;\n    }\n    \n    .progress-bar {\n      height: 8px;\n      background-color: #eee;\n      border-radius: 4px;\n      margin-bottom: 25px;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .progress-indicator {\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      background-color: var(--primary-color);\n      border-radius: 4px;\n      transition: width 0.3s ease;\n    }\n    \n    .screenshot-container {\n      border: 2px dashed #ccc;\n      padding: 20px;\n      text-align: center;\n      margin-bottom: 20px;\n      border-radius: 4px;\n      transition: border-color 0.2s;\n      position: relative;\n      min-height: 150px;\n    }\n    \n    .screenshot-container:hover {\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-container.drag-over {\n      background-color: #f0f7ff;\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-preview {\n      max-width: 100%;\n      max-height: 300px;\n      margin-top: 10px;\n      border-radius: 4px;\n    }\n    \n   .file-input {\n     position: absolute;\n     width: 100%;\n     height: 100%;\n     top: 0;\n     left: 0;\n     opacity: 0;\n     cursor: pointer;\n   }\n   \n   .result-card {\n     background-color: white;\n     padding: 30px;\n     border-radius: var(--border-radius);\n     box-shadow: var(--box-shadow);\n     text-align: center;\n     margin-bottom: 20px;\n   }\n   \n   .trust-badge {\n     display: inline-block;\n     padding: 10px 20px;\n     border-radius: 4px;\n     font-weight: bold;\n     color: white;\n     margin: 15px 0;\n   }\n   \n   .score-display {\n     margin: 20px 0;\n   }\n   \n   .score-number {\n     font-size: 48px;\n     font-weight: bold;\n   }\n   \n   .score-max {\n     color: #666;\n   }\n   \n   .result-message {\n     padding: 15px;\n     background-color: #f5f5f5;\n     border-radius: 8px;\n     font-size: 18px;\n     margin: 20px 0;\n   }\n   \n   .adjustments-list {\n     margin-top: 30px;\n     text-align: left;\n   }\n   \n   .adjustment-item {\n     display: flex;\n     justify-content: space-between;\n     padding: 10px;\n     border-bottom: 1px solid #eee;\n   }\n   \n   .adjustment-points {\n     font-weight: bold;\n   }\n   \n   .adjustment-positive {\n     color: var(--success-color);\n   }\n   \n   .adjustment-negative {\n     color: var(--error-color);\n   }\n   \n   .tooltip {\n     position: relative;\n     display: inline-block;\n     margin-left: 5px;\n     cursor: help;\n   }\n   \n   .tooltip .tooltip-icon {\n     background-color: #ddd;\n     color: #333;\n     width: 24px;\n     height: 24px;\n     border-radius: 50%;\n     display: inline-flex;\n     align-items: center;\n     justify-content: center;\n     font-size: 14px;\n     font-weight: bold;\n   }\n   \n   .tooltip .tooltip-text {\n     visibility: hidden;\n     width: 250px;\n     background-color: #333;\n     color: #fff;\n     text-align: center;\n     border-radius: 6px;\n     padding: 8px;\n     position: absolute;\n     z-index: 1;\n     bottom: 125%;\n     left: 50%;\n     transform: translateX(-50%);\n     opacity: 0;\n     transition: opacity 0.3s;\n     font-size: 14px;\n     font-weight: normal;\n   }\n   \n   .tooltip:hover .tooltip-text {\n     visibility: visible;\n     opacity: 1;\n   }\n   \n   .checkbox-container {\n     display: flex;\n     align-items: flex-start;\n     margin-bottom: 10px;\n     min-height: 44px;\n   }\n   \n   .checkbox-container input[type="checkbox"] {\n     width: auto;\n     min-width: 24px;\n     min-height: 24px;\n     margin-right: 10px;\n     margin-top: 3px;\n   }\n   \n   .checkbox-label {\n     font-weight: normal;\n     flex: 1;\n   }\n   \n   .trust-preview {\n     background-color: #f5f5f5;\n     border: 1px solid #ddd;\n     border-radius: var(--border-radius);\n     padding: 15px;\n     margin-top: 20px;\n   }\n   \n   .trust-preview h3 {\n     margin-top: 0;\n     font-size: 16px;\n     color: #333;\n   }\n   \n   .preview-badge {\n     display: inline-block;\n     padding: 6px 12px;\n     border-radius: 4px;\n     font-size: 14px;\n     color: white;\n     margin-right: 10px;\n   }\n   \n   /* Mobile accessibility styles */\n   @media (max-width: 768px) {\n     .container {\n       padding: 10px;\n     }\n     \n     .form-section {\n       padding: 15px;\n     }\n     \n     .progress-steps {\n       display: none;\n     }\n     \n     .mobile-step-indicator {\n       display: block !important;\n       text-align: center;\n       margin-bottom: 20px;\n     }\n     \n     /* Ensure touch targets are at least 44x44px */\n     button, \n     [role="button"], \n     a,\n     .checkbox-container,\n     input[type="checkbox"],\n     input[type="radio"],\n     input[type="submit"],\n     select,\n     .tooltip {\n       min-height: 44px;\n       min-width: 44px;\n     }\n     \n     /* Improve touch target sizes on mobile */\n     button {\n       padding: 12px 20px;\n       width: 100%;\n       margin: 8px 0;\n       font-size: 16px;\n     }\n     \n     .navigation-buttons {\n       flex-direction: column-reverse;\n       gap: 10px;\n     }\n     \n     /* Adjust form layouts for better touch interaction */\n     .form-section {\n       padding: 20px 16px;\n     }\n     \n     /* Improve checkbox touch targets */\n     .checkbox-container {\n       padding: 8px 0;\n       margin: 8px 0;\n     }\n     \n     .checkbox-container input[type="checkbox"] {\n       transform: scale(1.25);\n       margin-right: 12px;\n       margin-top: 6px;\n     }\n     \n     /* Larger tap target for tooltip */\n     .tooltip .tooltip-icon {\n       width: 30px;\n       height: 30px;\n       font-size: 16px;\n     }\n     \n     /* Adjust spacing between elements */\n     label {\n       margin-bottom: 8px;\n       display: block;\n     }\n     \n     input, select, textarea {\n       padding: 14px;\n       font-size: 16px; /* Prevents iOS zoom on focus */\n       margin-bottom: 16px;\n     }\n     \n     /* Improved error display */\n     .error {\n       padding: 8px 0;\n       font-size: 14px;\n     }\n   }\n   \n   /* Reduced motion preferences */\n   @media (prefers-reduced-motion: reduce) {\n     /* Remove all animations and transitions */\n     *, *::before, *::after {\n       animation-duration: 0.001ms !important;\n       animation-iteration-count: 1 !important;\n       transition-duration: 0.001ms !important;\n       scroll-behavior: auto !important;\n     }\n     \n     /* Specific elements that need animation removal */\n     .progress-indicator {\n       transition: none !important;\n     }\n     \n     .tooltip .tooltip-text {\n       transition: none !important;\n     }\n     \n     /* Replace animations with immediate state changes */\n     .tooltip:hover .tooltip-text {\n       visibility: visible;\n       opacity: 1;\n       transition: none !important;\n     }\n   }\n   \n   /* Focus styles and accessibility support */\n   :focus-visible {\n     outline: var(--focus-ring-width) solid var(--focus-ring-color);\n     outline-offset: 2px;\n     border-radius: 2px;\n   }\n   \n   /* High contrast mode support */\n   @media (forced-colors: active) {\n     .progress-indicator {\n       background-color: SelectedItem;\n     }\n     \n     button {\n       border: 1px solid ButtonText;\n     }\n     \n     :focus-visible {\n       outline: 3px solid CanvasText !important;\n       outline-offset: 3px;\n     }\n   }\n   \n   /* Skip link for keyboard users */\n   .skip-to-content {\n     position: absolute;\n     top: -5rem;\n     left: 0;\n     padding: 1rem;\n     background: var(--primary-color);\n     color: white;\n     z-index: 100;\n     opacity: 0;\n     transition: top 0.2s, opacity 0.2s;\n   }\n   \n   .skip-to-content:focus {\n     top: 0;\n     opacity: 1;\n   }\n   \n   /* Screen reader only text */\n   .sr-only {\n     position: absolute;\n     width: 1px;\n     height: 1px;\n     padding: 0;\n     margin: -1px;\n     overflow: hidden;\n     clip: rect(0, 0, 0, 0);\n     white-space: nowrap;\n     border-width: 0;\n   }\n   \n   /* Form validation visual cues */\n   input:invalid,\n   select:invalid,\n   textarea:invalid {\n     border-color: var(--error-color);\n   }\n   \n   /* Required fields indicator */\n   label.required::after {\n     content: "*";\n     color: var(--error-color);\n     margin-left: 2px;\n   }\n ','</style>\n      <div class="container" dir="').concat((null===(e=qe.getLanguageInfo(qe.currentLanguage))||void 0===e?void 0:e.direction)||"ltr",'">\n        ').concat(t,"\n      </div>\n    ")}},{key:"renderLoading",value:function(){return'\n      <div class="loading-container">\n        <div class="loading-spinner"></div>\n        <p>'.concat(ze("dashboard.loading"),"</p>\n      </div>\n    ")}},{key:"renderError",value:function(){return'\n      <div class="error-container">\n        <div class="alert alert-error" role="alert">\n          '.concat(this.error,'\n        </div>\n        <button \n          class="btn-primary" \n          onclick="this.getRootNode().host.loadDashboardData()"\n        >\n          ').concat(ze("dashboard.retry"),"\n        </button>\n      </div>\n    ")}},{key:"renderDashboard",value:function(){var e;return'\n      <div class="dashboard">\n        <div class="dashboard-header">\n          <h1>'.concat(ze("dashboard.welcome",{username:(null===(e=this.user)||void 0===e?void 0:e.username)||"User"}),'</h1>\n          <button \n            class="btn-secondary" \n            onclick="this.getRootNode().host.handleLogout()"\n          >\n            ').concat(ze("dashboard.logout"),'\n          </button>\n        </div>\n        \n        <div class="dashboard-content">\n          ').concat(this.renderVerificationHistory(),"\n          ").concat(this.renderPackages(),'\n        </div>\n        \n        <div class="dashboard-actions">\n          <button \n            class="btn-primary" \n            onclick="this.getRootNode().host.startNewVerification()"\n          >\n            ').concat(ze("dashboard.newVerification"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"renderVerificationHistory",value:function(){var e=this;return 0===this.verificationHistory.length?'\n        <div class="verification-history">\n          <h2>'.concat(ze("dashboard.verificationHistory"),'</h2>\n          <div class="empty-state">\n            <p>').concat(ze("dashboard.noHistory"),"</p>\n          </div>\n        </div>\n      "):'\n      <div class="verification-history">\n        <h2>'.concat(ze("dashboard.verificationHistory"),'</h2>\n        <div class="verification-cards">\n          ').concat(this.verificationHistory.map((function(t){return e.renderVerificationCard(t)})).join(""),"\n        </div>\n      </div>\n    ")}},{key:"renderVerificationCard",value:function(e){var t,n,r=new Date(e.verificationDate),o=qe.formatDate(r),i=ze("trustLevel.".concat(e.trustLevel))||e.trustLevel,a=e.score||0,s="#4CAF50";return"review"===e.trustLevel?s="#FFC107":"manual_review"===e.trustLevel?s="#9E9E9E":"not_eligible"===e.trustLevel&&(s="#757575"),'\n      <div class="verification-card">\n        <div class="verification-header">\n          <div class="trust-badge" style="background-color: '.concat(s,'">\n            ').concat(i,'\n          </div>\n          <div class="verification-date">\n            ').concat(o,'\n          </div>\n        </div>\n        \n        <div class="verification-body">\n          <div class="verification-score">\n            <span class="score-number">').concat(a,'</span>\n            <span class="score-max">/100</span>\n          </div>\n          \n          <div class="verification-details">\n            <p class="casl-key-id">CASL Key ID: ').concat(e.caslKeyId,'</p>\n            <p class="booking-info">\n              ').concat(null!==(t=e.booking)&&void 0!==t&&t.platform?"".concat(e.booking.platform):"","\n              ").concat(null!==(n=e.booking)&&void 0!==n&&n.checkInDate?" | Check-in: ".concat(qe.formatDate(new Date(e.booking.checkInDate))):"",'\n            </p>\n          </div>\n        </div>\n        \n        <div class="verification-actions">\n          <button \n            class="btn-link" \n            onclick="this.getRootNode().host.viewVerificationDetails(\'').concat(e.caslKeyId,"')\"\n          >\n            ").concat(ze("dashboard.viewDetails"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"renderPackages",value:function(){var e=this;return 0===this.packages.length?"":'\n      <div class="packages-section">\n        <h2>'.concat(ze("dashboard.availablePackages"),'</h2>\n        <div class="package-cards">\n          ').concat(this.packages.map((function(t){return e.renderPackageCard(t)})).join(""),"\n        </div>\n      </div>\n    ")}},{key:"renderPackageCard",value:function(e){return'\n      <div class="package-card">\n        <div class="package-header">\n          <h3>'.concat(e.name,'</h3>\n          <div class="package-price">\n            ').concat(qe.formatCurrency(e.price,e.currency),'\n          </div>\n        </div>\n        \n        <div class="package-body">\n          <p class="package-description">').concat(e.description,'</p>\n          <ul class="package-features">\n            ').concat(e.features.map((function(e){return"<li>".concat(e,"</li>")})).join(""),'\n          </ul>\n        </div>\n        \n        <div class="package-actions">\n          <button \n            class="btn-primary" \n            onclick="this.getRootNode().host.purchasePackage(\'').concat(e.id,'\')"\n            data-package-id="').concat(e.id,'"\n          >\n            ').concat(ze("dashboard.purchase"),"\n          </button>\n        </div>\n      </div>\n    ")}},{key:"viewVerificationDetails",value:(i=vn(fn().mark((function e(t){var n;return fn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=this.verificationHistory.find((function(e){return e.caslKeyId===t}))){e.next=4;break}throw new Error(ze("dashboard.verificationNotFound"));case 4:this.dispatchDashboardEvent("view-verification",{verification:n}),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error viewing verification details:",e.t0),this.error=e.t0.message,this.render();case 12:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return i.apply(this,arguments)})},{key:"startNewVerification",value:function(){0===this.verificationHistory.length||this.hasUnusedVerificationSlots()?this.dispatchDashboardEvent("new-verification"):this.dispatchDashboardEvent("show-packages")}},{key:"hasUnusedVerificationSlots",value:function(){var e;return(null===(e=this.user)||void 0===e||null===(e=e.purchasedPackages)||void 0===e?void 0:e.some((function(e){return e.remainingVerifications>0})))||!1}},{key:"purchasePackage",value:function(e){var t=this.packages.find((function(t){return t.id===e}));if(!t)return this.error=ze("dashboard.packageNotFound"),void this.render();this.dispatchDashboardEvent("purchase-package",{package:t,userId:this.user.id})}},{key:"handlePackagePurchased",value:function(e){this.user.purchasedPackages||(this.user.purchasedPackages=[]),this.user.purchasedPackages.push({packageId:e.id,purchaseDate:(new Date).toISOString(),remainingVerifications:e.verificationCount,expiryDate:e.expiryDate}),this.loadDashboardData()}},{key:"handleLogout",value:function(){var e=this;Xt.logoutUser().then((function(){e.dispatchDashboardEvent("logout")}))}},{key:"dispatchDashboardEvent",value:function(e){var t=new CustomEvent("casl-dashboard",{detail:{type:e,data:arguments.length>1&&void 0!==arguments[1]?arguments[1]:null},bubbles:!0,composed:!0});this.dispatchEvent(t)}},{key:"setupEventListeners",value:function(){var e=this;window.addEventListener("casl-package-purchased",(function(t){e.handlePackagePurchased(t.detail)}))}}],r&&gn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,a,s,c}(yn(HTMLElement));function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function En(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function In(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?En(Object(n),!0).forEach((function(t){_n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):En(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _n(e,t,n){return(t=An(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pn(){Pn=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Sn(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Sn(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function On(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Tn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){On(i,r,o,a,s,"next",e)}function s(e){On(i,r,o,a,s,"throw",e)}a(void 0)}))}}function jn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,An(r.key),r)}}function An(e){var t=function(e){if("object"!=Sn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sn(t)?t:t+""}customElements.define("casl-user-dashboard",kn);var Cn=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wixAppInstance=null,this.paymentInProgress=!1},t=[{key:"initWixPayment",value:function(){void 0!==window.wixSdk?(this.wixAppInstance=window.wixSdk,console.log("Wix SDK initialized for payments")):console.warn("Wix SDK not found - payment functionality may be limited")}},{key:"startPayment",value:(c=Tn(Pn().mark((function e(t,n){var r;return Pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.paymentInProgress){e.next=2;break}throw new Error("A payment is already in progress");case 2:return this.paymentInProgress=!0,e.prev=3,this.wixAppInstance||this.initWixPayment(),e.next=7,this.createPaymentIntent(t,n);case 7:if(r=e.sent,!this.wixAppInstance){e.next=14;break}return e.next=11,this.processWixPayment(r,t);case 11:case 16:return e.abrupt("return",e.sent);case 14:return e.next=16,this.processFallbackPayment(r,t);case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(3),console.error("Payment processing error:",e.t0),e.t0;case 23:return e.prev=23,this.paymentInProgress=!1,e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[3,19,23,26]])}))),function(e,t){return c.apply(this,arguments)})},{key:"createPaymentIntent",value:(s=Tn(Pn().mark((function e(t,n){var r,i,a;return Pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=In({"Content-Type":"application/json"},Xt.getAuthHeaders()),e.next=4,fetch("".concat(o,"/create-payment-intent"),{method:"POST",headers:r,body:JSON.stringify({packageId:t.id,userId:n,amount:t.price,currency:t.currency||"USD"})});case 4:if((i=e.sent).ok){e.next=10;break}return e.next=8,i.json();case 8:throw a=e.sent,new Error(a.message||"Failed to create payment intent");case 10:return e.next=12,i.json();case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t0=e.catch(0),console.error("Error creating payment intent:",e.t0),e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,15]])}))),function(e,t){return s.apply(this,arguments)})},{key:"processWixPayment",value:(a=Tn(Pn().mark((function e(t,n){var r=this;return Pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var i={id:t.id,amount:n.price,currency:n.currency||"USD",description:"CASL Key - ".concat(n.name),items:[{name:n.name,description:n.description,price:n.price,quantity:1}]};r.wixAppInstance.payments.startPayment(i).then((function(i){"paid"===i.status?r.verifyPayment(t.id,i.transactionId).then((function(t){e(In({success:!0,transactionId:i.transactionId,packageId:n.id,verificationCount:n.verificationCount},t))})).catch(o):o(new Error(i.error||"Payment failed"))})).catch((function(e){console.error("Wix payment error:",e),o(e)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"processFallbackPayment",value:(i=Tn(Pn().mark((function e(t,n){var r,i,a,s;return Pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/create-payment-url"),{method:"POST",headers:In({"Content-Type":"application/json"},Xt.getAuthHeaders()),body:JSON.stringify({intentId:t.id,packageId:n.id,returnUrl:window.location.href})});case 2:if((r=e.sent).ok){e.next=8;break}return e.next=6,r.json();case 6:throw i=e.sent,new Error(i.message||"Failed to create payment URL");case 8:return e.next=10,r.json();case 10:return a=e.sent,s=a.paymentUrl,sessionStorage.setItem("casl_payment_intent",t.id),sessionStorage.setItem("casl_package_id",n.id),window.location.href=s,e.abrupt("return",new Promise((function(){})));case 16:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"verifyPayment",value:(r=Tn(Pn().mark((function e(t,n){var r,i;return Pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(o,"/verify-payment"),{method:"POST",headers:In({"Content-Type":"application/json"},Xt.getAuthHeaders()),body:JSON.stringify({intentId:t,transactionId:n})});case 2:if((r=e.sent).ok){e.next=8;break}return e.next=6,r.json();case 6:throw i=e.sent,new Error(i.message||"Payment verification failed");case 8:return e.next=10,r.json();case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"checkPendingPayment",value:(n=Tn(Pn().mark((function e(){var t,n,r,i,a,s,c;return Pn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=sessionStorage.getItem("casl_payment_intent"),n=sessionStorage.getItem("casl_package_id"),t&&n){e.next=4;break}return e.abrupt("return",null);case 4:return e.prev=4,sessionStorage.removeItem("casl_payment_intent"),sessionStorage.removeItem("casl_package_id"),e.next=9,fetch("".concat(o,"/check-payment/").concat(t),{method:"GET",headers:In({"Content-Type":"application/json"},Xt.getAuthHeaders())});case 9:if((r=e.sent).ok){e.next=15;break}return e.next=13,r.json();case 13:throw i=e.sent,new Error(i.message||"Payment status check failed");case 15:return e.next=17,r.json();case 17:if("succeeded"!==(a=e.sent).status){e.next=29;break}return e.next=21,fetch("".concat(o,"/packages/").concat(n),{method:"GET",headers:{"Content-Type":"application/json"}});case 21:if((s=e.sent).ok){e.next=24;break}throw new Error("Failed to load package data");case 24:return e.next=26,s.json();case 26:return c=e.sent,this.dispatchPaymentSuccess({id:n,verificationCount:c.verificationCount,expiryDate:a.expiryDate,transactionId:a.transactionId}),e.abrupt("return",{success:!0,packageId:n,verificationCount:c.verificationCount});case 29:return e.abrupt("return",{success:!1,error:a.error||"Payment not completed"});case 32:return e.prev=32,e.t0=e.catch(4),console.error("Error checking pending payment:",e.t0),e.abrupt("return",{success:!1,error:e.t0.message});case 36:case"end":return e.stop()}}),e,this,[[4,32]])}))),function(){return n.apply(this,arguments)})},{key:"dispatchPaymentSuccess",value:function(e){var t=new CustomEvent("casl-package-purchased",{detail:e,bubbles:!0,composed:!0});window.dispatchEvent(t)}}],t&&jn(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n,r,i,a,s,c}());function Dn(e){return Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dn(e)}function Ln(){Ln=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(t,n,r,o){var i=n&&n.prototype instanceof h?n:h,a=Object.create(i.prototype);return c(a,"_invoke",function(t,n,r){var o=1;return function(i,a){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var c=x(s,r);if(c){if(c===d)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var u=l(t,n,r);if("normal"===u.type){if(o=r.done?4:2,u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=4,r.method="throw",r.arg=u.arg)}}}(t,r,new E(o||[])),!0),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d={};function h(){}function f(){}function p(){}var v={};c(v,i,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(I([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=p.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(o,i,a,s){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Dn(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var o;c(this,"_invoke",(function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}),!0)}function x(t,n){var r=n.method,o=t.i[r];if(o===e)return n.delegate=null,"throw"===r&&t.i.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(o,t.i,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,d;var a=i.arg;return a?a.done?(n[t.r]=a.value,n.next=t.n,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,d):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,d)}function k(e){this.tryEntries.push(e)}function S(t){var n=t[4]||{};n.type="normal",n.arg=e,t[4]=n}function E(e){this.tryEntries=[[-1]],e.forEach(k,this),this.reset(!0)}function I(t){if(null!=t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(Dn(t)+" is not iterable")}return f.prototype=p,c(y,"constructor",p),c(p,"constructor",f),f.displayName=c(p,s,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,c(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},t.awrap=function(e){return{__await:e}},b(w.prototype),c(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new w(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(y),c(y,s,"Generator"),c(y,i,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},t.values=I,E.prototype={constructor:E,reset:function(t){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(e){a.type="throw",a.arg=t,n.next=e}for(var o=n.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i[4],s=this.prev,c=i[1],u=i[2];if(-1===i[0])return r("end"),!1;if(!c&&!u)throw Error("try statement without catch or finally");if(null!=i[0]&&i[0]<=s){if(s<c)return this.method="next",this.arg=e,r(c),!0;if(s<u)return r(u),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=t&&t<=o[2]&&(o=null);var i=o?o[4]:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o[2],d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),S(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={i:I(t),r:n,n:r},"next"===this.method&&(this.arg=e),d}},t}function Rn(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function Nn(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Rn(i,r,o,a,s,"next",e)}function s(e){Rn(i,r,o,a,s,"throw",e)}a(void 0)}))}}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Vn(r.key),r)}}function Vn(e){var t=function(e){if("object"!=Dn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=Dn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Dn(t)?t:t+""}function Un(e){var t="function"==typeof Map?new Map:void 0;return Un=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(Mn())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return n&&Gn(o,n.prototype),o}(e,arguments,zn(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),Gn(n,e)},Un(e)}function Mn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mn=function(){return!!e})()}function Gn(e,t){return Gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gn(e,t)}function zn(e){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},zn(e)}var qn=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=function(e,t,n){return t=zn(t),function(e,t){if(t&&("object"==Dn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mn()?Reflect.construct(t,n||[],zn(e).constructor):t.apply(e,n))}(this,t)).attachShadow({mode:"open"}),e.initializeState(),e.render(),e.setupEventListeners(),e.checkAuthentication(),e.checkPendingPayment(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gn(e,t)}(t,e),n=t,r=[{key:"initializeState",value:function(){this.currentView="loading",this.error=null,this.user=null,this.selectedVerification=null}},{key:"connectedCallback",value:function(){console.log("CASL App component connected")}},{key:"checkAuthentication",value:(a=Nn(Ln().mark((function e(){var t;return Ln().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xt.getCurrentUser();case 3:(t=e.sent).isAuthenticated?(this.user=t.user,this.currentView="dashboard"):this.currentView="auth",e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Authentication check error:",e.t0),this.error=e.t0.message,this.currentView="auth";case 12:this.render();case 13:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return a.apply(this,arguments)})},{key:"checkPendingPayment",value:(i=Nn(Ln().mark((function e(){var t;return Ln().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cn.checkPendingPayment();case 3:(t=e.sent)&&t.success?this.showNotification("Payment successful! Your package has been activated."):t&&!t.success&&this.showNotification(t.error||"Payment was not completed","error"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error checking pending payment:",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return i.apply(this,arguments)})},{key:"render",value:function(){var e,t;switch(this.currentView){case"loading":t=this.renderLoading();break;case"auth":t=this.renderAuth();break;case"dashboard":t=this.renderDashboard();break;case"verification":t=this.renderVerification();break;case"verification-details":t=this.renderVerificationDetails();break;default:t=this.renderError("Invalid view")}this.shadowRoot.innerHTML="\n      <style>".concat('\n    :host {\n      display: block;\n      font-family: Arial, sans-serif;\n      \n      /* Primary colors with contrast-safe text colors */\n      --primary-color: #4285F4;\n      --primary-color-dark: #1a5dd4;\n      --on-primary-color: #ffffff;\n      \n      --success-color: #4CAF50;\n      --on-success-color: #ffffff;\n      \n      --warning-color: #EC9F05; /* Darkened for better contrast */\n      --on-warning-color: #000000;\n      \n      --error-color: #c62828;\n      --on-error-color: #ffffff;\n      \n      --neutral-color: #5C5C5C; /* Darkened for better contrast */\n      --on-neutral-color: #ffffff;\n      \n      --surface-color: #ffffff;\n      --on-surface-color: #212121;\n      \n      --disabled-color: #9E9E9E;\n      --on-disabled-color: #212121;\n      \n      --border-radius: 8px;\n      --box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n      --focus-ring-color: #4285F4;\n      --focus-ring-width: 3px;\n    }\n    \n    .container {\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 20px;\n    }\n    \n    .form-section {\n      background-color: var(--surface-color);\n      padding: 20px;\n      border-radius: var(--border-radius);\n      margin-bottom: 20px;\n      box-shadow: var(--box-shadow);\n    }\n    \n    button {\n      padding: 10px 20px;\n      background-color: var(--primary-color);\n      color: var(--on-primary-color);\n      border: none;\n      border-radius: 4px;\n      cursor: pointer;\n      margin: 5px;\n      transition: background-color 0.2s, opacity 0.2s;\n      min-height: 44px;\n    }\n    \n    button:hover {\n      background-color: var(--primary-color-dark);\n    }\n    \n    button:focus {\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 2px;\n    }\n    \n    button:disabled {\n      background-color: var(--disabled-color);\n      color: var(--on-disabled-color);\n      cursor: not-allowed;\n    }\n    \n    button.success {\n      background-color: var(--success-color);\n      color: var(--on-success-color);\n    }\n    \n    button.success:hover {\n      background-color: #3d8b40;\n    }\n    \n    button.warning {\n      background-color: var(--warning-color);\n      color: var(--on-warning-color);\n    }\n    \n    button.warning:hover {\n      background-color: #c78500;\n    }\n    \n    button.neutral {\n      background-color: var(--neutral-color);\n      color: var(--on-neutral-color);\n    }\n    \n    button.neutral:hover {\n      background-color: #3d3d3d;\n    }\n    \n    input, select, textarea {\n      width: 100%;\n      padding: 12px;\n      margin-bottom: 10px;\n      border: 1px solid #ddd;\n      border-radius: 4px;\n      font-size: 16px;\n      transition: border-color 0.2s;\n      min-height: 44px;\n    }\n    \n    input:focus, select:focus, textarea:focus {\n      border-color: var(--primary-color);\n      outline: var(--focus-ring-width) solid var(--focus-ring-color);\n      outline-offset: 0;\n    }\n    \n    textarea {\n      resize: vertical;\n      min-height: 80px;\n    }\n    \n    label {\n      display: block;\n      margin-bottom: 8px;\n      font-weight: bold;\n    }\n    \n    .error {\n      color: var(--error-color);\n      font-size: 14px;\n      margin-top: -5px;\n      margin-bottom: 10px;\n    }\n    \n    .navigation-buttons {\n      display: flex;\n      justify-content: space-between;\n      margin-top: 20px;\n    }\n    \n    .alert {\n      padding: 12px 15px;\n      border-radius: 4px;\n      margin-bottom: 15px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n    \n    .alert-success {\n      background-color: #e8f5e9;\n      color: #2e7d32;\n      border-left: 4px solid var(--success-color);\n    }\n    \n    .alert-error {\n      background-color: #ffebee;\n      color: var(--error-color);\n      border-left: 4px solid var(--error-color);\n    }\n    \n    .alert-info {\n      background-color: #e3f2fd;\n      color: #0d47a1;\n      border-left: 4px solid var(--primary-color);\n    }\n    \n    .alert-warning {\n      background-color: #fff8e1;\n      color: #f57f17;\n      border-left: 4px solid var(--warning-color);\n    }\n    \n    .progress-steps {\n      display: flex;\n      justify-content: space-between;\n      margin-bottom: 30px;\n    }\n    \n    .step {\n      text-align: center;\n      position: relative;\n      width: 25%;\n    }\n    \n    .step-indicator {\n      width: 30px;\n      height: 30px;\n      border-radius: 50%;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin: 0 auto 5px;\n      z-index: 2;\n      position: relative;\n    }\n    \n    .progress-bar {\n      height: 8px;\n      background-color: #eee;\n      border-radius: 4px;\n      margin-bottom: 25px;\n      position: relative;\n      overflow: hidden;\n    }\n    \n    .progress-indicator {\n      position: absolute;\n      left: 0;\n      top: 0;\n      height: 100%;\n      background-color: var(--primary-color);\n      border-radius: 4px;\n      transition: width 0.3s ease;\n    }\n    \n    .screenshot-container {\n      border: 2px dashed #ccc;\n      padding: 20px;\n      text-align: center;\n      margin-bottom: 20px;\n      border-radius: 4px;\n      transition: border-color 0.2s;\n      position: relative;\n      min-height: 150px;\n    }\n    \n    .screenshot-container:hover {\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-container.drag-over {\n      background-color: #f0f7ff;\n      border-color: var(--primary-color);\n    }\n    \n    .screenshot-preview {\n      max-width: 100%;\n      max-height: 300px;\n      margin-top: 10px;\n      border-radius: 4px;\n    }\n    \n   .file-input {\n     position: absolute;\n     width: 100%;\n     height: 100%;\n     top: 0;\n     left: 0;\n     opacity: 0;\n     cursor: pointer;\n   }\n   \n   .result-card {\n     background-color: white;\n     padding: 30px;\n     border-radius: var(--border-radius);\n     box-shadow: var(--box-shadow);\n     text-align: center;\n     margin-bottom: 20px;\n   }\n   \n   .trust-badge {\n     display: inline-block;\n     padding: 10px 20px;\n     border-radius: 4px;\n     font-weight: bold;\n     color: white;\n     margin: 15px 0;\n   }\n   \n   .score-display {\n     margin: 20px 0;\n   }\n   \n   .score-number {\n     font-size: 48px;\n     font-weight: bold;\n   }\n   \n   .score-max {\n     color: #666;\n   }\n   \n   .result-message {\n     padding: 15px;\n     background-color: #f5f5f5;\n     border-radius: 8px;\n     font-size: 18px;\n     margin: 20px 0;\n   }\n   \n   .adjustments-list {\n     margin-top: 30px;\n     text-align: left;\n   }\n   \n   .adjustment-item {\n     display: flex;\n     justify-content: space-between;\n     padding: 10px;\n     border-bottom: 1px solid #eee;\n   }\n   \n   .adjustment-points {\n     font-weight: bold;\n   }\n   \n   .adjustment-positive {\n     color: var(--success-color);\n   }\n   \n   .adjustment-negative {\n     color: var(--error-color);\n   }\n   \n   .tooltip {\n     position: relative;\n     display: inline-block;\n     margin-left: 5px;\n     cursor: help;\n   }\n   \n   .tooltip .tooltip-icon {\n     background-color: #ddd;\n     color: #333;\n     width: 24px;\n     height: 24px;\n     border-radius: 50%;\n     display: inline-flex;\n     align-items: center;\n     justify-content: center;\n     font-size: 14px;\n     font-weight: bold;\n   }\n   \n   .tooltip .tooltip-text {\n     visibility: hidden;\n     width: 250px;\n     background-color: #333;\n     color: #fff;\n     text-align: center;\n     border-radius: 6px;\n     padding: 8px;\n     position: absolute;\n     z-index: 1;\n     bottom: 125%;\n     left: 50%;\n     transform: translateX(-50%);\n     opacity: 0;\n     transition: opacity 0.3s;\n     font-size: 14px;\n     font-weight: normal;\n   }\n   \n   .tooltip:hover .tooltip-text {\n     visibility: visible;\n     opacity: 1;\n   }\n   \n   .checkbox-container {\n     display: flex;\n     align-items: flex-start;\n     margin-bottom: 10px;\n     min-height: 44px;\n   }\n   \n   .checkbox-container input[type="checkbox"] {\n     width: auto;\n     min-width: 24px;\n     min-height: 24px;\n     margin-right: 10px;\n     margin-top: 3px;\n   }\n   \n   .checkbox-label {\n     font-weight: normal;\n     flex: 1;\n   }\n   \n   .trust-preview {\n     background-color: #f5f5f5;\n     border: 1px solid #ddd;\n     border-radius: var(--border-radius);\n     padding: 15px;\n     margin-top: 20px;\n   }\n   \n   .trust-preview h3 {\n     margin-top: 0;\n     font-size: 16px;\n     color: #333;\n   }\n   \n   .preview-badge {\n     display: inline-block;\n     padding: 6px 12px;\n     border-radius: 4px;\n     font-size: 14px;\n     color: white;\n     margin-right: 10px;\n   }\n   \n   /* Mobile accessibility styles */\n   @media (max-width: 768px) {\n     .container {\n       padding: 10px;\n     }\n     \n     .form-section {\n       padding: 15px;\n     }\n     \n     .progress-steps {\n       display: none;\n     }\n     \n     .mobile-step-indicator {\n       display: block !important;\n       text-align: center;\n       margin-bottom: 20px;\n     }\n     \n     /* Ensure touch targets are at least 44x44px */\n     button, \n     [role="button"], \n     a,\n     .checkbox-container,\n     input[type="checkbox"],\n     input[type="radio"],\n     input[type="submit"],\n     select,\n     .tooltip {\n       min-height: 44px;\n       min-width: 44px;\n     }\n     \n     /* Improve touch target sizes on mobile */\n     button {\n       padding: 12px 20px;\n       width: 100%;\n       margin: 8px 0;\n       font-size: 16px;\n     }\n     \n     .navigation-buttons {\n       flex-direction: column-reverse;\n       gap: 10px;\n     }\n     \n     /* Adjust form layouts for better touch interaction */\n     .form-section {\n       padding: 20px 16px;\n     }\n     \n     /* Improve checkbox touch targets */\n     .checkbox-container {\n       padding: 8px 0;\n       margin: 8px 0;\n     }\n     \n     .checkbox-container input[type="checkbox"] {\n       transform: scale(1.25);\n       margin-right: 12px;\n       margin-top: 6px;\n     }\n     \n     /* Larger tap target for tooltip */\n     .tooltip .tooltip-icon {\n       width: 30px;\n       height: 30px;\n       font-size: 16px;\n     }\n     \n     /* Adjust spacing between elements */\n     label {\n       margin-bottom: 8px;\n       display: block;\n     }\n     \n     input, select, textarea {\n       padding: 14px;\n       font-size: 16px; /* Prevents iOS zoom on focus */\n       margin-bottom: 16px;\n     }\n     \n     /* Improved error display */\n     .error {\n       padding: 8px 0;\n       font-size: 14px;\n     }\n   }\n   \n   /* Reduced motion preferences */\n   @media (prefers-reduced-motion: reduce) {\n     /* Remove all animations and transitions */\n     *, *::before, *::after {\n       animation-duration: 0.001ms !important;\n       animation-iteration-count: 1 !important;\n       transition-duration: 0.001ms !important;\n       scroll-behavior: auto !important;\n     }\n     \n     /* Specific elements that need animation removal */\n     .progress-indicator {\n       transition: none !important;\n     }\n     \n     .tooltip .tooltip-text {\n       transition: none !important;\n     }\n     \n     /* Replace animations with immediate state changes */\n     .tooltip:hover .tooltip-text {\n       visibility: visible;\n       opacity: 1;\n       transition: none !important;\n     }\n   }\n   \n   /* Focus styles and accessibility support */\n   :focus-visible {\n     outline: var(--focus-ring-width) solid var(--focus-ring-color);\n     outline-offset: 2px;\n     border-radius: 2px;\n   }\n   \n   /* High contrast mode support */\n   @media (forced-colors: active) {\n     .progress-indicator {\n       background-color: SelectedItem;\n     }\n     \n     button {\n       border: 1px solid ButtonText;\n     }\n     \n     :focus-visible {\n       outline: 3px solid CanvasText !important;\n       outline-offset: 3px;\n     }\n   }\n   \n   /* Skip link for keyboard users */\n   .skip-to-content {\n     position: absolute;\n     top: -5rem;\n     left: 0;\n     padding: 1rem;\n     background: var(--primary-color);\n     color: white;\n     z-index: 100;\n     opacity: 0;\n     transition: top 0.2s, opacity 0.2s;\n   }\n   \n   .skip-to-content:focus {\n     top: 0;\n     opacity: 1;\n   }\n   \n   /* Screen reader only text */\n   .sr-only {\n     position: absolute;\n     width: 1px;\n     height: 1px;\n     padding: 0;\n     margin: -1px;\n     overflow: hidden;\n     clip: rect(0, 0, 0, 0);\n     white-space: nowrap;\n     border-width: 0;\n   }\n   \n   /* Form validation visual cues */\n   input:invalid,\n   select:invalid,\n   textarea:invalid {\n     border-color: var(--error-color);\n   }\n   \n   /* Required fields indicator */\n   label.required::after {\n     content: "*";\n     color: var(--error-color);\n     margin-left: 2px;\n   }\n ','</style>\n      <div class="app-container" dir="').concat((null===(e=qe.getLanguageInfo(qe.currentLanguage))||void 0===e?void 0:e.direction)||"ltr",'">\n        ').concat(this.renderHeader(),'\n        <div class="app-content">\n          ').concat(t,"\n        </div>\n        ").concat(this.renderFooter(),"\n      </div>\n    ")}},{key:"renderHeader",value:function(){return'\n      <header class="app-header">\n        <div class="branding">\n          <h1>CASL Key Verification</h1>\n        </div>\n        <div class="language-selector">\n          '.concat(qe.renderLanguageSelector(),"\n        </div>\n      </header>\n    ")}},{key:"renderFooter",value:function(){return'\n      <footer class="app-footer">\n        <p>¬© '.concat((new Date).getFullYear()," CASL Key Verification. All rights reserved.</p>\n      </footer>\n    ")}},{key:"renderLoading",value:function(){return'\n      <div class="loading-container">\n        <div class="loading-spinner"></div>\n        <p>'.concat(ze("app.loading"),"</p>\n      </div>\n    ")}},{key:"renderAuth",value:function(){return"<casl-authentication></casl-authentication>"}},{key:"renderDashboard",value:function(){return"<casl-user-dashboard></casl-user-dashboard>"}},{key:"renderVerification",value:function(){return'\n      <div class="verification-container">\n        <casl-verification></casl-verification>\n      </div>\n    '}},{key:"renderVerificationDetails",value:function(){var e,t,n;if(!this.selectedVerification)return this.renderError("No verification selected");var r=new Date(this.selectedVerification.verificationDate),o=qe.formatDate(r),i=ze("trustLevel.".concat(this.selectedVerification.trustLevel))||this.selectedVerification.trustLevel;return'\n      <div class="verification-details">\n        <div class="back-button">\n          <button onclick="this.getRootNode().host.navigateTo(\'dashboard\')">\n            ‚Üê '.concat(ze("app.backToDashboard"),"\n          </button>\n        </div>\n        \n        <h2>").concat(ze("app.verificationDetails"),'</h2>\n        \n        <div class="details-card">\n          <div class="detail-header">\n            <h3>CASL Key ID: ').concat(this.selectedVerification.caslKeyId,'</h3>\n            <p class="verification-date">').concat(o,'</p>\n          </div>\n          \n          <div class="detail-body">\n            <div class="trust-level-section">\n              <h4>').concat(ze("app.trustLevel"),'</h4>\n              <div class="trust-badge">').concat(i,'</div>\n              <div class="score">\n                <span class="score-number">').concat(this.selectedVerification.score,'</span>\n                <span class="score-max">/100</span>\n              </div>\n            </div>\n            \n            <div class="verification-methods">\n              <h4>').concat(ze("app.verificationMethods"),"</h4>\n              <ul>\n                ").concat(this.selectedVerification.verification.verificationType?"<li>".concat(ze("app."+this.selectedVerification.verification.verificationType),"</li>"):"","\n                ").concat(this.selectedVerification.verification.backgroundCheckStatus?"<li>".concat(ze("app.backgroundCheck"),"</li>"):"","\n                ").concat(this.selectedVerification.verification.idVerificationStatus?"<li>".concat(ze("app.idVerification"),"</li>"):"","\n                ").concat(this.selectedVerification.verification.phoneVerificationStatus?"<li>".concat(ze("app.phoneVerification"),"</li>"):"","\n                ").concat(this.selectedVerification.verification.socialVerificationStatus?"<li>".concat(ze("app.socialVerification"),"</li>"):"",'\n              </ul>\n            </div>\n            \n            <div class="booking-details">\n              <h4>').concat(ze("app.bookingDetails"),"</h4>\n              <table>\n                <tr>\n                  <th>").concat(ze("app.platform"),"</th>\n                  <td>").concat((null===(e=this.selectedVerification.booking)||void 0===e?void 0:e.platform)||"-","</td>\n                </tr>\n                <tr>\n                  <th>").concat(ze("app.checkInDate"),"</th>\n                  <td>").concat(null!==(t=this.selectedVerification.booking)&&void 0!==t&&t.checkInDate?qe.formatDate(new Date(this.selectedVerification.booking.checkInDate)):"-","</td>\n                </tr>\n                <tr>\n                  <th>").concat(ze("app.checkOutDate"),"</th>\n                  <td>").concat(null!==(n=this.selectedVerification.booking)&&void 0!==n&&n.checkOutDate?qe.formatDate(new Date(this.selectedVerification.booking.checkOutDate)):"-",'</td>\n                </tr>\n              </table>\n            </div>\n            \n            <div class="score-factors">\n              <h4>').concat(ze("app.scoreFactors"),"</h4>\n              ").concat(this.selectedVerification.verification.adjustments&&this.selectedVerification.verification.adjustments.length>0?"\n                <ul>\n                  ".concat(this.selectedVerification.verification.adjustments.map((function(e){return'\n                    <li class="'.concat(e.points>0?"positive":"negative",'">\n                      ').concat(e.reason," (").concat(e.points>0?"+":"").concat(e.points,")\n                    </li>\n                  ")})).join(""),"\n                </ul>\n              "):"\n                <p>".concat(ze("app.noScoreFactors"),"</p>\n              "),'\n            </div>\n          </div>\n          \n          <div class="detail-actions">\n            <button \n              class="btn-primary" \n              onclick="this.getRootNode().host.printVerification(\'').concat(this.selectedVerification.caslKeyId,"')\"\n            >\n              ").concat(ze("app.printVerification"),"\n            </button>\n          </div>\n        </div>\n      </div>\n    ")}},{key:"renderError",value:function(e){return'\n      <div class="error-container">\n        <div class="alert alert-error" role="alert">\n          '.concat(e||this.error||ze("app.genericError"),'\n        </div>\n        <button \n          class="btn-primary" \n          onclick="this.getRootNode().host.navigateTo(\'dashboard\')"\n        >\n          ').concat(ze("app.retry"),"\n        </button>\n      </div>\n    ")}},{key:"showNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=document.createElement("div");n.className="notification notification-".concat(t),n.textContent=e;var r=document.createElement("button");r.className="notification-close",r.innerHTML="&times;",r.onclick=function(){return n.remove()},n.appendChild(r),this.shadowRoot.appendChild(n),setTimeout((function(){n.parentNode&&n.remove()}),5e3)}},{key:"navigateTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.currentView=e,"verification-details"===e&&t&&(this.selectedVerification=t.verification),this.render()}},{key:"printVerification",value:function(e){var t,n,r,o=window.open("","_blank");if(o){var i=this.selectedVerification,a=new Date(i.verificationDate),s=qe.formatDate(a),c=ze("trustLevel.".concat(i.trustLevel))||i.trustLevel;o.document.write("\n      <!DOCTYPE html>\n      <html>\n      <head>\n        <title>CASL Key Verification - ".concat(i.caslKeyId,"</title>\n        <style>\n          body {\n            font-family: Arial, sans-serif;\n            margin: 2cm;\n            color: #333;\n            line-height: 1.5;\n          }\n          \n          h1, h2, h3, h4 {\n            color: #2c3e50;\n          }\n          \n          .header {\n            text-align: center;\n            margin-bottom: 2em;\n            border-bottom: 1px solid #eee;\n            padding-bottom: 1em;\n          }\n          \n          .logo {\n            font-size: 24px;\n            font-weight: bold;\n          }\n          \n          .verification-id {\n            font-size: 18px;\n            margin: 1em 0;\n          }\n          \n          .verification-date {\n            color: #7f8c8d;\n          }\n          \n          .trust-badge {\n            display: inline-block;\n            padding: 0.5em 1em;\n            border-radius: 4px;\n            color: white;\n            font-weight: bold;\n            margin: 1em 0;\n            background-color: ").concat("verified"===i.trustLevel?"#4CAF50":"review"===i.trustLevel?"#FFC107":"manual_review"===i.trustLevel?"#9E9E9E":"#757575",';\n          }\n          \n          .score {\n            font-size: 24px;\n            margin: 1em 0;\n          }\n          \n          .section {\n            margin: 1.5em 0;\n          }\n          \n          table {\n            width: 100%;\n            border-collapse: collapse;\n            margin: 1em 0;\n          }\n          \n          th, td {\n            padding: 0.5em;\n            text-align: left;\n            border-bottom: 1px solid #eee;\n          }\n          \n          th {\n            width: 30%;\n            font-weight: bold;\n          }\n          \n          .footer {\n            margin-top: 2em;\n            text-align: center;\n            font-size: 14px;\n            color: #7f8c8d;\n          }\n          \n          .verification-link {\n            margin-top: 1em;\n            font-size: 12px;\n          }\n          \n          @media print {\n            body {\n              font-size: 12pt;\n            }\n            \n            button {\n              display: none;\n            }\n          }\n        </style>\n      </head>\n      <body>\n        <div class="header">\n          <div class="logo">CASL Key Verification</div>\n          <div class="verification-id">ID: ').concat(i.caslKeyId,'</div>\n          <div class="verification-date">Verified on ').concat(s,'</div>\n        </div>\n        \n        <div class="section">\n          <h2>Trust Level</h2>\n          <div class="trust-badge">').concat(c,'</div>\n          <div class="score">\n            <span class="score-number">').concat(i.score,'</span>\n            <span class="score-max">/100</span>\n          </div>\n        </div>\n        \n        <div class="section">\n          <h2>Verification Methods</h2>\n          <table>\n            <tr>\n              <th>Primary Method</th>\n              <td>').concat(ze("app."+(i.verification.verificationType||"notSpecified")),"</td>\n            </tr>\n            ").concat(i.verification.backgroundCheckStatus?"\n              <tr>\n                <th>Background Check</th>\n                <td>".concat(ze("app.completed"),"</td>\n              </tr>\n            "):"","\n            ").concat(i.verification.idVerificationStatus?"\n              <tr>\n                <th>ID Verification</th>\n                <td>".concat(ze("app.completed"),"</td>\n              </tr>\n            "):"","\n            ").concat(i.verification.phoneVerificationStatus?"\n              <tr>\n                <th>Phone Verification</th>\n                <td>".concat(ze("app.completed"),"</td>\n              </tr>\n            "):"","\n            ").concat(i.verification.socialVerificationStatus?"\n              <tr>\n                <th>Social Media Verification</th>\n                <td>".concat(ze("app.completed"),"</td>\n              </tr>\n            "):"",'\n          </table>\n        </div>\n        \n        <div class="section">\n          <h2>Booking Information</h2>\n          <table>\n            <tr>\n              <th>Platform</th>\n              <td>').concat((null===(t=i.booking)||void 0===t?void 0:t.platform)||"-","</td>\n            </tr>\n            <tr>\n              <th>Check-in Date</th>\n              <td>").concat(null!==(n=i.booking)&&void 0!==n&&n.checkInDate?qe.formatDate(new Date(i.booking.checkInDate)):"-","</td>\n            </tr>\n            <tr>\n              <th>Check-out Date</th>\n              <td>").concat(null!==(r=i.booking)&&void 0!==r&&r.checkOutDate?qe.formatDate(new Date(i.booking.checkOutDate)):"-",'</td>\n            </tr>\n          </table>\n        </div>\n        \n        <div class="footer">\n          <p>This verification certificate was generated by CASL Key Verification System.</p>\n          <p>¬© ').concat((new Date).getFullYear(),' CASL Key Verification</p>\n          <div class="verification-link">\n            Verify this certificate online at: https://casl-key.example.com/verify/').concat(i.caslKeyId,"\n          </div>\n        </div>\n        \n        <script>\n          // Auto-print\n          window.onload = function() {\n            window.print();\n          };\n        <\/script>\n      </body>\n      </html>\n    ")),o.document.close()}else this.showNotification("Please allow pop-ups to print verification","error")}},{key:"handleAuthEvent",value:function(e){var t=e.detail,n=t.type,r=t.data;switch(n){case"authenticated":this.user=r,this.navigateTo("dashboard");break;case"logged-out":this.user=null,this.navigateTo("auth");break;case"registration-pending":this.showNotification("Registration successful! Please check your email to confirm your account.")}}},{key:"handleDashboardEvent",value:function(e){var t=e.detail,n=t.type,r=t.data;switch(n){case"new-verification":this.navigateTo("verification");break;case"view-verification":this.navigateTo("verification-details",r);break;case"purchase-package":this.handlePackagePurchase(r);break;case"logout":this.user=null,this.navigateTo("auth")}}},{key:"handleVerificationEvent",value:function(e){var t=this,n=e.detail,r=n.caslKeyId;n.trustLevel,n.verificationData,this.showNotification("Verification complete! Your CASL Key ID is ".concat(r)),setTimeout((function(){t.navigateTo("dashboard")}),2e3)}},{key:"handlePackagePurchase",value:(o=Nn(Ln().mark((function e(t){var n;return Ln().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Cn.startPayment(t.package,t.userId);case 3:(n=e.sent)&&n.success&&(this.showNotification("Payment successful! Your package has been activated."),this.navigateTo("dashboard")),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Payment error:",e.t0),this.showNotification(e.t0.message||"Payment processing error","error");case 11:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return o.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;this.addEventListener("casl-auth",this.handleAuthEvent.bind(this)),this.addEventListener("casl-dashboard",this.handleDashboardEvent.bind(this)),this.addEventListener("verificationComplete",this.handleVerificationEvent.bind(this)),document.addEventListener("caslLanguageChanged",(function(){e.render()}))}},{key:"handleLanguageChange",value:function(e){var t=this,n=e.target.value;n&&qe.changeLanguage(n).then((function(){t.render()}))}}],r&&Fn(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,o,i,a}(Un(HTMLElement));return customElements.define("casl-app",qn),document.addEventListener("DOMContentLoaded",(function(){if(B.addSkipLink("main-content"),document.documentElement.lang=document.documentElement.lang||"en",window.matchMedia("(forced-colors: active)").matches&&document.body.classList.add("high-contrast-mode"),window.matchMedia("(prefers-reduced-motion: reduce)").matches&&document.body.classList.add("reduced-motion"),window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",(function(e){e.matches?document.body.classList.add("reduced-motion"):document.body.classList.remove("reduced-motion")})),!document.getElementById("main-content")){var e=document.querySelector("main")||document.createElement("main");if(e.id="main-content",e.setAttribute("tabindex","-1"),!document.querySelector("main")){var t=document.createElement("div");Array.from(document.body.children).forEach((function(e){"SCRIPT"!==e.tagName&&t.appendChild(e)})),e.appendChild(t),document.body.appendChild(e)}}})),console.log("\nCASL Key Verification System v1.0.0\n\nUsage Options:\n\n1. Use all-in-one app component:\n   <casl-app></casl-app>\n   \n   This component includes authentication, dashboard, and verification all in one.\n\n2. Use individual components:\n\n   a. For authentication alone:\n      <casl-authentication></casl-authentication>\n   \n   b. For the user dashboard:\n      <casl-user-dashboard></casl-user-dashboard>\n   \n   c. For the verification process:\n      <casl-verification></casl-verification>\n\n3. Listen for events:\n   \n   a. Authentication events:\n      document.querySelector('casl-authentication').addEventListener('casl-auth', (event) => {\n        console.log('Auth event:', event.detail);\n      });\n   \n   b. Dashboard events:\n      document.querySelector('casl-user-dashboard').addEventListener('casl-dashboard', (event) => {\n        console.log('Dashboard event:', event.detail);\n      });\n   \n   c. Verification events:\n      document.querySelector('casl-verification').addEventListener('verificationComplete', (event) => {\n        console.log('Verification completed:', event.detail);\n      });\n\n4. Accessibility Features:\n\n   a. Keyboard Navigation:\n      - Use Tab to navigate between interactive elements\n      - Use Enter or Space to activate buttons and checkboxes\n      - Use arrow keys for navigation within selects and radio groups\n      - Press Escape to close dialogs or dismiss alerts\n      - A skip link is available for keyboard users to bypass navigation\n   \n   b. Screen Reader Support:\n      - All forms have proper labels and ARIA attributes\n      - Live regions announce status changes\n      - Error messages are properly associated with form controls\n      - Progress steps have appropriate ARIA attributes\n   \n   c. Visual Accommodations:\n      - Respects user's reduced motion preference\n      - Supports high contrast mode\n      - All interactive elements have visible focus indicators\n      - Color combinations meet WCAG 2.1 AA contrast requirements\n"),t})()));